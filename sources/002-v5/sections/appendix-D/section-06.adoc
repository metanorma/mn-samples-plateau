[[tocD_06]]
=== 標準的な作業手順

各LODの幾何オブジェクトを作成する際の標準的な作業手順及び作業上の留意事項を示す。


==== 幾何オブジェクトの作成

作成に必要となる原典資料を<<tab-D-14>>に示す。

[[tab-D-14]]
[cols="6a,29a,36a,29a"]
.原典資料一覧
|===
h| h| 水平位置 h| 高さ h| 交通領域・交通補助領域の区分
h| LOD0 | 都市計画基本図等のDMデータ | ― | ―
h| LOD1
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
| ―
| ―

h| LOD2
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
| ―
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

h| LOD3.0
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

h| LOD3.1
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

h| LOD3.2
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

h| LOD3.3
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* MMS点群
* 地上レーザ点群
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

h| LOD3.4
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* MMS点群
* 地上レーザ点群
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

|===

===== LOD0

====== 原典資料

[[tab-D-15]]
[cols="6a,29a,36a,29a"]
.LOD0の原典資料
|===
h| h| 水平位置 h| 高さ h| 交通領域・交通補助領域の区分
h| LOD0 | 都市計画基本図等のDMデータ | ― | ―

|===



====== 作業手順

. 都市計画基本図等のDMデータから道路縁を取得する。
. ネットワーク （道路中心線）を採用する場合は、左右の道路縁から等距離となる点をつないだ線分を取得する。数値地形図との互換性を保つために道路縁をLOD0として採用する場合は公共測量標準図式に従う。

[[fig-D-2]]
.道路中心線の取得のイメージ
image::images/213.webp.png[width="400"]

===== LOD1

====== 原典資料

[[tab-D-16]]
[cols="6a,29a,36a,29a"]
.LOD1の原典資料
|===
h| h| 水平位置 h| 高さ h| 交通領域・交通補助領域の区分
h| LOD1
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
| ―
| ―

|===



====== 作業手順

. 都市計画基本図等のDMデータから道路縁を取得する。
. 道路縁をつないだ面を作成する。 +
ただし、交差部、道路構造が変化する場所及び位置正確度又は取得方法が変わる場所で区切る。 +
交差部の区切り方は要件D-5に従う。
//要件tran-5

[[fig-D-3]]
.道路を区切る場所のイメージ
image::images/214.webp.png[]

交通（道路）モデル（LOD1）の作成例を<<fig-D-4>>に示す。交通（道路）モデルは、交差部、道路構造が変化する場所及び位置正確度又は取得方法が変わる場所で区切るが、この例に示す範囲では道路構造が変化する場所及び位置正確度又は取得方法が変わる場所が無く、交差部のみで区切られている。

[[fig-D-4]]
.交通（道路）モデル（LOD1）の作成イメージ
image::images/215.webp.png[width="500"]

===== LOD2

====== 原典資料

[[tab-D-17]]
[cols="6a,29a,36a,29a"]
.LOD2の原典資料
|===
h| h| 水平位置 h| 高さ h| 交通領域・交通補助領域の区分
h| LOD2
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
| ―
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

|===



====== 作業手順

. 航空写真又は点群データを参考に、交通（道路）モデル（LOD1）を車道部、車道交差部、歩道部及び島に区分する。
. 車道交差部は、隅切りがある場合は、隅切りに囲まれた車道部を取得する。隅切りがない場合は、交差する道路の道路縁が接する点で結ばれた線に囲まれた車道部を取得する。

[[fig-D-5]]
.車道交差部の取得のイメージ
image::images/216.webp.png[]

交通（道路）モデル（LOD2）の作成イメージを以下に示す。

[[fig-D-6]]
.交通（道路）モデル（LOD2）の作成イメージ
image::images/217.webp.png[width="500"]

===== LOD3.0

====== 原典資料

[[tab-D-18]]
[cols="6a,29a,36a,29a"]
.LOD3.0の原典資料
|===
h| h| 水平位置 h| 高さ h| 交通領域・交通補助領域の区分
h| LOD3.0
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

|===



====== 作業手順

. 点群データを参考に、交通（道路）モデル（LOD2）に高さを付与する。付与する高さは道路の横断方向に一律の高さとし、車道の高さとする。 +
交通領域・及び交通補助領域の区分は交通（道路）モデル（LOD2）と同様である。

交通（道路）モデル（LOD3.0）の作成例を<<fig-D-7>>に示す。<<fig-D-7>>は、交通（道路）モデル（LOD3.0）に交通（道路）モデル（LOD2）を重畳している。交通（道路）モデル（LOD2）は高さをもたないが、交通（道路）モデル（LOD3.0）は高さをもつ。結果として、交通（道路）モデル（LOD3.0）が浮いて見えている。

[[fig-D-7]]
.交通（道路）モデル（LOD2）と交通（道路）モデル（LOD3.0）の違い
image::images/218.webp.png[]

[[fig-D-8]]
.交通（道路）モデル（LOD3.0）の作成イメージ
image::images/219.webp.png[width="500"]

===== LOD3.1

====== 原典資料

[[tab-D-19]]
[cols="6a,29a,36a,29a"]
.LOD3.1の原典資料
|===
h| h| 水平位置 h| 高さ h| 交通領域・交通補助領域の区分
h| LOD3.1
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

|===



====== 作業手順

. 三次元図化により道路縁を新規に取得する。三次元図化はMMS点群を基本とする。周辺環境によって航空写真から図化できる場合もあるが、道路縁に数十㎝程度のずれが生じる可能性がある。また航空写真から図化する場合、立体交差部は現地補足が必要となる。
. 航空写真又は点群データを参考に、交差部、道路構造が変化する場所及び位置正確度や取得方法が変わる場所で区切る。このとき交差部は、停止線がある場合は停止線の延長で区切り取得する。停止線がない場合は、要件tran-5に従い区切る。
. 航空写真又は点群データを参考に、b）で作成した道路縁をつないだ面を車道部、車道交差部、歩道部及び島に区分する。
. 航空写真又は点群データを参考に、区画線を判読し、車道内の車線を区分する。

[[fig-D-9]]
.車線の区分のイメージ
image::images/220.webp.png[]

LOD3.1では、停止線がある場合はtran:Roadを停止線の延長で区切る。一方、LOD1及びLOD2では、tran:Roadを隅切りや交差する道路の道路縁が接する点で区切る。これにより、LOD1及びLOD2で作成したtran:Roadの形状と、LOD3.1で作成した面の形状は異なる。しかしながら、LOD3.1で作成した面が、LOD1及びLOD2で作成した面が同一のtran:Roadの幾何オブジェクトだと判断できる場合は、当該LOD1及びLOD2の面を空間属性としてもつtran:Roadの空間属性として作成したLOD3.1の面を扱う（すなわち、当該tran:Roadのtran:lod3MultiSurfaceとする）。

[[fig-D-10]]
.tran:Roadのインスタンスを統合する場合のイメージ
image::images/221.webp.png[]

交通（道路）モデル（LOD3.1）の作成例を以下に示す。LOD3.1では車線が区分される。

[[fig-D-11]]
.交通（道路）モデル（LOD3.1）の作成イメージ
image::images/222.webp.png[width="500"]

===== LOD3.2

====== 原典資料

[[tab-D-20]]
[cols="6a,29a,36a,29a"]
.LOD3.2の原典資料
|===
h| h| 水平位置 h| 高さ h| 交通領域・交通補助領域の区分
h| LOD3.2
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

|===



====== 作業手順

. LOD3.1モデルから、航空写真又は点群データを参考に歩道内の植栽を区分する。
. LOD3.1.モデルから、点群データを参考に15cm以上の段差を表現する。

[[fig-D-12]]
.段差表現のイメージ
image::images/223.webp.png[width="600"]

交通（道路）モデル（LOD3.2）の作成例を<<fig-D-11>>に示す。LOD3.2では、歩道上の植栽が 区分される。

[[fig-D-13]]
.交通（道路）モデル（LOD3.2）の作成イメージ
image::images/224.webp.png[width="500"]

交通（道路）モデル（LOD3.2）の作成については、以下の技術レポートを参考にできる。

[.source]
<<plateau_tr_03>>

===== LOD3.3

====== 原典資料

[[tab-D-21]]
[cols="6a,29a,36a,29a"]
.LOD3.3の原典資料
|===
h| h| 水平位置 h| 高さ h| 交通領域・交通補助領域の区分
h| LOD3.3
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* MMS点群
* 地上レーザ点群
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

|===



====== 作業手順

. LOD3.2モデルから、点群データを参考に2cm以上の段差を表現する。

[[fig-D-14]]
.段差表現のイメージ
image::images/225.webp.png[width="600"]

===== LOD3.4

====== 原典資料

[[tab-D-22]]
[cols="6a,29a,36a,29a"]
.LOD3.4の原典資料
|===
h| h| 水平位置 h| 高さ h| 交通領域・交通補助領域の区分
h| LOD3.4
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* MMS点群
* 地上レーザ点群
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画基本図等のDMデータ
* 航空写真
* MMS画像
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

|===



====== 作業手順

. LOD3.3モデルから、ユースケースに応じて[underline]##tran:TrafficArea##及びtran:AuxiliaryTrafficAreaの属性tran:functionの区分を細分化する。


==== 作業上の留意事項

===== 道路と建築物の間の表現

建築物の出入り口につながる導入路であるアプローチや、建築物の周辺をコンクリートや砂利で施工された空間（「犬走り」と呼ぶ）は、道路ではなく、tran:Track（徒歩道）として取得する（<<fig-D-15>>）。これは、アプローチや犬走りが建築物の敷地の一部であるからである。

[[fig-D-15]]
.犬走り
image::images/226.webp.png[width="300"]

===== 道路の立体交差の表現

道路の立体交差を表現する場合は、高架橋の道路と交差する下の道路も面として取得する。

立体交差を2次元で表現する場合には、空間属性の重なりが妥当であるのか否かを判定するために、立体交差では必ず道路のインスタンスを分けなければならない。

===== uro:sectionType（道路構造の種別）の入力基準

道路構造の種別は下記の入力基準に従い入力する。

* 橋梁、高架橋、トンネル又はアンダーパス以外は「土工区間・通常区間」とする。
* アンダーパスかどうか判断できない箇所は「土工区間・通常区間」とする。

===== 道路と徒歩道の接合部の表現

道路と徒歩道（tran:Track）の接合する場所で、道路は区切らない。

[[fig-D-16]]
.道路と徒歩道（歩行者用）の接合部の表現（LOD2以上の場合）
image::images/227.webp.png[width="300"]

なお、<<fig-D-15>>は交通（道路）モデル（LOD2）又は交通（道路）モデル（LOD3）の図であるが、交通（道路）モデル（LOD1）の場合も同様に区切る必要はない（<<fig-D-17>>）。

[[fig-D-17]]
.道路と徒歩道（歩行者用）の接合部の表現（LOD1）
image::images/228.webp.png[width="300"]

===== 車道交差部と歩道部の機能を両方もつ場合の交通領域の機能の入力の優先順位

LOD2又はLOD3を作成する際に、歩道部であるが車両が通行できる交通領域が存在する場合（<<fig-D-17>>）がある。このような交通領域の機能（tran:function）は、車道交差部とすることを基本とする。その際は、歩道部の境界線を用いて車道交差部を二つに分ける。

ただし、ユースケースにおいて歩道部の連続性が必要である場合は交通領域の機能（tran:function）を歩道部とできる。

[[fig-D-18]]
.歩道部かつ車道交差部でもある交通領域の例
image::images/229.webp.png[width="500"]

===== TrafficArea、AuxiliaryTrafficAreaを構成するMultiSurfaceの作成単位

TrafficArea、AuxiliaryTrafficAreaを構成するMultiSurfaceは同一機能（車道部、歩道部など）となるSurfaceの集まりを1つのMultiSurfaceとして作成する。

ただし、機能が車線となる場合、隣接する別の車線とも同一機能が連続するが、車線ごとに区別する必要があるため、別々のTrafficAreaとして作成する。

また、同一機能を有するSurfaceが連続していない場合は、別々のTrafficArea、AuxiliaryTrafficAreaとしてよい。

[[fig-D-19]]
.TrafficArea、AuxiliaryTrafficAreaの作成単位の例
image::images/530.webp.png[width="300"]

