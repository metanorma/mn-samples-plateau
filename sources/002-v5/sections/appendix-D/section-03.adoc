[[tocD_03]]
=== tran:Road

tran:Roadは、道路の記述に使用する地物型である。


==== 道路の空間属性

tran:Roadの空間属性は、いずれのLODにおいても、同一のLODにおける道路の連続性を担保する必要がある。


[requirement]
.tran:Roadの幾何座標一致条件
====
[%metadata]
identifier:: /req/tran/3
subject:: 妥当な交通（道路）データセットの要件
description:: 連続するtran:Roadの幾何オブジェクトは、同一のLODにおいて、その境界の座標を一致させなければならない。
====

===== LOD0

交通（道路）モデル（LOD0）では、道路の形状を、線として表現する。このとき、線は、ネットワーク（道路中心線）を基本とする。 +
ただし、数値地形図データ（以下、DMデータ）との互換性を保つために、道路縁を選択できる。 +
LOD0において、道路の形状の線をネットワーク（道路中心線）として記述する場合、gml:GeometrixComplexの下位型であるgml:CompositeCurveを用いて記述する。このとき、gml:CompositeCurveに含む幾何オブジェクトは、gml:LineStringとする。gml:CompositeCurveに含まれるgml:LineString同士は交差してはならない。


[requirement]
.LOD0 tran:Roadの交差禁止条件
====
[%metadata]
identifier:: /req/tran/4
subject:: 妥当な交通（道路）データセットの要件
description:: LOD0におけるtran:Roadの空間属性に含まれるgml:LineStringは互いに交差してはならない。
====

これは、一つの交通（道路）オブジェクトに対して適用するものである。例えば、高架における上の道路と下の道路というように、異なる交通（道路）オブジェクトの空間属性が交差することを許容する。

===== LOD1

交通（道路）モデル（LOD1）では、道路の形状を面として表現する。道路の横断方向の境界は道路縁となる。道路の延長方向は、以下の場所で区切る。

[requirement]
.tran:Roadオブジェクトの区切り位置
====
[%metadata]
identifier:: /req/tran/5
subject:: 妥当な交通（道路）データセットの要件
description:: tran:Roadのオブジェクトは、以下に示す場所で区切る。
part:: 交差部（四差路、多差路及び三差路）
part:: 道路構造の変化点（uro:RoadStructureAttribute）
part:: 位置正確度や取得方法が変わる場所（uro:RoadDataQualityAttribute）
====


道路は、延長方向に連続して存在する地物であるため、データ作成者によって異なる区切り方になる可能性がある。そこで、標準製品仕様書では、道路を必ず区切るべき位置として、「交差部（四差路、多差路及び三差路）」「道路構造の変化点（トンネル、橋梁）」、及び「位置正確度や取得方法が変わる場所」を指定している。 +
これらの位置では、必ず道路を区切らなければならない。 +
なお、ユースケースの必要に応じて、より詳細に区切ってもよい。（例：車線数が変わる場所で区切る）

====== 交差部（四差路、多差路及び三差路）での道路の区切り方

交差部での道路の区切り方は、以下に定義する優先順位で区切る。ただし、区切った交差部同士が重なる場合は、一つの交差部とする。なお、本手順書では道路が交差、分岐又は合流する場合において、ある道路の道路縁と他の道路縁とが接する点（道路角）を「接点」と呼ぶ。

. 隅切りのない四差路及び多差路 +
一つの道路において、道路縁の両側に接点が存在する場合は、接点を結んで道路を区切る。
. 隅切りのある四差路及び多差路 +
一つの道路において、道路縁の両側に隅切りが存在する場合は、隅切りの頂点を接点とし、接点を結んだ範囲を交差部とする。また、どちらか一方に隅切りが存在しない場合は、隅切りの頂点及び接点を結んだ範囲を交差部とする。
. 三差路 +
道路縁の片側にしか接点が存在しない道路が一つでもある場合（三差路）は、隅切りがある場合は隅切りの頂点を接点とし、全ての接点から垂線を引き区切る。隅切りがある場合や区切りが複数ある場合は、より外側の区切りを採用する。

image::images/204.webp.png[]

image::images/205.webp.png[]

image::images/206.webp.png[]

image::images/207.webp.png[]

image::images/208.webp.png[]

image::images/209.webp.png[]

====== 道路構造の変化点（トンネル、橋梁）での道路の区切り方

道路構造の変化点での道路の区切りは、トンネル、橋梁の図式を基に区切る。 +
区切り例：橋梁、高架橋、トンネル

image::images/210.webp.png[width="500"]

区切り例：複雑な道路構造の場合の道路の区切り

image::images/211.webp.png[width="500"]

===== LOD2

交通（道路）モデル（LOD2）では、道路の形状を面として表現する。このとき、道路（tran:Road）は、横断構成要素であるtran:TrafficAreaとtran:AuxiliaryTrafficAreaに分解される。すなわち、tran:Roadの空間属性は、これを構成するtran:TrafficAreaとtran:AuxiliaryTrafficAreaの空間属性の集まりとなる。


[requirement]
.LOD2 tran:Roadの空間属性一致条件
====
[%metadata]
identifier:: /req/tran/6
subject:: 妥当な交通（道路）データセットの要件
description:: LOD2におけるtran:Roadの空間属性は、これを構成するtran:TrafficArea及びtran:AuxiliaryTrafficAreaの空間属性の集まりと一致しなければならない。
====

===== LOD3

交通（道路）モデル（LOD3）では、道路の形状を面として表現する。このとき、道路（tran:Road）は、横断構成要素であるtran:TrafficAreaとtran:AuxiliaryTrafficAreaに分解される。すなわち、tran:Roadの空間属性は、これを構成するtran:TrafficAreaとtran:AuxiliaryTrafficAreaの空間属性の集まりとなる。


[requirement]
.LOD3 tran:Roadの空間属性一致条件
====
[%metadata]
identifier:: /req/tran/7
subject:: 妥当な交通（道路）データセットの要件
description:: LOD3におけるtran:Roadの空間属性は、これを構成するtran:TrafficArea及びtran:AuxiliaryTrafficAreaの空間属性の集まりと一致しなければならない。
====


==== 道路の主題属性

道路の主題属性には、あらかじめCityGML又はGMLにおいて定義された属性（接頭辞tran、gml）と、i-URにより拡張された属性（接頭辞uro）がある。CityGMLで定義された属性は、道路の機能など、基本的な情報となる。i-URにより拡張された属性には、道路構造に関する情報を格納するための属性（uro:RoadStructureAttribute、uro:TrafficAreaStructureAttribute）、交通量に関する情報を格納するための属性（uro:TrafficVolumeAttribute）、さらに、作成したデータの品質に関する情報を格納するための属性（uro:RoadDataQualityAttribute）がある。

===== 名称（gml:name）

道路の名称は、道路法に基づき路線が指定又は認定された路線名である。すなわち、政令や告示等による正式な路線名とする。 +
なお、高速自動車国道、一般国道、都道府県道については、全国道路・街路交通情勢調査（一般交通量調査）の箇所別基本表に路線名の記載があるので参考とできる。市町村道、建築基準法の道路（指定道路）は、市区町村の指定道路図に従う。

===== 機能（tran:function）

道路の機能は、道路法における道路の区分及び建築基準法における道路の区分である。 +
道路法における道路の区分は、道路管理者より管内図や路線網図を入手し、作成する。また、建築基準法における道路の区分については市町村より指定道路図を入手し、作成する。 +
なお、tran:functionの定義域のうち、「高速自動車道」「一般国道」「都道府県道」「市町村道」は、道路法の区分に従っている。そのため、自動車専用道、一般国道自動車専用道及び都市高速道路（首都高速道路）は、一般国道、都道府県道又は市道（政令指定都市の場合）に区分される。

===== 用途（tran:usage）

道路の用途は、道路の利用方法であり、標準製品仕様書ではその区分として「緊急輸送道路」及び「避難道路」を定義している。 +
これらは、自治体の地域防災計画に含まれる情報である。オープンデータとして「緊急輸送道路」及び「避難道路」のGISデータが公開されている場合は、これを利用してもよい。ただし、最新の地域防災計画の内容が反映されているか否かを確認の上、過不足があれば修正すること。

===== 道路の幅員（uro:widthType、uro:width）

uro:widthTypeは、道路の幅員を一定の長さで区分した属性である（<<tab-D-6>>）。

// RWP slide 26 use luta_gml_dictionary_table
// EDITOR: Autogen table below requires a check

[[tab-D-6]]
.幅員の区分

lutaml_gml_dictionary::iur/codelists/3.2/RoadStructureAttribute_widthType.xml[template="gml_dict_template.liquid",context=dict]

[.source]
<<mlit_foundation_reqs>>

////

[[tab-D-6]]
[cols="a,a"]
.幅員の区分
|===
| コード | 説明

| 1 | 15m以上
| 2 | 6m以上15m未満
| 3 | 4m以上6m未満
| 4 | 4m未満

|===

////

都市計画基礎調査において「道路の状況」として道路幅員が収集されている場合に、都市計画基礎調査のデータを用いてuro:widthTypeを作成する。都市計画基礎調査で収集されていない場合にはuro:widthTypeは作成しない。また、都市計画基礎調査で収集されたデータが<<tab-D-6>>に示す区分と異なる区分の場合は、拡張製品仕様書において収集されたデータに合わせたコードリストを作成し、この属性を作成する。 +
uro:widthは、道路の幅員値（実数値）である。都市計画基礎調査において、前述の幅員の区分だけではなく、幅員値が収集されている場合にはこれを用いてこの属性を作成する。都市計画基礎調査で収集されていない場合には、他の資料から収集又は道路の図形から算出する。想定される取得方法を以下に示す。

. 全国道路・街路交通量情勢調査（一般交通量調査）の値を採用する。

. 道路台帳に記載された幅員値を採用する。

. 道路の図形を用いてGIS上で平均幅員を算出する。

===== 車線数

uro:numberOfLanesは、上下線の合計（一方通行区間の場合を除く）の車線数である。道路構造令第2条第7号の登坂車線、同第2条第6号にいう付加追越車線、同第2条8号の屈折車線、同第2条第9号の変速車線及び同第2条第14号の停車帯、及びゆずり車線は車線数には含めない。また、「1車線道路」は道路構造令第5条1項ただし書きによって、車線により構成されない車道を持つ道路であるが、ここでは車線数＝1とする。「1車線道路」は車道幅員が5.5m未満の場合とする。 +
想定される取得方法を以下に示す。

. 都市計画基礎調査で収集されている場合は、これを使用する。

. 道路基盤地図情報より得られる場合はこれを使用する。

. 全国道路・街路交通量情勢調査（一般交通量調査）で収集されている場合はこれを使用する。

既存資料より得られない場合には、航空写真やMMSにより取得された画像や点群を用いて判読する。

===== 道路構造種別

uro:sectionTypeは、道路構造の種別である。交差点とそれ以外の区間、また、橋梁やトンネル、アンダーパスなど、道路構造物が存在する区間を区分する。 +
複数の道路構造の種別を持つ場合（高架内の交差部、アンダーパス内の交差部等）は、交差部を優先し入力する。

[[fig-D-1]]
.複数の道路構造の種別を持つ場合の取得イメージ
image::images/212.webp.png[]

===== 交通量（uro:TrafficVolumeAttribute）

uro:TrafficVolumeAttributeは道路の交通量に関する情報である。 +
交通量は、全国道路・街路交通量情勢調査（一般交通量調査）より取得する。そのため、本属性が付与される道路は、全国道路・街路交通情勢調査(一般交通量調査)の対象となる高速自動車国道、都市高速道路、一般国道、主要地方道である都道府県道及び指定市の市道、一般都道府県道、指定市の一部の一般市道となる。

===== 道路のデータ品質属性（uro:tranDataQualityAttribute）

道路の3D都市モデルを作成する場合、既存のGISデータの変換、航空写真からの図化又はMMS等により取得した点群からの図化等、様々な手法が想定される。都市の大部分は航空写真測量によりデータ作成を行うが、高架橋の下部等、航空測量では取得できない場所をMMS測量により補完する又は航空測量では取得できない場所は既存の図面から推定するというように、一つの3D都市モデルの中に複数の手法が混在する可能性がある。また、同じ手法であっても元となる航空写真やレーザ点群の時点が異なる可能性もある。手法や原典資料が異なれば、データの品質も異なる。 +
3D都市モデルでは、データ集合全体としての品質はメタデータに記録する。しかしながら、メタデータでは、個々の都市オブジェクトに対して位置正確度や適用したLOD等の品質を記述することが困難である。 +
そこで、標準製品仕様書では、個々の都市オブジェクトに対してデータ品質に関する情報を記述するための属性として、「データ品質属性」（uro:DataQualityAttribute）を定義している。データ品質属性は、属性としてデータ作成に使用した原典資料の地図情報レベル、その他原典資料の諸元及び精緻化したLODをもつ。 +
3D都市モデルに含まれる全ての交通（道路）オブジェクトは、このデータ品質属性を必ず作成しなければならない。ただし、道路（tran:Road）に対してデータ品質属性を付与することはできるが、これを構成する交通領域（tran:TrafficArea）や交通補助領域（tran:AuxiliaryTrafficArea）にデータ品質属性を付与することはできない。

===== 施設管理のための属性

施設管理のための属性は、港湾施設及び漁港施設、河川管理施設や公園管理施設等の施設管理に必要な情報を定義した属性である。施設管理のための属性は以下のデータ型を用いて記述する。

====== 施設分類属性（uro:FacilityTypeAttribute）

uro:FacilityTypeAttributeは、各分野で定める施設の区分を記述するためのデータ型である。CityGMLは、地物型を物体としての性質に着目して定義し、機能や用途は属性で区分している。例えば、「道路（tran:Road）」という地物型を定義し、tran:functionにより「一般国道」や「都道府県道」などを区分している。これにより、都市に存在する様々な地物を、分野を問わず、網羅的に、かつ、矛盾が無く表現することを目指している。一方、各分野には独自の施設の区分がある。この区分は当該分野での施設管理に必要な情報であるが、CityGMLの地物型の区分とは一致しない。そこで、これらの地物型に分野独自の区分を付与するためにこのデータ型を用いる。uro:FacilityTypeAttributeは、二つの属性をもつ。uro:classは分野を特定するための属性である。またuro:functionは、uro:classにより特定した分野における施設の区分を示す。 +
標準製品仕様書では、港湾施設管理、漁港施設管理及び公園施設管理のそれぞれの分野についてはuro:functionの区分を示している。その他の分野における区分が必要となる場合はuro:classへの分野の追加も含め、拡張製品仕様書において追加できる。

====== 施設識別属性（uro:FacilityIdAttribute）

uro:FacilityIdAttributeは、施設の位置を特定する情報及び施設を識別する情報を記述するためのデータ型である。uro:FacilityIdAttributeは、施設を識別するための情報として、識別子（uro:id）や正式な名称以外の呼称（uro:alternativeName）に加え、施設の位置を示すための、都道府県（uro:prefecture）、市区町村（uro:city）及び開始位置の経緯度（uro:startLat、uro:startLong）を属性としてもつ。また、鉄道上や道路上の施設については、路線や距離標での位置特定のための属性（uro:route、uro:startPost、uro:endPost）を使用できる。 +
なお、河川管理施設の場合は、uro:FacilityIdAttributeを継承するuro:RiverFacilityIdAttributeを使用する。これにより、左右岸上での位置の情報を記述できる。

====== 施設詳細属性（uro:FacilityAttribute）

uro:FacilityAttributeは、各分野において施設管理に必要となる情報を記述するためのデータ型である。uro:FacilityAttributeは、抽象クラスであり、これを継承する具象となるデータ型に、施設の区分毎に必要となる情報を属性として定義している。 +
標準製品仕様書では、港湾施設、漁港施設及び公園施設について、細分した施設の区分ごとにデータ型を定義している。また、施設に関する工事や点検の状況や内容を記述するためのデータ型（uro:MaintenanceHistoryAttribute）を定義している。

