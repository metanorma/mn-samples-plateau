[[tocD_02]]
=== 道路の記述とLOD

[[tocD_02_01]]
==== 使用可能な地物型とLOD

CityGMLには、道路を記述するための地物型が用意されている。詳細度（LOD）ごとに、使用すべき地物型やその空間属性が異なる。


[requirement]
.道路記述のLOD対応条件
====
[%metadata]
identifier:: /req/tran/1
subject:: 妥当な交通（道路）データセットの要件
description:: 道路の記述には、指定されたLODに対応する地物型及び空間属性を使用する。
====

道路は、CityGMLのTransportationモジュールに定義されたtran:Roadを用いて記述する。tran:Roadは道路面に該当する。

道路面は歩道や車道のように、機能の異なる複数の要素から構成される。この道路を構成する要素は、tran:TrafficArea又はtran:AuxiliaryTrafficAreaを用いて記述する。tran:TrafficAreaは、車線や歩道のように、通行の用に供される領域である。

一方、tran:AuxiliaryTrafficAreaは、中央帯や植樹帯のように補助的な役割を果たす領域である。tran:Roadは、tran:TrafficArea及びtran:AuxiliaryTrafficAreaの集まりとして構成される。

tran:Roadの空間属性は、LOD0では、線として表現する。LOD1以降では面として表現する。tran:TrafficArea及びtran:AuxiliaryTrafficAreaは、いずれも面として表現する。ただし、これら二つの地物型はLOD2以降でのみ使用可能となる。

すなわち、LOD1では道路は歩車道の区別がない道路面として表現され、LOD2以降では道路の歩道や車道あるいは車線など、道路内の構造を区別できるようになる。

各LODにおいて使用可能な地物型とその空間属性を、<<tab-D-1>>に示す。

[[tab-D-1]]
include::../../../common/sections/com_4_03_D_02_003.adoc[]

////
[cols="3a,3a,^a,^a,^a,^a,6a"]
.交通（道路）モデルに使用する地物型及び空間属性
|===
| 地物型 |  空間属性 |  LOD0 |  LOD1 |  LOD2 |  LOD3 |  適用

.6+| tran:Road | |  ● |  ● |  ● |  ● |
| tran:lod0Network ^|  ■ |  |  |  .2+<| LOD0はネットワークを原則とするが、数値地形図との互換性を保つために、道路縁を選択できる。
| uro:lod0Geometry ^|  ■ |  |  |
| tran:lod1MultiSurface |  |  ● |  |  |
| tran:lod2MultiSurface |  |  |  ● |  |
| tran:lod3MultiSurface |  |  |  |  ● |
.3+| tran:TrafficArea | |  |  |  ● |  ● |
| tran:lod2MultiSurface |  |  |  ● |  |
| tran:lod3MultiSurface |  |  |  |  ● |
.3+| tran:AuxiliaryTrafficArea | |  |  |  ● |  ● |
| tran:lod2MultiSurface |  |  |  ● |  |
| tran:lod3MultiSurface |  |  |  |  ● |

|===

[%key]
●:: 必須
■:: 条件付必須
〇:: 任意（ユースケースに応じて要否を決定してよい）
////

==== 交通（道路）モデルのLOD

交通（道路）モデルにおいて、LOD0では道路の形状を線により表現し、LOD1以降は面として表現する。LOD1では道路内の区分はできず、LOD2以降で道路内を区分可能となる。CityGMLでは、LODの枠組みとそこで使用可能な地物型及び空間属性をデータ構造として定義しているが、何を取得し記述すべきというデータの内容を定義していない。これにより、同じLODであっても、ユースケースやデータ作成者によってその詳細度が大きく異なる可能性がある。

そこで、標準製品仕様書では、その用途やデータ作成の難易度を考慮し、3D都市モデルにおける道路のLODを<<tab-D-2>>のように整理している。

[[tab-D-2]]
.交通（道路）モデルのLODの考え方
image::images/191.webp.png[]

前述したように、LOD0における道路は線、LOD1以降では面として表現する。また、その座標はLOD0からLOD2までは高さを持たず、LOD3では高さを持つ。このとき、LOD0からLOD2では、交通（道路）オブジェクトを3次元の地形データに重畳することで3次元的に表示して利用することを想定している。

LOD0は道路を線として表現するが、このときの線は、ネットワーク（道路中心線）又は道路縁のいずれかを選択できる。3D都市モデルでは、ネットワーク（道路中心線）を採用することを原則とする。ネットワークデータとして記述することでマクロな人や物の流れを表現・分析可能となり、公共交通網の見直しや公共施設の再配置等に利用することを想定している。道路縁を採用する場合、「<<gsi_ops,付録７ 公共測量標準図式>>」（以下、「公共測量標準図式」という）に従う。これにより、従来の都市計画基本図の地図表現が可能となる。

LOD1では道路を面として記述する。これにより道路がもつ空間機能の表現・分析が可能となり、火災の延焼シミュレーションや埋設物管理といったシミュレーションや施設管理に利用できる。LOD2では道路の面が歩道及び車道に区分されるため、歩行者ナビゲーションや沿道景観の改善等に利用できる。また、LOD3では道路を3次元で記述し、かつ横断構成要素を詳細に区分するため、バリアフリーナビゲーションや自動運転といった詳細なデータを要求するユースケースに利用できる。

LOD1及びLOD2では道路オブジェクトは高さを持たないため、立体交差や歩道と車道との間の高低差を表現できない。これらが必要な場合には、高さを持つLOD3が必要となる。LOD3では道路内の区分と高さの取得方法により、LODを細分する。<<tab-D-3>>に細分したLOD3の概要を示す。

[[tab-D-3]]
[cols="3a,3a,^a,^a,^a,^a,^a"]
.交通（道路）モデル（LOD3）の概要
|===
| | 取得基準 | LOD3.0 | LOD3.1 | LOD3.2 | LOD3.3 | LOD3.4

.4+h| 道路内の区分 | 車道部、車道交差部、島及び歩道部の区分 |  ● |  ● |  ● |  ● |  ●
| 車道部内の車線の区分 |  |  ● |  ● |  ● |  ●
| 歩道部上の植栽の区分 |  |  |  ● |  ● |  ●
| 車道部を車線、すりつけ区間、踏切道、軌道敷、待避所、副道、自動車駐車場、非常駐車帯、中央帯、側帯、路肩、停車帯、乗合自動車停車所に区分する。

島を、交通島、分離帯、植樹帯、路面電車停車所に区分する。

歩道を、歩道、自転車歩行者道、自転車道、植樹ますに区分する。
|
|
|
|
|  〇 footnote:[ユースケースに応じて取得基準の区分又は下限値を決定してよい]

.3+h| 高さの取得方法 | 道路の横断方向の高さは一律とし、車道の高さとする。 |  ● |  ● |  |  |
| 道路の横断方向に15㎝以上の高さの差が存在した場合に、車道部、歩道部、島それぞれの高さを取得する。 |  |  |  ● |  |
| 道路の横断方向に2㎝以上の高さの差が存在した場合に、車道部、歩道部、島それぞれの高さを取得する。 |  |  |  |  ● |  ● footnote:[ユースケースに応じて取得基準の区分又は下限値を決定してよい]

|===

[%key]
●:: 必須
〇:: 任意（ユースケースに応じて要否を決定してよい）

LOD3は「道路内の区分」及び「高さの取得方法」の組み合わせが異なるLOD3.0、LOD3.1、LOD3.2、LOD3.3及びLOD3.4に分かれる。標準製品仕様は、原則としてLOD3.0とする。ただし、ユースケースの必要に応じて、LOD3.1、LOD3.2、LOD3.3又はLOD3.4を採用できる。LOD3.0からLOD3.4に適用する「高さの取得方法」及び「道路内の区分」を<<tab-D-4>>及び<<tab-D-5>>に示す。

[[tab-D-4]]
.道路LOD3における「高さの取得方法」
include::../../../common/sections/com_4_03_D_02_002.adoc[]

////
[cols="1a,1a,1a"]
|===
| LOD3.0及びLOD3.1 | LOD3.2 | LOD3.3及びLOD3.4

|
道路内（車道部、歩道部、島）の高さは、横断方向に同一（全て車道の高さ）となる。 +
立体交差を表現できる。

image::images/192.webp.png[]

|
道路の横断方向に存在する15㎝以上の高さの差を取得する。

. 高さの差が15㎝以上の段は、段の形状を取得する。
+
image::images/193.webp.png[]

. 高さの差が15㎝以上のスロープは、スロープの形状を取得する。
+
image::images/195.webp.png[]

. 高さの差が15㎝未満の段が複数あり、合計15㎝以上の高さの差がある場合は、スロープとして取得する。
+
image::images/197.webp.png[]

歩道と車道との間や車道と島との間に存在する縁石による段を表現できる。

|
道路の横断方向に存在する2㎝以上の高さの差を取得する。

. 高さの差が2㎝以上の段は、段の形状を取得する。
+
image::images/194.webp.png[]

. 高さの差が2㎝以上のスロープは、スロープの形状を取得する。
+
image::images/196.webp.png[]

. 高さの差が2㎝未満の段が複数あり、合計2㎝以上の高さの差がある場合は、スロープとして取得する。
+
image::images/198.webp.png[]

歩道に設けられた車道への切り下げ部に存在する段が表現できる。

image::images/199.webp.png[]

|===
////

LOD3.0及びLOD3.1の「高さの表現」では、高架橋、立体交差等、道路全体の上下の階層構造を区別できる。

LOD3.2では、道路内の縁石による高さの差を表現する。この高さの差は、縁石によりマウントアップされた歩道と車道との高さの差や車道内の分離帯や交通島の高さの差（概ね15㎝程度）とする。横断歩道への接続や車両の出入り等の目的で歩道に設けられた、歩道の切り下げ部では緩やかに車道の高さに擦り付ける（歩道切り下げ部と車道との間に生じる高さの差の表現は行わない）。

さらに、LOD3.3及びLOD3.4では、歩道切り下げ部と車道との高さの差（概ね2㎝程度）の表現を行う。なお、LOD3.4における高さの取得基準の下限値はユースケースにより決定できる。

// this table is_common to both doc01 and doc02 slide 24
// RWP aligned text 20240917

[[tab-D-5]]
.道路LOD3における「道路内の区分」
include::../../../common/sections/com_4_03_D_02_001.adoc[]

////
[cols="1a,1a,1a,1a"]
|===
| LOD3.0 | LOD3.1 | LOD3.2及びLOD3.3 | LOD3.4

| 車道部、車道交差部、島及び歩道部を区分する。
| LOD3.0の区分を細分する。 +
車道部のうち、車線を区分する。
| LOD3.1の区分を細分する。 +
歩道部のうち、植栽を区分する。
| LOD3.3の区分を細分する。 +
細分はユースケースに応じて決定する。

^.^|
image::images/200.webp.png[]
^.^|
image::images/201.webp.png[]
^.^|
image::images/202.webp.png[]
^.^|
image::images/203.webp.png[]

|===

NOTE: 青色着色している道路内の区分は、当該LODにおいて新たに区別ができるようになる区分である。
////

LOD3において最も粗い「道路内の区分」では、道路を車道部、車道交差部、島及び歩道部に区分する。この区分はLOD3.0に適用され、区分の内容はLOD2.0と同様である。すなわち、LOD3.0は、LOD2.0に高さが付与されたデータとなる。LOD3.0では車道部内の車線は区別しない。また、歩道部には歩道上に存在する植栽も含まれる。LOD3.1は、LOD3.0の車道部のうち、車線を区分する。よって、車両が通行する範囲を明確にできる。次にLOD3.2及びLOD3.3は、LOD3.1の区分に加えて、歩道部のうち歩道上の植栽を区分する。すなわち、歩道においても、通行の用に供される部分を明確に区分できる。さらにLOD3.4では、道路の横断構成要素をさらに細分する。車道部のうち、路肩や停車帯等を区別したり、歩道を歩道や自転車歩行車道等に区別したりできる。LOD3.4における横断構成要素の取得基準の区分はユースケースごとに決定できる。

なお、LOD3.0は、航空写真等上空から取得したデータの利用を前提とした区分である。このとき、トンネル内や高架橋の下部等の遮蔽部は上空から取得したデータでは作成することができない。そのため、他の資料による補完又は、推定によるデータ作成をする必要がある。LOD3.1以上は、MMS（Mobile Mapping System）により取得した点群や画像等のデータの利用を前提とした区分である。

データ集合に、航空写真等による図化、他の資料による補完、推定による作図というように、作成方法が異なる道路オブジェクトが混在する場合は、データ品質属性（<<tocD_03_02_08>>）を使用し、個々の道路オブジェクトの品質情報を記述することで、それぞれの作成方法を明示できる。


==== 3D都市モデルに含むべき道路のLOD


[requirement]
.道路3Dモデルの幾何オブジェクト要件
====
[%metadata]
identifier:: /req/tran/2
subject:: 妥当な交通（道路）データセットの要件
description:: 道路の3D都市モデルには、LOD1又はLOD2の幾何オブジェクトを必ず含む。
====

3D都市モデルに道路を含む場合には、幾何オブジェクトとして、LOD1又はLOD2を必ず記述しなければならない。また、ユースケースの必要に応じ、LOD0又はLOD3を記述することができる。

