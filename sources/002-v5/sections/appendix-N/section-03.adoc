[[tocN_03]]
=== 標準的な作業手順


==== 幾何オブジェクトの作成

作成に必要となる原典資料を示す。

[[tab-N-3]]
[cols="a,a,a,a,a,a"]
.原典資料一覧
|===
| | 水平位置 | 高さ | 上面の形状 | 側面の形状 | 付属物等

h| LOD0 | 以下のいずれかのデータを一つ以上使用する

* 都市計画図等のDMデータ
* 平面図
* 航空写真
| ― | ― | ― | ―
h| LOD1 | 以下のいずれかのデータを一つ以上使用する

* 都市計画図等のDMデータ
* 平面図
* 航空写真
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
| ― | ― | ―
h| LOD2 | 以下のいずれかのデータを一つ以上使用する

* 都市計画図等のDMデータ
* 平面図
* 航空写真
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
| 以下のいずれかのデータを一つ以上使用する

* 平面図及び断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
| ― | ―
h| LOD3.0 | 以下のいずれかのデータを一つ以上使用する

* 都市計画図等のDMデータ
* 平面図
* 航空写真
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 平面図及び断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図
* MMS点群
* 地上レーザ点群
| ―
h| LOD3.1 | 以下のいずれかのデータを一つ以上使用する

* 都市計画図等のDMデータ
* 平面図
* 航空写真
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 平面図及び断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 平面図及び断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LiderSLAM点群

|===

NOTE: DMデータとは、数値地形図（DM）のデータである。

NOTE: 原典資料の一覧に示す平面図、断面図、構造図は設計時や竣工時に作成された図面を指す。また、図面は紙出力された資料及びCADデータを含む。

===== LOD0

====== 原典資料

[[tab-N-4]]
[cols="4a,4a,3a,3a,3a,3a"]
.LOD0の原典資料
|===
h| h| 水平位置 h| 高さ h| 上面の形状 h| 側面の形状 h| 付属物等
h| LOD0 | 以下のいずれかのデータを一つ以上使用する

* 都市計画図等のDMデータ
* 平面図
* 航空写真
| ― | ― | ― | ―

|===

====== 作業手順

. DMデータ、平面図又は航空写真から、構造物を包含する外形線、中央位置又は外形線により囲まれた面を取得する。高さは0とする。 +
護岸・堤防、水門・閘門・陸門・樋門・樋管（幅3.75m以上）、堰（長さ1.25m以上）、伏せ越し及び防波堤は外形線を取得する。 +
水門（幅3.75m以下）及び堰（長さ1.25m以下）は中央位置を点として取得する。 +
船揚場、水制及び床止めは外周を面として取得する。 +
取得方法は数値地形図に従う。


===== LOD1

====== 原典資料

[[tab-N-5]]
[cols="a,a,a,a,a,a"]
.LOD1の原典資料
|===
| | 水平位置 | 高さ | 上面の形状 | 側面の形状 | 付属物等

h| LOD1 | 以下のいずれかのデータを一つ以上使用する

* 都市計画図等のDMデータ
* 平面図
* 航空写真
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
| ― | ― | ―

|===

====== 作業手順

その他構造物の作業手順は作成する構造物の種類によって異なるため、種類ごとに作業手順を記載する。

[level=6]
====== 護岸・堰・ダム・水門・閘門・陸門・樋門・樋管

. DMデータ、平面図又は航空写真から、構造物の外周の上からの正射影をポリゴンとして取得する。

. 断面図若しくは構造図等の構造物の高さがわかる図面、航空写真から作成した点群又は航空レーザ点群から、付属物を含まないその他構造物の最高高さを取得し、a）で作成したポリゴンに高さを与える。
+
[[fig-N-1]]
.一律の高さの取得イメージ
image::images/394.webp.png[]

. b）で高さを与えたポリゴンを、水面（地面）の高さ（陸上に設置されている場合は地表面）まで下向きに押し出し、立体とする。水面の高さは水部モデル（陸上に設置されている場合は、地形モデル）の頂点の高さのうち、最も低い高さとする。

[[fig-N-2]]
.その他の構造物モデル（水門）（LOD1）のイメージ
image::images/395.webp.png[width="200"]


[level=6]
====== 堤防

. DMデータ、平面図又は航空写真から、堤防の外周の正射影（表のり先と裏のり先の間の範囲）をポリゴンとして取得する。
. 表のり先法線と地形モデルの交線の高さ及び裏のり先法線と地形モデルの交線の高さを取得し、その高さの最低値を取得する。
. a）で作成したポリゴンにb）で取得した高さの最低値を各頂点に与える。この時作成された高さを持ったポリゴンは水平面となる。
. a）で作成したポリゴン内に含まれる航空レーザ点群又は航空写真から作成した点群の最高高さを取得し、c）で作成した高さ付きのポリゴンを最高高さから下向きに押し出し、立体とする。

[[fig-N-3]]
.その他の構造物モデル（堤防）（LOD1）のイメージ
image::images/396.webp.png[]

[level=6]
====== 水制・床止め

. DMデータ又は平面図から、一体となって設置された構造物全体の形状を包含するポリゴンを作成する。この時作成されたポリゴンは矩形又は矩形の集まりとなる。
. 断面図、構造図等の構造物の高さがわかる図面から水面（地面）の高さと構造物の最高高さを取得し、一律の高さを与えて押し出した立体を作成する。水面の高さは水涯線の頂点のうち最も低い高さとする。 +
このときの水涯線は、水涯線の各頂点に地形モデルとの交点の高さを与えた高さ付きの水涯線とする。ただし、海面の場合は東京湾平均海面の高さ0mとする。 +
その他の構造物モデル（LOD1）は航空測量から作成することを想定しているため、水中や地中部分は作成しない、下図のように作成する。
+
[[fig-N-4]]
.水制の断面イメージ
image::images/397.webp.png[width="300"]

[[fig-N-5]]
.その他の構造物モデル（水制・床止め）（LOD1）のイメージ
image::images/398.webp.png[width="400"]

その他の構造物モデル（LOD1）の作成例を以下に示す。

[[fig-N-6]]
.その他の構造物モデル（堰）（LOD1）の作成イメージ
image::images/399.webp.png[width="400"]

[[fig-N-7]]
.その他の構造物モデル（樋門）（LOD1）の作成イメージ
image::images/400.webp.png[width="400"]

[[fig-N-8]]
.その他の構造物モデル（堤防）（LOD1）の作成イメージ
image::images/401.webp.png[width="400"]

===== LOD2

====== 原典資料

[[tab-N-6]]
[cols="a,a,a,a,a,a"]
.LOD2の原典資料
|===
| | 水平位置 | 高さ | 上面の形状 | 側面の形状 | 付属物等

h| LOD2 | 以下のいずれかのデータを一つ以上使用する

* 都市計画図等のDMデータ
* 平面図
* 航空写真
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
| 以下のいずれかのデータを一つ以上使用する

* 平面図及び断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
| ― | ―

|===

====== 作業手順

その他構造物の作業手順は作成する構造物の種類によって異なるため、それぞれの種類の作業手順を記載する。

[level=6]
====== 護岸・堰・水門・閘門・陸門・樋門・樋管・伏せ越し

. その他の構造物モデル（LOD1）に航空レーザ点群又は航空写真から作成した点群を重畳させる。
. その他の構造物モデル（LOD1）の立体の上面のうち、高さが異なる部分を判読し、分割線（エッジ）を取得する。 +
分割線の取得基準はデータセットが採用する地図情報レベルの高さの誤差の標準偏差に収まるようにする。このとき、構造上不可欠でない付属物（手すり、柵、構造物と一体でない階段）は、その他の構造物モデル（LOD2）での作成対象でないため、高さが異なる部分とはしない。 +
なお、上空から見えないとなる部分は外周を取得できない。例えば上部に管理所等の構造物があり、水門や堰のゲートが上から見えない場合はゲートの形状を表現しない。図面を用いて外周を取得する場合も同様である。
+
[[fig-N-9]]
.その他の構造物モデル（LOD1）を高さが異なる面で分割するイメージ
image::images/402.webp.png[width="400"]

. その他の構造物モデル（LOD1）の立体をb）で取得した分割線を用いて分割する。 +
これにより、その他の構造物モデル（LOD1）の立体を、高さの異なる部分に分割できる。
. c）で分割した立体の上面の各頂点に、点群の高さを与える。護岸や堤防に階段が設けられている場合は、最上段及び最下段を結ぶスロープ状に表現する。 +
これにより、その他の構造物モデル（LOD1）の立体を分割した各部分は、それぞれの高さをもつ。
. d）で作成した立体を構成する境界面を屋根面（RoofSurface）、外壁面（WallSurface）又は底面（GroundSurface）に区分する。 +
境界面は、上向きの面を屋根面、下向きの面の内最も低い面（水面又は地面と接する面）を底面、それ以外の面を外壁面に区分する。

[[fig-N-10]]
.その他の構造物モデル（LOD2）のイメージ（水門）
image::images/403.webp.png[width="400"]

[level=6]
====== 堤防

. その他の構造物モデル（LOD1）に航空レーザ点群又は航空写真から作成した点群を重畳させる。
. 点群の高さが異なる部分を判読し、その外周（エッジ）を取得する。この時取得される外周は表法面等の堤防を構成する各面の外周となる。 +
外周の取得基準は、データセットが採用する地図情報レベルの水平及び高さの誤差の標準偏差に収まるようにする。
. その他の構造物モデル（LOD1）の立体をb）で取得した外周を基に分割する。
. c）で分割した立体の上面の各頂点に対し、点群の高さを与える。護岸や堤防に階段が設けられている場合は、最上段及び最下段を結ぶスロープ状に表現する。
. d）で作成した立体を構成する面を屋根面（RoofSurface）、外壁面（WallSurface）、底面（GroundSurface）又は閉鎖面（ClosureSurface）に区分する。 +
境界面の区分は、表法面、天端、裏法面、小段、裏法面等、堤防を横断方向に区分する面を屋根面とし、下向きの面を底面とする。外壁面は堤防を縦断方向に区分する面（堤防の端）とし、行政界等で区切り、一部のみを作成する場合、その仮想的な境界面には閉鎖面を使用する。階段がある場合は階段を屋根面として区分する。

[[fig-N-11]]
.その他の構造物モデル（LOD2）イメージ（堤防）
image::images/404.webp.png[width="400"]

[level=6]
====== 水制・床止め

. 航空レーザ点群又は航空写真から作成した点群から、TINを作成する。 +
TINの作成に使用する点群の密度は、1点/m2以上とする。
. a）で作成したTINを基にその他の構造物モデル（LOD1）の立体の上面を細分化する。
. b）で作成した立体を構成する面を屋根面（RoofSurface）、底面（GroundSurface）に区分する。上から見える面を全て屋根面、下向きの面（水面又は地面と接する面）を底面とし、外壁面は使用しない。
+
[[fig-N-12]]
.その他の構造物モデル（LOD2）のイメージ（水制）
image::images/405.webp.png[width="400"]

その他の構造物モデル（堰、樋門）（LOD2）の作成例を以下に示す。

[[fig-N-13]]
.その他の構造物モデル（LOD2）の作成例（堰）
image::images/406.webp.png[width="400"]

[[fig-N-14]]
.その他の構造物モデル（LOD2）の作成例（樋門）
image::images/407.webp.png[width="400"]

[[fig-N-15]]
.その他の構造物モデル（LOD2）の作成例（堤防）
image::images/408.webp.png[width="500"]

===== LOD3.0

====== 原典資料

[[tab-N-7]]
[cols="9a,9a,9a,9a,9a,5a"]
.LOD3.0 の原典資料
|===
h| h| 水平位置 h| 高さ h| 上面の形状 h| 側面の形状 h| 付属物等
h| LOD3.0 | 以下のいずれかのデータを一つ以上使用する

* 都市計画図等のDMデータ
* 平面図
* 航空写真
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 平面図及び断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図等
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| ―

|===

====== 作業手順

[level=6]
====== 護岸・堰・水門・閘門・陸門・樋門・樋管・伏せ越し

. その他の構造物モデル（LOD2）を作成する。
. 断面図若しくは構造図等の構造物の側面形状が分かる図面、MMS点群又は地上レーザ点群等を用いて、上空から見えない部分の上面及び側面の詳細な形状を取得し、その他の構造物モデル（LOD2）を詳細化する。 +
例えば、上部に管理所等の構造物が存在する場合も水門や堰のゲートを表現する。階段がある場合、段差を表現する。航空写真又は航空レーザ点群から側面形状を取得可能な場合はMMS点群等を使用しなくてよい。
. b）で作成した立体を構成する各面を屋根面（RoofSurface）、外壁面（WallSurface）又は底面（GroundSurface）に区分する。 +
上向きの面のうち、屋根の機能を有する面あるいは最も高い面を屋根面、下向きの面のうち最も低い面（水面又は地面と接する面）を底面、それ以外の面を外壁面に区分する。その他の構造物モデル（LOD3.0）では屋外床面（OuterFloorSurface）及び屋外天井面（OuterCeilingSurface）を使用しない。行政界や管理区間でその他の構造物を区切る場合、仮想的に生成する断面は、閉鎖面（ClosureSurface）とする。

.その他の構造物モデル（LOD3.0）のイメージ（水門・護岸）
image::images/409.webp.png[width="500"]

[level=6]
====== 堤防

. その他の構造物モデル（LOD2）を作成する。
. その他の構造物モデル（LOD2）に階段がある場合、MMS点群又は地上レーザ点群から段差を表現する。
. b）で作成した立体を構成する面を屋根面（RoofSurface）、外壁面（WallSurface）、底面（GroundSurface）もしくは、閉鎖面（ClosureSurface）に区分する。表法面、天端、裏法面、小段等、上向きの面を屋根面とし、下向きの面を底面とする。外壁面は堤防を縦断方向に区分する面（堤防の端）とする。行政界等で区切り、構造物の一部のみを作成する場合、その仮想的な境界面には閉鎖面（ClosureSurface）を使用する。なお、階段がない場合は、その他の構造物モデル（LOD2）と同一のモデルとなる。

[level=6]
====== 水制・床止め

. 一つ一つの構造物の形状を平面図、断面図若しくは構造図等の構造物の形状がわかる図面、航空レーザ点群又は地上レーザ点群から取得し立体として表現する。水制・床止めの形状を個々に表現できるが、個々に形状を作成する必要はなく、同一のモデルを複製して配置してもよい。
. a）で作成した立体を複製して実際の位置に近しい箇所に配置する。この時、構造物の傾きを再現する必要はない。
. 立体を構成する面を全て外壁面（WallSurface）とする。
+
[[fig-N-16]]
.その他構造物モデル（LOD3.0）のイメージ（水制）
image::images/410.webp.png[width="400"]

その他の構造物モデル（堰、樋門、堤防）（LOD3.0）の作成例を以下に示す。 +
構造上不可欠なシリンダーは付属物とせず、その他の構造物モデル（LOD3.0）でも取得している。シリンダーのように部材全体が曲面として作成される場合、外壁面として区分する。

[[fig-N-17]]
.その他構造物モデル（堰）（LOD3.0）の作成例
image::images/411.webp.png[width="400"]

[[fig-N-18]]
.その他構造物モデル（樋門）（LOD3.0）の作成例
image::images/412.webp.png[width="400"]

[[fig-N-19]]
.その他構造物モデル（堤防）（LOD3.0）の作成例
image::images/413.webp.png[width="500"]

===== LOD3.1

====== 原典資料

[[tab-N-8]]
[cols="a,a,a,a,a,a"]
.LOD3.1の原典資料
|===
| | 水平位置 | 高さ | 上面の形状 | 側面の形状 | 付属物等

h| LOD3.1 | 以下のいずれかのデータを一つ以上使用する

* 都市計画図等のDMデータ
* 平面図
* 航空写真
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 平面図及び断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 断面図又は構造図等
* MMS点群
* 地上レーザ点群
* LiderSLAM点群
| 以下のいずれかのデータを一つ以上使用する

* 平面図及び断面図又は構造図等
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LiderSLAM点群

|===

====== 作業手順

[level=6]
====== 護岸・堰・水門・閘門・陸門・樋門・樋管・伏せ越し

. その他の構造物モデル（LOD3.0）を作成する。
. a）に平面図、断面図若しくは構造図等の付属物の形状が分かる図面又は航空レーザ点群等の点群から構造上不可欠ではない付属物（手すり、柵、構造物と一体ではない階段等）を表現する。
. ユースケースに応じて、a）の境界面のうち、上向きの面を屋外床面（OuterFloorSurface）、下向きの面を屋外天井面（OuterCeilingSurface）に区分できる。屋外床面は通行可能な面を区分するために使用する。
+
[[fig-N-20]]
.LOD3.1（水門）の境界面の区分のイメージ
image::images/414.webp.png[width="400"]

その他の構造物モデル（堰、樋門）（LOD3.1）の作成例を以下に示す。

[[fig-N-21]]
.その他の構造物モデル（堰）（LOD3.1）の作成例
image::images/415.webp.png[width="400"]

[[fig-N-22]]
.その他の構造物モデル（樋門）（LOD3.1）の作成例
image::images/416.webp.png[width="400"]

[level=6]
====== 堤防

. その他の構造物モデル（LOD3.0）を作成する。
. その他の構造物モデル（LOD3.0）に平面図、断面図若しくは構造図等の付属物の形状が分かる図面又は航空レーザ点群等の点群を用いて、構造上不可欠ではない付属物（手すり、柵、構造物と一体ではない階段）を表現する。
. ユースケースに応じて、a）の境界面のうち、上向きの面を屋外床面（OuterFloorSurface）に区分できる。屋外床面は通行可能な面を区分するために使用する。堤防に階段がある場合は、通行可能な面（階段部）を屋外床面に区分する。

その他の構造物モデル（堤防）（LOD3.1）の作成例を以下に示す。

[[fig-N-23]]
.その他の構造物モデル（堤防）（LOD3.1）の作成例
image::images/417.webp.png[width="500"]


==== 作成上の留意事項

===== 行政界を跨ぐその他の構造物モデルの取り扱い

標準製品仕様書では、その他の構造物のうち、堤防のように延長が長く、構造上の切れ目なく続く場合は、市区町村界で区切ることができるとしている。このとき、市区町村界で区切られたその他の構造物の境界面は、閉鎖面（cons:ClosureSurface）となる。 +
水門や樋門のように単体で設置されているその他の構造物についても、行政界を跨ぐ場合は、その他の構造物モデルを一つのオブジェクトとして作成するため、基本方針としてその他の構造物モデルを区切らないとしている。 +
行政界を跨ぐその他の構造物モデルは、これに関係する市区町村の3D都市モデルに重複して含めてよい。

