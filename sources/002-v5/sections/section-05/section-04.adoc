[[toc5_04]]
=== 成果品のとりまとめ

((3D都市モデル))整備の成果品には、3D都市モデルだけではなく、メタデータ、拡張製品仕様書等も含まれる。本項では、これらを成果品として取りまとめる手順を示す。

[[toc5_04_01]]
==== 成果品の範囲

===== 成果品に含めるべきファイル

((3D都市モデル))整備の成果品として含むべき内容を<<tab-5-3>>に示す。成果品には、全ての地物型や属性が含まれた市町村提出用の3D都市モデル成果品と、これを必要に応じて加工したオープンデータ用の((3D都市モデル))成果品を含む。

それぞれの成果品には、((3D都市モデル))、コードリスト、メタデータ、XML Schema、索引図及び拡張製品仕様を含む。

(((3D都市モデル)))(((建築物)))(((標準製品仕様書)))
[[tab-5-3]]
[cols="7a,1a,1a,9a"]
.成果品一式
|===
^h| 成果品 ^h| 数量 ^h| 単位 ^h| 備考
4+h| 地方公共団体用3D都市モデル成果品
| 3D都市モデル |  1 |  式 | 建築物等のモデルごとにサブフォルダに分割された圧縮ファイル。
| コードリスト |  1 |  式 | 3D都市モデルが参照するコードリスト。
| メタデータ
|  1
|  式
| 3D都市モデルのメタデータ一式。 +
特定の地物型に対して個別にメタデータを作成した場合には、その全てを含む。

| XMLSchema |  1 |  式 | i-UR3.1のXMLSchemaファイル。3D都市モデルは相対パスによりこのXMLSchemaを参照する。
| 索引図 |  1 |  式 | メッシュ単位に分割された3D都市モデルの各ファイルの対象範囲を示す索引図。
| 拡張製品仕様書 |  1 |  式 | 構築した3D都市モデルのデータ製品仕様書。標準製品仕様書を拡張せずに採用した場合においても、個々のデータ製品の名称や日付等を記入した製品仕様書を（拡張製品仕様書）を付する。
4+h| オープンデータ用3D都市モデル成果品
| 3D都市モデルオープンデータ
|  1
|  式
| オープンデータ化可能な項目のみ抽出または加工した3D都市モデル。 +
元となる3D都市モデルと同様のファイル分割を行う。

| コードリスト |  1 |  式 | 3D都市モデルが参照するコードリスト。
| メタデータ（オープンデータ用） |  1 |  式 | オープンデータ用に抽出・加工した3D都市モデルのメタデータ一式。特定の地物型に対して個別にメタデータを作成した場合には、その全てを含む。
| XMLSchema |  1 |  式 | i-UR3.1のXMLSchemaファイル。3D都市モデルは相対パスによりこのXMLSchemaを参照する。
| 索引図（オープンデータ） |  1 |  式 | メッシュ単位に分割された3D都市モデルの各ファイルの対象範囲を示す索引図。
| 拡張製品仕様書（オープンデータ用） |  1 |  式 | オープンデータ用に抽出・加工した3D都市モデルの拡張製品仕様書。

|===

また、建築物等の地物型の((テクスチャ))として使用する画像が存在する場合には、それぞれの成果品に対して、<<tab-5-4>>に示す画像を含めて格納する。

(((テクスチャ)))(((3D都市モデル)))
[[tab-5-4]]
[cols="7a,1a,1a,9a"]
.成果品として追加される画像
|===
^h| 成果品 ^h| 数量 ^h| 単位 ^h| 備考
4+h| 地方公共団体用3D都市モデル成果品
| テクスチャ用画像 |  1 |  式 | Appearanceモジュールを使用して地物に付与されるテクスチャ画像。
4+h| オープンデータ用3D都市モデル成果品
| テクスチャ用画像（オープンデータ用） |  1 |  式 | Appearanceモジュールを使用して地物に付与されるテクスチャ画像。

|===

なお、整備対象都市（基礎自治体である市区町村を単位とする）において((3D都市モデル))が存在しており、その一部更新に該当する場合には、更新部分も含めて最大範囲のデータに統合し、一式とする。

作成したデータ製品（((3D都市モデル))）やメタデータ等、<<tab-5-3>>及び<<tab-5-4>>に示す成果品を、以下の手順により取りまとめる。

(((3D都市モデル)))

* 【手順】
* 手順1．3D都市モデル及びオープンデータが、製品仕様に指定されたファイル単位に分割されていることを確認する。ファイル単位は<<toc5_04_02>>を参照すること。
* 手順2．3D都市モデル及びオープンデータ、各メタデータ、また、データ製品の製品仕様の各ファイルについて、指定されたファイル形式になっていることを確認する。ファイル形式は<<toc5_04_03>>を参照すること。
* 手順3．3D都市モデル及びオープンデータ、各メタデータ、また、データ製品の製品仕様の各ファイルについて、指定されたファイル命名規則に従ったファイル名称になっていることを確認する。ファイル名称は、<<toc5_04_04>>を参照すること。
* 手順4．データ格納媒体に、3D都市モデル及びオープンデータ、各メタデータ、また、データ製品の製品仕様の各ファイルを指定された階層構造で格納する。フォルダ名称及びフォルダ構成は、<<toc5_04_05>>を参照すること。
* 手順5．3D都市モデル及びオープンデータに含まれるメッシュコード及びその位置を対応付けた索引図を作成する。索引図は、成果品のルートフォルダ直下に格納する。

===== 成果品の単位

((3D都市モデル))のデータセットは、原則として基礎自治体（市区町村）を単位とする。

ただし、((3D都市モデル))の提供者が以下に該当する場合は、成果品を分けることができる。

* 国土交通省
* 都道府県
* ユーティリティ事業
* 道路事業
* 鉄道事業

成果品を分ける場合は、((標準製品仕様書))に示すルートフォルダの命名規則に従い、成果品の名称の``[提供者]``を指定すること（<<toc5_04_01>>）。

[NOTE,type=commentary]
--
3D都市モデルの作成主体及び提供主体は市区町村が主となるが、将来的にはライフライン事業者や鉄道事業者などの公益事業者や、商業施設を保有する民間事業者がそれぞれ保有する施設の情報を3D都市モデルとして作成・提供するというように、3D都市モデルの作成・提供主体が様々となる可能性がある。

そこで、3D都市モデルの提供者を識別するために、成果品のフォルダ名称に``[提供者区分]``を設け、提供者ごとに成果品を作成してよいこととしている。
--

// (((3D都市モデル)))

[requirement]
.都道府県データセットは市区町村データセットと分ける
====
[%metadata]
identifier:: /att/deliverable/6
subject:: 標準作業手順
class:: 留意事項
[statement]
--
都道府県のデータセットを作成する場合は、市区町村のデータセットとは別に作成する。

3D都市モデルのデータセットは、基礎自治体（市区町村）を基本の単位とする。一方で、土砂災害警戒区域のように都道府県単位等市区町村の行政界を越えて整備されたデータは、各市区町村に分割されて格納されることで、その全体像が分かりづらく、利用しづらい場合がある。そこで、都道府県のデータセットを作成してもよいとしている。このとき、都道府県のデータセットは市区町村のデータセットに含めるのではなく、市区町村のデータセットとは別のデータセットとして作成しなければならない。 +
都道府県のデータセットに含まれるデータの一部は、都道府県下の市区町村の3D都市モデルにも、同じデータが重複して格納されることになる。
--
====

===== 成果品の空間範囲

((3D都市モデル))のデータセットは、基礎自治体を基本とするため、成果品の空間範囲も基礎自治体の行政区域が基本となる。

ただし、行政界を跨ぐ都市オブジェクトは、行政界では区切らず、それぞれの市区町村のデータセットに重複して含めることを許容している。

// (((3D都市モデル)))

[requirement]
.行政界跨る都市オブジェクトは重複含む
====
[%metadata]
identifier:: /att/deliverable/7
subject:: 標準作業手順
class:: 留意事項
[statement]
--
行政界を跨ぐ都市オブジェクトは、それぞれの都市の3D都市モデルに重複して含まれる。

行政界を跨ぐ都市オブジェクトは、3D都市モデルのユーザビリティの観点から、それぞれの市区町村のデータセットに含めることを基本としている。そのため、隣接する市区町村の3D都市モデルには、重複したデータが含まれる場合があることに留意する必要がある。都道府県等複数の市区町村が含まれる空間範囲で3D都市モデルを整備し、これを成果品として市区町村のデータセットに分割する場合には、市区町村の行政界にかかるメッシュに含まれるデータは、それぞれの市区町村のデータセットに重複して含まれる。
--
====

// (((3D都市モデル)))(((建築物)))

[requirement]
.行政界跨ぎ地物の振り分け基準
====
[%metadata]
identifier:: /att/deliverable/8
subject:: 標準作業手順
class:: 留意事項
[statement]
--
行政界を跨ぐ地物のデータをそれぞれの都市で重複させない場合は、住所、管理主体又は地物の面積若しくは延長が含まれる割合により、いずれかの市区町村に振り分ける。このとき、面状の地物は上からの正射影の面積、線状の地物は上からの正射影の延長とする。

隣接する市区町村の3D都市モデルに、行政界を跨ぐ都市オブジェクトを重複させない場合は、以下方法により、いずれかの市区町村のデータセットに振り分ける。

* 都市オブジェクトが立地する場所の「住所」の市区町村
* 都市オブジェクトの「管理主体」の市区町村
* 都市オブジェクトを「水平面に投影した外形が含まれる面積の大きさ又は延長の長さ」の割合が大きい市区町村
** この場合、面状の都市オブジェクトは上からの正射影が含まれる面積が大きい市区町村、線状の地物は含まれる延長が長い市区町村とする。

例えば、行政界を跨ぐ建築物があった場合、住所が分かる場合は住所が割り当てられている市区町村、住所がない場合は、上から見た正射影の面がより多く含まれる市区町村のデータセットに含める。
--
====

// (((建築物)))

[requirement]
.境界未確定部の取り扱いは基本通り
====
[%metadata]
identifier:: /att/deliverable/9
subject:: 標準作業手順
class:: 留意事項
[statement]
--
境界未確定部の取り扱いは、市区町村の都市計画基本図（数値地形データ）での取り扱いに準じることを基本とする。

行政界が確定しておらず、いずれの市区町村に含めるべきかが確定していない場所（境界未確定部）に立地する建築物等をいずれのデータセットに含めるかは、整備対象となる市区町村の都市計画基本図（数値地形図データ）での取り扱いに準じる。 +
数値地形図データが広域で整備されている等により判断できない場合は、発注者との協議により決定する。
--
====

// (((3D都市モデル)))

[requirement]
.市区町村内複数主体の3Dモデル統合
====
[%metadata]
identifier:: /att/deliverable/10
subject:: 標準作業手順
class:: 留意事項
[statement]
--
複数のモデル整備主体が、同一市区町村の3D都市モデルを整備する場合は、一つのデータセットに統合する。

同一の市区町村において、複数のモデル整備主体（例：県と市）が3D都市モデルを整備する場合、それぞれが整備した3D都市モデルはモデル整備事業者が統合しなければならない。このとき、ファイル名の``[オプション]``を使用して、データセット内においてモデル整備主体ごとのファイルを分けることができる。また、同一市区町村の同一の地物型について、同一メッシュに対して複数のファイルが作成されることを許容する。
--
====

[[toc5_04_02]]
==== ファイル単位とファイルサイズ

((3D都市モデル))のファイル単位は、「JIS X 0410 地域メッシュコード」に定められた統合地域メッシュ（第2次地域区画、一辺の長さ約10km）又は基準地域メッシュ（第3次地域区画、一辺の長さ約1km）単位を基本とし、<<tab-5-5>>に示す応用スキーマの単位により分割する。また、一つのファイルには、同一の空間参照系のオブジェクトのみを含む。 

ただし、地下埋設物モデルについては、<<gsi_ops,付録７ 公共測量標準図式>>　第84条において定められた国土基本図の図郭をファイル単位とする。国土基本図の図郭は、地図情報レベル2500（一辺の長さ南北1.5㎞、東西2㎞）とする。 

なお、洪水浸水想定区域、津波浸水想定、高潮浸水想定区域及び内水浸水想定区域は、さらに<<tab-5-5>>に示す単位にファイルを分割すること。

(((建築物)))(((都市計画決定情報)))
[[tab-5-5]]
include::../../../common/sections/com_7_02_5_04_001.adoc[]

////
[cols="2a,3a"]
.ファイル単位
|===
^h| 応用スキーマ ^h| ファイル単位
| 建築物 .13+| 基準地域メッシュ（第3次地域区画）
| 橋梁
| トンネル
| その他の構造物
| 地下街
| 都市設備
| 植生
| 道路
| 鉄道
| 徒歩道
| 広場
| 航路
| 汎用都市オブジェクト
| 地形 .7+| 統合地域メッシュ（第2次地域区画）
| 土地利用
| 水部
| 土砂災害警戒区域
| 都市計画決定情報
| その他の区域
| 拡張製品仕様書において拡張した地物
| 洪水浸水想定区域
| 基準地域メッシュ（第3次地域区画） +
加えて、同一のメッシュに複数の洪水予報河川や水位周知河川が含まれている場合は、洪水予報河川及び水位周知河川の単位とする。また、「洪水浸水想定（計画規模）」と「洪水浸水想定（想定最大規模）」とはそれぞれファイルを分ける。

| 津波浸水想定、高潮浸水想定区域、内水浸水想定区域、ため池ハザードマップ
| 統合地域メッシュ（第2次地域区画） +
加えて、計算条件等の設定が複数設定されている場合は、設定毎にファイルを分ける。

|===
////

作成したファイルをウェブサイトにアップロードしたり、ウェブサイトからダウンロードしたりする際の通信環境や、ソフトウェアでの読み込み時の処理能力を考慮し、1ファイルのデータ量は最大1GBとする。これを超えた場合にはファイルを分割する。

ファイル分割は、より細かいメッシュの集合となるように行う。ファイルを分割する場合のルールを<<tab-5-6>>に示す。分割したファイルは、同じメッシュが重複して含まれないように注意すること。 

また、ファイルの境界では地物の分割は行わない。複数のメッシュに跨って存在する地物は、それぞれのメッシュに平面投影した形状が含まれる面積の割合を算出し、この割合が最も大きいメッシュに対応するファイルに含む。ファイル面積は、m2で計算し、小数点2桁（3桁目で四捨五入）で比較する。面積が同じ場合はメッシュ番号の小さい方とする。

[[tab-5-6]]
include::../../../common/sections/com_7_02_5_04_002.adoc[]

////
[cols="2a,3a"]
.ファイル分割ルール
|===
^h| 基本となるファイル単位 ^h| 分割ルール
| 第2次地域区画
|
緯線方向、経線方向に2等分に区切る「4分割」を基本とする。

.4分割の例
image::images/026.webp.png[width="300"]

4分割したファイルであっても、ファイルサイズが上限を超える場合は、上限を超えるファイルのみを第3次地域区画に分割する。 +
第3次地域区画に分割したファイルであっても、ファイルサイズが上限を超える場合は、上限を超えるファイルのみを第3次地域区画をファイル単位とする場合の分割ルールに従い分割する。

| 第3次地域区画 
|
2分の1地域メッシュ（第3次地域区画を緯線方向、経線方向に2等分してできる区域）に分割することを基本とする。

.2分の1地域メッシュの例
image::images/027.webp.png[width="300"]

2分の1地域メッシュに分割したファイルであっても、ファイルサイズが上限を超える場合は、上限を超えるファイルのみを4分の1地域メッシュ（2分の1メッシュを緯線方向、経線方向に2等分してできる区域）に分割する。

.4分の1地域メッシュの例
image::images/028.webp.png[width="300"]

なお、4分の1地域メッシュに分割してもファイルサイズが上限を超える場合は、ファイル名称の``[オプション]``を使用し、ファイルを分割する。

|===
////
　

[NOTE,type=commentary]
--
地域メッシュとは、緯度・経度に基づき地域を隙間なく網の目（メッシュ）の区域に分けたものである。ほぼ同一の大きさ及び形状の区画を単位として区分されているため、地域メッシュ相互間の事象の計量的比較が容易となる。また、行政区域の変更等の影響を受けないため、次章の時系列的比較も容易となる。

3D都市モデルのファイル単位に使用する地域メッシュは、昭和48年7月12日行政管理庁告示第143号に基づく「標準地域メッシュ」であり、「JIS X 0410 地域メッシュコード」として日本産業規格に制定されている。

地域メッシュの区分方法や市区町村別メッシュコード一覧は、総務省統計局のウェブサイト「地域メッシュ統計」（ http://www.stat.go.jp/data/mesh/index.html ）を参照のこと。
--

[requirement]
.地下埋設物モデルの分割
====
[%metadata]
identifier:: /att/deliverable/11
subject:: 標準作業手順
class:: 留意事項
[statement]
--
地下埋設物モデルがファイルサイズの上限（1GB）を超える場合は、上限を超えるファイルのみを、国土基本図の図郭（地図情報レベル500）に分割する。
--
====

[[toc5_04_03]]
==== ファイル形式

成果品に含むべき各ファイルのファイル形式を<<tab-5-7>>に示す。

(((3D都市モデル)))(((テクスチャ)))
[[tab-5-7]]
[cols="5a,4a,11a",options="header"]
.成果品のファイル形式
|===
| 成果品 | ファイル形式 | 備考

| 3D都市モデル | GML |
| コードリスト | XML |
| XMLSchema | XSD |
| メタデータ | XML |
| 拡張製品仕様書
| PDF及びExcel
| 拡張製品仕様書は、PDFで格納する。

また、拡張製品仕様書の作成に使用した、本書<<tocA>>に示す様式はExcel形式で格納する。

| 索引図 | PDF |
| 画像（テクスチャ） | PNGまたはJPEG | 3D都市モデルにテクスチャが貼られている場合

|===

[[toc5_04_04]]
==== ファイル名称

成果品に含むべき各ファイルの名称に適用する命名規則を示す。 +
なお、オープンデータ用のファイルのファイル名称は、原則として、地方公共団体用((3D都市モデル))成果品のファイル名称の末尾に_opを付与する。詳細を各項に示す。

[[toc5_04_04_01]]
===== 3D都市モデルのファイル名称

指定されたファイル単位に分割された((3D都市モデル))のファイル名称は``[メッシュコード]\_[地物型]_[CRS]\_[オプション]``とする。拡張子を含めたファイル名称は、``[メッシュコード]_[地物型]\_[CRS]_[オプション].gml``となる。 +
各記号の意味を<<tab-5-8>>に示す。

// this table is_common to both doc01 and doc02 slide01

[[tab-5-8]]
include::../../../common/sections/com_7_02_5_04_003.adoc[]

////
[cols="5a,8a,7a",options="header"]
.ファイル名の構成要素
|===
| ファイル名称の構成要素 | 説明 | 使用可能な文字

| `[メッシュコード]`
| ファイル単位となる地域メッシュのメッシュコード又は国土基本図郭の図郭番号
| 半角英数字

| `[地物型]`
| 格納された地物の種類を示す接頭辞
| 半角英数字

| `[CRS]`
| 格納された地物に適用される座標参照系
| 半角数字

| `[オプション]`
| 必要に応じてファイルを細分したい場合の識別子（オプション）
| 半角英数字。区切り文字を使用したい場合は半角のハイフンのみ。

| `_`
| ファイル名称の構成要素同士の区切り文字
|
ファイル名称の構成要素同士を区切る場合には、アンダースコア（ `_` ）のみを用いる。
ファイル名称の構成要素の中を区切る場合は、ハイフン（ `-` ）を用いる。いずれも半角とする。

|===
////

``[地物型]``にはファイルに含まれる応用スキーマを識別する接頭辞を付与する。((標準製品仕様書))に定義する接頭辞を<<tab-5-9>>に示す。

(((建築物)))(((都市計画決定情報)))
[[tab-5-9]]
include::../../../common/sections/com_7_02_5_04_004.adoc[]

////
[cols="2a,2a,1a"]
.接頭辞
|===
2+^h| 応用スキーマ ^h| 接頭辞
2+| 建築物モデル ^| bldg
2+| 交通（道路）モデル ^| tran
2+| 交通（鉄道）モデル ^| rwy
2+| 交通（徒歩道）モデル ^| trk
2+| 交通（広場）モデル ^| squr
2+| 交通（航路）モデル ^| wwy
2+| 土地利用モデル ^| luse
.5+| 災害リスク（浸水）モデル | 洪水浸水想定区域 ^| fld
| 津波浸水想定 ^| tnm
| 高潮浸水想定区域 ^| htd
| 内水浸水想定区域 ^| ifld
| ため池ハザードマップ ^| rfld
| 災害リスク（土砂災害）モデル | 土砂災害警戒区域 ^| lsld
2+| 都市計画決定情報モデル ^| urf
2+| 橋梁モデル ^| brid
2+| トンネルモデル ^| tun
2+| その他の構造物モデル ^| cons
2+| 都市設備モデル ^| frn
2+| 地下埋設物モデル ^| unf
2+| 地下街モデル ^| ubld
2+| 植生モデル ^| veg
2+| 地形モデル ^| dem
2+| 水部モデル ^| wtr
2+| 区域モデル ^| area
2+| 汎用都市オブジェクト ^| gen
2+| アピアランスモデル ^| app
2+| 拡張製品仕様書で追加した地物（ただし、urf:Zoneを継承する地物を除く） ^| ext

|===
////

`[CRS]` には、オブジェクトに適用される空間参照系の略称を使用する。略称を<<tab-5-10>>に示す。ただし、「日本測地系2011における平面直角座標系と東京湾平均海面を基準とする標高の複合座標参照系」は地下埋設物モデルのみに適用する。

(((標準製品仕様書)))(((建築物)))
[[tab-5-10]]
[cols="4a,1a",options="header"]
.空間参照系の略称
|===
| オブジェクトに適用される空間参照系 | 略称

| 日本測地系2011における経緯度座標系と東京湾平均海面を基準とする標高の複合座標参照系 | 6697
| 日本測地系2011における平面直角座標系と東京湾平均海面を基準とする標高の複合座標参照系 | 下記のいずれかのコードを使用する。 +
10162 +
10163 +
10164 +
10165 +
10170 +
10166 +
10167 +
10168 +
10169 +
10171 +
10172 +
10173 +
10174

|===

　

[NOTE,type="explanation"]
--
<<tab-5-10>>に示す空間参照系の略称は、EPSGコードと呼ばれる、空間参照系を識別するコードである。

「日本測地系2011における平面直角座標系と東京湾平均海面を基本とする標高の複合座標参照系」の略称は、適用される平面直角座標系の系により、区分されている。

 10162：第Ⅰ系　10163：第Ⅱ系　10164：第Ⅲ系　10165：第Ⅳ系　10166：第Ⅴ系　10167：第Ⅵ系　10168：第Ⅶ系　10169：第ⅷ系　10170：第Ⅸ系　10171：第Ⅹ系　10172：第Ⅺ系　10173：第Ⅻ系　10174：第ⅩⅢ系

--

[example]
.``[メッシュコード]``、``[地物型]``及び``[CRS]``により構成されるファイル名称の例
====
`53394610_bldg_6697`
（拡張子を含めると、53394610_bldg_6697.gml）
====

例示した名称のファイルには、基準地域メッシュコード53394610に区分される範囲に含まれる、建築物、建築物部分、建築物付属物及びこれらの境界面が含まれる、「日本測地系2011における経緯度座標系と東京湾平均海面を基準とする標高」の複合座標参照系により記述されたデータ集合が格納される。 

``[オプション]``は、メッシュ単位及び地物型単位となるファイルをさらに分割したい場合に使用する。使用しない場合は区切り文字と共に省略する（``[オプション]``を省略する場合は、``[メッシュコード]\_[地物型]_[CRS].gml``となる）。

標準製品仕様書で定義する``[オプション]``の文字列を<<tab-5-11>>に示す。

``[オプション]``として、<<tab-5-11>>に示す文字列を複数使用したい場合は、区切り文字を用いて文字列をつなげ、``[オプション]``に使用する文字列とする。

``[オプション]``に使用する文字列として、``[識別子]``を使用する場合は、拡張製品仕様書においてオプションの文字列、適用するフォルダの名称、オプションの意味の一覧を作成する。

// rwp 20240816 revise as per slide file 20240802 slide 05
// original doc2 code below table structure modified to match doc1
// ok to delete this code block below

////

.2+| f``[識別子]``
| gen
| 汎用都市オブジェクトのファイルを、地物の種類ごとに分けたい場合に使用する。``[識別子]``は、コードリスト（GenericCityObject_name.xml）のコードと一致させる。

このオプションを使用する場合は、拡張製品仕様書において使用するオプションの一覧を示さなければならない。

| ext
| 拡張製品仕様書で追加した地物のファイルを、地物ごとに分けたい場合に使用する。``[識別子]``は、任意の半角数字の組み合わせとする。

このオプションを使用する場合は、拡張製品仕様書において使用するオプションの一覧を示さなければならない。

| ``[識別子]`` | udx以下の全てのサブフォルダ | その他の事由によりファイルを分割する場合に使用する。``[識別子]``は、任意の半角英字の組み合わせとするが、標準製品仕様書が定めるオプションの文字列と一致してはならない。

////

// this table is_common to both doc01 and doc02 slide05

(((標準製品仕様書)))
[[tab-5-11]]
include::../../../common/sections/com_7_02_5_04_005.adoc[]

////
[cols="1a,1a,3a"]
.オプションに使用する文字列
|===
| オプション | 適用するフォルダ名 | オプションの意味

| l1 | fld | ファイルに含まれる洪水浸水想定区域が対象とする降雨規模が計画規模
| l2 | fld | ファイルに含まれる洪水浸水想定区域が対象とする降雨規模が想定最大規模
| 05 | urf | 都市計画区域及び準都市計画区域
| 07 | urf | 区域区分
| 08 | urf | 地域地区
| 10-2 | urf | 促進区域
| 10-3 | urf | 遊休土地転換利用促進地区
| 10-4 | urf | 被災市街地復興推進地域
| 11 | urf | 都市施設
| 12 | urf | 市街地開発事業
| 12-2 | urf | 市街地開発事業等の予定区域
| 12-4 | urf | 地区計画等
| lnp | urf | 都市機能誘導区域及び居住誘導区域
| lod3 | dem | 地形モデル（LOD3）を分けて格納したデータを意味する。
| f``[識別子]`` | gen | 汎用都市オブジェクトのファイルを、地物の種類ごとに分けたい場合に使用する。``[識別子]``は、コードリスト（GenericCityObject_name.xml）のコードと一致させる。 +
このオプションを使用する場合は、拡張製品仕様書において使用するオプションの一覧を示さなければならない。
| f``[識別子]`` | ext | 拡張製品仕様書で追加した地物のファイルを、地物ごとに分けたい場合に使用する。``[識別子]``は、任意の半角英数字の組み合わせとする。 +
このオプションを使用する場合は、拡張製品仕様書において使用するオプションの一覧を示さなければならない。
| ``[識別子]`` | udx以下の全てのサブフォルダ | その他の事由によりファイルを分割する場合に使用する。``[識別子]``は、任意の半角英数字の組み合わせとする。ただし、他のオプションの文字列と重複してはならない。 +
このオプションを使用する場合は、標準製品仕様書において使用するオプションの一覧を示さなければならない。

|===
////

それぞれの文字列は、以下の場合に使用する。

====== 洪水浸水想定区域のファイル名称

洪水浸水想定区域のファイル名称は、``[メッシュコード]\_[地物型]_[CRS]_[オプション]``を適用し、``[オプション]``が取りうる値は、l1又はl2とする（「l1」は、小文字のエルと数字のイチの組み合わせ、「l2」は小文字のエルと数字の二の組み合わせ）。ファイルに含まれる洪水浸水想定区域が対象とする降雨規模が計画規模の場合には、l1を使用し、想定最大規模の場合はl2を使用する。

[example]
.洪水浸水想定区域のファイル名称の例
====
`533946_fld_6697_l1`
（拡張子を含めると、`533946_fld_6697_l1.gml`）
====

====== 都市計画決定情報のファイル名称
(((都市計画決定情報)))

都市計画決定には様々な種類があるため、これらが全て同じフォルダに混在すると、データの利便性が損なわれる恐れがある。そこで、((標準製品仕様書))ではあらかじめ都市計画の種類ごとにオプションとして使用する文字を定め、都市計画の種類ごとにファイルを分けて作成するように定義している。

====== 高精度な地形モデルのファイル名称

((3D都市モデル))では、同一の都市オブジェクトの幾何を、異なるLODを用いて一つの地物インスタンスとして記述することが基本となる。ただし、地形モデルの場合は地物の単位が基準地域メッシュとなり、同一の地物インスタンスに複数のLODを格納することでデータ量が膨大となり、操作性が低下する懸念がある。 

そこで、地形モデル（LOD3）は、ファイル名のオプション（lod3）を用いてファイルを分けてもよい。このとき、gml:nameには対象となる基準地域メッシュのメッシュ番号が記載されるため、これを用いて同一の都市オブジェクトとして扱うことができる。

====== 拡張製品仕様書で追加した地物のファイル名称

拡張製品仕様書において汎用都市オブジェクトを追加した場合及び((標準製品仕様書))には含まれていない地物を((i-UR))から追加した場合は、それぞれのモデルを格納するフォルダ（gen及びext）において、オプションの文字列を用いて追加した地物の種類ごとにファイルを分けることができる。このとき、オプションの文字列は、f``[識別子]``を使用する。このとき``[識別子]``は半角数字の組み合わせとする。

[example]
.追加した汎用都市オブジェクトのファイル名称の例
====
`533946_gen_6697_f20`
（拡張子を含めると、`533946_gen_6697_f20.gml`）
====

====== 拡張製品仕様書での任意のオプション文字列の追加

その他の事由により、ファイルを分割したい場合は、``[オプション]``に使用する文字列として``[識別子]``を指定し、これを用いることでファイルを分割できる。このとき、拡張製品仕様書に示す「表7-8　本製品仕様書で追加するオプションに使用する文字列」に``[識別子]``として指定する文字列とその説明を記載しなければならない。

ファイルを分割する例を示す。(((3D都市モデル)))

. 基本となるメッシュからファイルを分割した場合
+
--
ファイルサイズにより基本となるメッシュからファイルを分割した場合（<<toc5_04_02>>参照）は、``[オプション]``を使用する。``[オプション]``には、分割後の位置を示す数字を使用する。

第2次地域区画を4分割したファイルの名称に使用する``[オプション]``の数字及びその位置を<<fig-5-2>>に示す。このとき、``[メッシュ]``には、第2次地域区画のメッシュコードを使用する。

[[fig-5-2]]
.第2次地域メッシュを4分割した場合に使用する``[オプション]``の数字と分割したファイルの位置
image::images/029.webp.png[width="300"]

[example]
.``[オプション]``を使用して、4分割したファイルの名称の例
====
`533935_dem_6697_00`
（拡張子を含めると、`533935_dem_6697_00.gml`）
====

なお、第2次地域区画を第3次地域区画に分割した場合は、``[オプション]``は使用せず、``[メッシュ]``に第3次地域区画のメッシュコードを使用する。 

第3次地域区画を2分の1メッシュに分割したファイルの名称に使用する``[オプション]``の数字及びその位置を<<fig-5-3>>に示す。このとき、``[メッシュ]``には、第3次地域区画のメッシュコードを使用する。

[[fig-5-3]]
.2分の1地域メッシュに分割した場合に使用する``[オプション]``の数字と分割したファイルの位置
image::images/030.webp.png[width="300"]

[example]
.``[オプション]``を使用して、2分の1メッシュに分割したファイルの名称の例
====
`53393500_bldg_6697_1`
（2分の1メッシュ左下）　（拡張子を含めると、`53393500_bldg_6697_1.gml`）
====

同様にして、4分の1メッシュに分割したファイルの名称に使用する``[オプション]``の数字及びその位置を<<fig-5-4>>に示す。このとき、``[メッシュ]``には、第3次地域区画のメッシュコードを使用する。

[[fig-5-4]]
.4分の1地域メッシュに分割した場合に使用する``[オプション]``の数字と分割したファイルの位置
image::images/031.webp.png[width="500"]

[example]
.``[オプション]``を使用して、4分の1メッシュに分割したファイルの名称の例
====
`53393500_bldg_6697_11`
（拡張子を含めると、`53393500_bldg_6697_11.gml`）
====
--

. 同一の地物型のデータを複数のモデル整備事業者が整備する場合
+
--
``[識別子]``を用いて区分する。事業者を識別する識別子を決め、拡張製品仕様書に示す「表 7-8　本製品仕様書で追加するオプションに使用する文字列」に事業者ごとの識別子を記載する。

.拡張製品仕様書でのオプション文字列の追加例
image::images/032.webp.png[]
--

. 成果品が複数種類ある場合
+
--
特段の事情により成果品を複数種類作成する場合は、``[識別子]``を使用していずれの成果品のデータであるかを識別できるようにする。このとき、``[識別子]``に使用する文字列は成果品を格納するルートフォルダに使用する``[オプション]``と一致させること。 

なお、成果品が複数種類ある場合でも、内容が変わらない地物型のファイル名称は、``[識別子]``を省略してよい。例えば、建築物（bldg）、道路（tran）、土地利用（luse）から構成される3D都市モデルから、建築物の属性のみが異なる複数の成果品を作成する場合、同一の内容となる道路と土地利用の3D都市モデルファイルには``[オプション]``は不要となる。
--

====== 複数のオプション文字列を組み合わせる場合

複数のオプションの文字列を、区切り文字（-）でつなぐ。((標準製品仕様書))に定義済みのオプション値と、拡張製品仕様書において追加したオプション値を同時に使用する場合は、最初に((標準製品仕様書))に定義したオプション値を記載し、次に拡張製品仕様書で追加したオプション値を記載する。

[example]
.ファイル名の例：ファイルを地形モデル（LOD3）で分け、さらに事業者で分けた場合
====
`56384642_dem_6697_lod3-aac`
（拡張子を含めると、`56384642_dem_6697_lod3-aac.gml`）
====

====== オープンデータのファイル名称
(((オープンデータ)))

オープンデータとなる((3D都市モデル))のファイル名称は、元となる((3D都市モデル))のファイル名称に「 `\_op` 」を付与し、
``[メッシュコード]_[地物型]\_[CRS]_[オプション]_op``
とする。

[example]
.ファイル名称の例
====
`53394610_bldg_6697_op`
（拡張子を含めると、`53394610_bldg_6697_op.gml`）
====

例示したファイルには、基準地域メッシュコード53394610に区分される範囲に含まれる、建築物、建築物部分、建築物付属物及びこれらの境界面が含まれる、日本測地系2011における経緯度座標系と東京湾平均海面を基準とする標高の複合座標参照系により記述されたデータ集合からオープンデータ化が可能なデータが抽出されたデータ集合が格納される。

[[toc5_04_04_02]]
===== コードリストのファイル名称

作成したコードリストのファイル名称は、「<<toc1_04>>標準製品仕様書の拡張」においてコード型の属性を追加した手順に示すとおりとする。オープンデータ用のコードリストには、_opは付与しない。

[[toc5_04_04_03]]
===== メタデータのファイル名称

((3D都市モデル))のメタデータファイルの名称は、``udx\_[都市コード]_[整備年度]\_[地物型]_[オプション]``とする。 +
``[都市コード]``及び``[整備年度]``の命名規則は、ルートフォルダの命名規則（<<toc5_04_05_02>>）に従う。 +
``[地物型]``は地物型を識別する接頭辞（<<tab-5-9>>）とする。 +
``[オプション]``は、メタデータを分けたい場合（<<toc5_03_01>>）に、それぞれのメタデータを識別するために使用する任意の半角英数字とする。 +

[example]
.地物型ごとにメタデータを作成する場合のファイル名称の例
====
`udx_23100_2020_fld`
（拡張子を含めると、`udx_23100_2020_fld.xml`）
====

[example]
.地物型をまとめてメタデータを作成する場合のファイル名称の例
====
`udx_23100_2020`
（拡張子を含めると、`udx_23100_2020.xml`）
====

なお、オープンデータのメタデータには、末尾に_opが付く。

[example]
.地物型ごとにオープンデータのメタデータを作成する場合のファイル名称の例
====
`udx_23100_2020_fld_op`
（拡張子を含めると、`udx_23100_2020_fld_op.xml`）
====

[example]
.地物型をまとめてオープンデータのメタデータを作成する場合のファイル名称の例
====
`udx_23100_2020_op`
（拡張子を含めると、`udx_23100_2020_op.xml`）
====

[[toc5_04_04_04]]
===== 製品仕様のファイル名称

((3D都市モデル))の製品仕様のファイル名称は、``[都市コード]\_[提供者区分]_[整備年度]\_specification``とする。また、<<tocA>>に示す様式に従い作成した応用スキーマ文書やコードリスト等の表のファイル名称は、``[都市コード]_[提供者区分]_[整備年度]_objectlist``
とする。

``[都市コード]``、``[提供者区分]``及び``[整備年度]``の命名規則は、ルートフォルダの命名規則（<<toc5_04_05_02>>）に従う。

[example]
.製品仕様のファイル名称の例
====
`27100_city_2020_specification`
（拡張子を含めると、`27100_city_2020_specification.pdf`）
====

[example]
.様式Ａのファイル名称の例
====
`27100_city_2020_objectlist`
（拡張子を含めると、`27100_2020_objectlist.xlsx`）
====

オープンデータの製品仕様のファイル名称には、末尾に_opを付ける。

[example]
.オープンデータ用製品仕様のファイル名称の例
====
`27100_city_2020_specification_op`
（拡張子を含めると、`27100_city_2020_specification_op.pdf`）
====

[example]
.オープンデータ用様式Ａのファイル名称の例：
====
`27100_city_2020_objectlist_op`
（拡張子を含めると、`27100_city_2020_objectlist_op.xlsx`）
====

[[toc5_04_04_05]]
===== 索引図のファイル名称

索引図のファイル名称は、``[都市コード]_indexmap``とする。

``[都市コード]``の命名規則は、ルートフォルダの命名規則（<<toc5_04_05_02>>）に従う。

[example]
.索引図のファイル名称の例
====
`27100_indexmap` （拡張子を含めると、`27100_indexmap.pdf`）
====

オープンデータの索引図のファイル名称には、末尾にopを付ける。

[example]
.オープンデータ用索引図のファイル名称の例
====
`27100_indexmap_op`
（拡張子を含めると、`27100_indexmap_op.pdf`）
====

[[toc5_04_04_06]]
===== 画像のファイル名称

地物型に使用する((テクスチャ))用の画像ファイルのファイル名称（拡張子を除いた部分）には、任意の半角英数字及び半角記号（ハイフン又はアンダースコアのみ）を使用する。

[[toc5_04_04_07]]
===== 三次元点群データのファイル名称

都市オブジェクトに対応する三次元点群データのファイル名称（拡張子を除いた部分）には、任意の半角英数字及び半角記号（ハイフン又はアンダースコアのみ）を使用する。

[[toc5_04_05]]
==== フォルダ構成とフォルダ名称

成果品のフォルダ構成及びフォルダ名称は以下に示す規則に従う。

[[toc5_04_05_01]]
===== 成果品のフォルダ構成

地方公共団体用((3D都市モデル))成果品は、ルートフォルダを作成する。ルートフォルダの中にファイルの種類ごとのサブフォルダを作成し、サブフォルダごとに指定された全てのファイルを格納する。

成果品のフォルダの構成及びフォルダの名称を<<tab-5-13>>に示す。 成果品のフォルダ（サブフォルダを含む）の名称には半角英数字及び半角記号（アンダースコア及びハイフン）のみを使用する。

各都市において作成する拡張製品仕様書には、フォルダ構成、フォルダ名称及び各フォルダの説明を示すこと。これらは、拡張製品仕様書「第7章　データ製品配布」のうち、「7.2配布媒体情報」の中の「7.2.4 フォルダ構成」に記載する。

「udx」に設ける地物型ごとのサブフォルダの内、洪水浸水想定区域（サブフォルダ名「fld」）、津波浸水想定（サブフォルダ名「tnm」）、高潮浸水想定区域（サブフォルダ名「htd」）及び内水浸水想定区域（サブフォルダ名「ifld」）には、さらにサブフォルダを設ける。サブフォルダの作成及び命名規則を、それぞれ本項の<<toc5_04_05_04>>及び<<toc5_04_05_05>>に示す。

また、Appearanceモジュールを使用し、((テクスチャ))画像を格納する場合のサブフォルダの作成及び命名規則を<<toc5_04_05_06>>、PointCloudモジュールを使用し、三次元点群データを格納する場合のサブフォルダの作成及び命名規則を<<toc5_04_05_07>>に示す。

なお、作成対象となる地物型のフォルダのみを作成すること。例えば、((3D都市モデル))に土砂災害警戒区域のデータが含まれない場合は、「lsld」のサブフォルダは不要である。

[[tab-5-13]]
include::../../../common/sections/com_7_02_5_04_006.adoc[]

////
[cols="3a,3a,3a,3a,3a,3a,8a,24a",options="header"]
.フォルダ構成
|===
6+| フォルダ構成 | フォルダ名 | フォルダの説明

2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

4+|
^| `[都市コード]\_[都市名英名]_[提供者区分]\_[整備年度]_citygml_[更新回数]_[オプション]`
| 成果品を格納するフォルダのルート。 +
このフォルダの直下に格納するファイルは索引図及びREADMEのみであり、その他のファイルはこのフォルダに設けたサブフォルダに格納する。 +
フォルダの名称は、ルートフォルダの命名規則に従う。

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| codelists
| ルートフォルダ直下に作成された、コードリストを格納するフォルダ。3D都市モデルが参照する全てのコードリストを格納する。

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| metadata
| ルートフォルダ直下に作成された、メタデータを格納するフォルダ。

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| schemas
| 3D都市モデルのGMLSchemaを格納するフォルダ。GMLSchemaは指定された版のi-URをG空間情報センターより入手する。以下に示す構造でサブフォルダを設け、GMLSchemaファイルを格納する。/iur/uro/3.2/urbanObject.xsd、/iur/urf/3.2/urbanFunction.xsd

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| specification
| ルートフォルダ直下に作成された、拡張製品仕様書（PDF形式、EXCEL形式）を格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| udx
| ルートフォルダ直下に作成された、3D都市モデルを格納するフォルダ。 +
このフォルダの直下に、接頭辞ごとのサブフォルダ（例：bldg）を作成し、そのサブフォルダの中に指定されたファイル単位で区切られた全ての3D都市モデルのファイルを格納する。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| area
| 区域モデルを格納するフォルダ。拡張製品仕様書に追加した地物のうち、urf:Zoneを継承する地物を含む。（urf:UnclassifiedBlankarea（非線引き用途白地）、urf:UnclassifiedUseDistrict（非線引き用途地域））を含む。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| bldg
| 建築物モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| brid
| 橋梁モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| cons
| その他の構造物モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| dem
| 地形モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| ext
| 拡張製品仕様書で追加した地物（ただし、urf:Zoneを継承する地物は除く）を格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| fld
| 災害リスク（浸水）モデルのうち、洪水浸水想定区域を格納するフォルダ。区域図ごとにサブフォルダを作成する。サブフォルダの構成及び名称は、別途示す。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| frn
| 都市設備を格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| gen
| 汎用都市オブジェクトを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| htd
| 災害リスク（浸水）モデルのうち、高潮浸水想定区域を格納するフォルダ。区域図ごとにサブフォルダを作成する。サブフォルダの構成及び名称は、別途示す。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| ifld
| 災害リスク（浸水）モデルのうち、内水浸水想定区域を格納するフォルダ。区域図ごとにサブフォルダを作成する。サブフォルダの構成及び名称は、別途示す。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| lsld
| 災害リスク（土砂災害）モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| luse
| 土地利用モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| rfld
| 災害リスク（浸水）モデルのうち、ため池ハザードマップを格納するフォルダ。ハザードマップごとにサブフォルダを作成する。サブフォルダの構成及び名称は、別途示す。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| rwy
| 交通（鉄道）モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| squr
| 交通（広場）モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| tnm
| 災害リスク（浸水）モデルのうち、津波浸水想定を格納するフォルダ。津波浸水想定ごとにサブフォルダを作成する。サブフォルダの構成及び名称は、別途示す。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| tran
| 道路モデルのデータを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| trk
| 交通（徒歩道）モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| tun
| トンネルモデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| ubld
| 地下街モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| urf
| 都市計画決定情報モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| unf
| 地下埋設物モデルの格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| veg
| 植生モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| wtr
| 水部モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| wwy
| 交通（航路）モデルを格納するフォルダ。

|===
////

[[toc5_04_05_02]]
===== ルートフォルダの命名規則

ルートフォルダの名称は、``[都市コード]\_[都市名英名]_[提供者区分]\_[整備年度]_citygml_[更新回数]_[オプション]``とする。

====== ``[都市コード]``

フォルダ名の``[都市コード]``は、((3D都市モデル))の整備範囲を示すコード（市区町村の場合は、都道府県コード（2桁）と市区町村コード（3桁）の組み合わせからなる5桁の数字、都道府県の場合は都道府県コード）とする。

====== ``[都市名英名]``

``[都市名英名]``は、都市コードに対応する市区町村名の英名とする。英名の表記は、デジタル庁が定める「行政基本情報データ連携モデル_住所」に従う。

[requirement]
.英名表記は基本規程に従う
====
[%metadata]
identifier:: /att/deliverable/12
subject:: 標準作業手順
class:: 留意事項
[statement]
--
英名の表記は、デジタル庁が定める「行政基本情報データ連携モデル_住所」に従う。

市区町村名称は、国土地理院が定める「地名等の英語表記規程」（平成28年国地達第10号）に準拠しつつ、市区町村の種別はcityやwardではなく-shiや-kuで表す。このとき、アンダースコア（_）ではなく、ハイフン（-）を使用する。 +
また、都府県は、固有自治体名のみ記入し、-to、-fu、-kenは記述しない。北海道は、「Hokkaido」とする。
--
====

====== ``[提供者区分]``

``[提供者区分]``は、データセットの提供者を識別するための文字列であり、半角英数字及び区切り文字（-）の組み合わせとする。

((3D都市モデル))の作成主体及び提供主体は市区町村が主となるが、将来的にはライフライン事業者や鉄道事業者などの公益事業者や、商業施設を保有する民間事業者がそれぞれ保有する施設の情報を((3D都市モデル))として作成・提供するというように、((3D都市モデル))の作成・提供主体が様々となる可能性がある。

そこで、((3D都市モデル))の提供者を識別するために、成果物のフォルダ名称に``[提供者区分]``を設ける。((3D都市モデル))の提供者が市区町村又は都道府県の場合、``[提供者区分]``は以下とする。

[cols="1a,2a",options="unnumbered"]
|===
|city|市区町村
|pref|都道府県
|===

提供者が市区町村又は都道府県以外の場合、提供者の事業分野を識別する``[事業分野]``と、提供者を識別する``[提供者]``により構成する。``[事業分野]``及び``[提供者]``には半角英数字を使用し、この二つを区切り文字（半角のハイフン）により接続する。 +
``[事業分野]``は((標準製品仕様書))において以下の通り定めている。

[cols="1a,2a",options="unnumbered"]
|===
|unf|ユーティリティ事業
|tran|道路事業
|rwy|鉄道事業
|===

なお``[事業分野]``は、((標準製品仕様書))に順次追加される。``[提供者]``は、拡張製品仕様書において定めるものとする。

``[提供者区分]``の例を以下に示す。ただし、``[提供者]``の部分はいずれも作成例である。

tran-mlit：:: 国土交通省が作成する道路のデータセット
unf-tg：:: 東京ガス
tran-enexco：:: NEXCO東日本
rwy-jre：:: JR東日本

====== ``[整備年度]``

``[整備年度]``は、((3D都市モデル))を整備した年度（半角数字4桁の西暦）とする。以下の1（新規整備）から3を実施する場合は、``[整備年度]``を更新する。(((3D都市モデル)))(((標準製品仕様書)))

1．データセットの追加（新規整備） +
新しく3D都市モデルを作る。新規整備に該当する。

2．地物型の追加 +
既に建築物や土地利用等のモデルが整備されている都市において、別のモデル（例：都市設備モデル）を追加する。

3．地物の追加 +
①一部エリアのみ整備されている地物の整備範囲を広げる、②既に整備されている地物を削除し、削除した地物の時点よりも新しい時点の地物を新たに作る（更新）。

====
①の例：都市計画区域のみ建築物モデル（LOD1）が整備されていたが、都市計画区域外も建築物モデル（LOD1）を整備した。
====

====
②の例：建築物モデル（LOD1）が整備されていたが、より新しい原典資料を使用して、建築物モデル（LOD1）を整備しなおした。
====

以下の4から6を実施する場合は、既存の((3D都市モデル))の``[整備年度]``の更新は行わず、``[更新回数]``を更新する。

4．空間属性（LOD0～LOD4）の追加 +
LOD1が整備されている地物に、LOD2やLOD3など別のLODを追加する。ただし、LOD1の修正は行わない。

5．主題属性の追加 +
属性の拡充や属性の更新をする。

6．バージョンアップ +
標準製品仕様書の改定に伴いデータを変換する。

LOD1が整備されている場合、LOD1を修正せずにLOD2を追加した場合は4とするが、LOD2を追加した際にLOD1を修正した場合は、3の②（更新）とする。((標準製品仕様書))の改定による地物型の変更（汎用都市オブジェクトを使用して作成された地物を、より適した地物型に変更する）や整備範囲外の地物の削除は３とはみなさず、６に含む。この場合、``[更新回数]``のみを更新する。

====== ``[更新回数]``

``[更新回数]``は、履歴管理用に半角数字を付す。初回に作成した成果物は1とする。以降、修正等を行った場合はバージョンアップごとに数字を加算していく。``[更新回数]``は``[整備年度]``ごとに加算する。``[整備年度]``が変わった場合は、1から開始する。

====== ``[オプション]``

``[オプション]``は、成果品が複数種類作成される場合に、これらを識別する任意の文字列とする。半角英数字のみ使用可とする。成果品が1種類の場合は、``_[オプション]``は省略する。((標準製品仕様書))では、``[オプション]``としてオープンデータであることを示すopを定めている。

[[toc5_04_05_03]]
===== オープンデータのフォルダ構成

オープンデータのフォルダ構成は、地方公共団体用((3D都市モデル))成果品のフォルダ構成と同様とする。 +
ルートフォルダの名称は、地方公共団体用((3D都市モデル))成果品のルートフォルダのフォルダ名の末尾に「_op」を付与する。 +
ルートフォルダに含む各サブフォルダの名称は、地方公共団体用((3D都市モデル))成果品のサブフォルダと同様とする。 +
オープンデータのフォルダ構成を<<tab-5-14>>に示す。 

各都市において作成するオープンデータ用の拡張製品仕様書には、フォルダ構成、フォルダ名称及びフォルダの説明を示すこと。これらは、拡張製品仕様書「第7章　データ製品配布」のうち、「7.2　配布媒体情報」の中の「7.2.4　フォルダ構成」に記載する。

なお、オープンデータについても、地方公共団体用((3D都市モデル))成果品と同様に、作成対象となる地物型のフォルダのみを作成すること。

(((3D都市モデル)))
[[tab-5-14]]
[cols="3a,3a,3a,3a,3a,3a,8a,24a",options="header"]
.フォルダ構成（オープンデータ用）
|===
6+| フォルダ構成 | フォルダ名 | フォルダの説明

2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

4+|
^| ``[都市コード]\_[都市名英名]_[提供者区分]\_[整備年度]_citygml_[更新回数]_[オプション]_op``
| 成果品を格納するフォルダのルート。 +
このフォルダの直下に格納するファイルは索引図及びREADMEのみであり、その他のファイルはこのフォルダに設けたサブフォルダに格納する。 +
フォルダの名称は、ルートフォルダの命名規則に従う。

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| codelists
| ルートフォルダ直下に作成された、コードリストを格納するフォルダ。3D都市モデルが参照する全てのコードリストを格納する。

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| metadata
| ルートフォルダ直下に作成された、メタデータを格納するフォルダ。

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| schemas
| 3D都市モデルのGMLSchemaを格納するフォルダ。GMLSchemaは指定された版のi-URをG空間情報センターより入手する。 +
以下に示す構造でサブフォルダを設け、GMLSchemaファイルを格納する。 +
 /iur/uro/3.2/urbanObject.xsd +
 /iur/urf/3.2/urbanFunction.xsd

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| specification
| ルートフォルダ直下に作成された、拡張製品仕様書（PDF形式、EXCEL形式）を格納するフォルダ。

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| udx
| ルートフォルダ直下に作成された、3D都市モデルを格納するフォルダ。 +
このフォルダの直下に、接頭辞ごとのサブフォルダ（例：bldg）を作成し、そのサブフォルダの中に指定されたファイル単位で区切られた全ての3D都市モデルのファイルを格納する。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| area
| 区域モデルを格納するフォルダ。拡張製品仕様書に追加した地物のうち、urf:Zoneを継承する地物を含む。（urf:UnclassifiedBlankarea（非線引き用途白地）、urf:UnclassifiedUseDistrict（非線引き用途地域））を含む。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| bldg
| 建築物モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| brid
| 橋梁モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| cons
| その他の構造物モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| dem
| 地形モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| ext
| 拡張製品仕様書で追加した地物（ただし、urf:Zoneを継承する地物は除く）を格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| fld
| 災害リスク（浸水）モデルのうち、洪水浸水想定区域を格納するフォルダ。区域図ごとにサブフォルダを作成する。サブフォルダの構成及び名称は、別途示す。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| frn
| 都市設備を格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| gen
| 汎用都市オブジェクトを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| htd
| 災害リスク（浸水）モデルのうち、高潮浸水想定区域を格納するフォルダ。区域図ごとにサブフォルダを作成する。サブフォルダの構成及び名称は、別途示す。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| ifld
| 災害リスク（浸水）モデルのうち、内水浸水想定区域を格納するフォルダ。区域図ごとにサブフォルダを作成する。サブフォルダの構成及び名称は、別途示す。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| lsld
| 災害リスク（土砂災害）モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| luse
| 土地利用モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| rfld
| 災害リスク（浸水）モデルのうち、ため池ハザードマップを格納するフォルダ。ハザードマップごとにサブフォルダを作成する。サブフォルダの構成及び名称は、別途示す。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| rwy
| 交通（鉄道）モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| squr
| 交通（広場）モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| tnm
| 災害リスク（浸水）モデルのうち、津波浸水想定を格納するフォルダ。津波浸水想定ごとにサブフォルダを作成する。サブフォルダの構成及び名称は、別途示す。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| tran
| 道路モデルのデータを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| trk
| 交通（徒歩道）モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| tun
| トンネルモデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| ubld
| 地下街モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| urf
| 都市計画決定情報モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| unf
| 地下埋設物モデルの格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| veg
| 植生モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| wtr
| 水部モデルを格納するフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| wwy
| 交通（航路）モデルを格納するフォルダ。

|===

[[toc5_04_05_04]]
===== 洪水浸水想定区域のフォルダ構成

洪水浸水想定区域の((3D都市モデル))は、洪水浸水想定区域ごとにサブフォルダを作成し、格納する。

洪水浸水想定区域のフォルダ構成及びフォルダ名の命名規則は以下の規則に従う。

* 洪水浸水想定区域を格納するフォルダ（フォルダ名：fld）に、「国」、「都道府県」及び「独自」ごとにサブフォルダを作成する。
** 「国」を示すサブフォルダ名は「natl」とし、「都道府県」を示すサブフォルダ名は「pref」とする。
** 「独自」を示すサブフォルダは「org」とする。「独自」とは、以下を指す。
*** 都道府県が独自に作成した特定の地域を対象とした複数の河川による浸水想定区域図や水位周知河川・洪水予報河川として指定されていない河川の浸水想定区域図
*** 洪水浸水想定区域図を作成する際の途中成果となる破堤点や経過時間ごとの浸水データから作成された災害リスク（浸水）モデル
* 「natl」、「pref」及び「org」の各フォルダのサブフォルダとして、洪水浸水想定区域図ごとのフォルダを作成する。
** 「natl」には、国が指定する洪水予報河川又は水位周知河川で作成された洪水浸水想定区域図のフォルダを作成する。
** 「pref」には、都道府県が指定する洪水予報河川又は水位周知河川で作成された洪水浸水想定区域図のフォルダを作成する。
** 「org」には、国が指定する洪水予報河川又は水位周知河川で作成された洪水浸水想定区域図
* 洪水浸水想定区域図ごとに作成するフォルダ名称は``[水系名]\_[指定河川名]_[番号]``とする。
** ``[水系名]``及び``[指定河川名]``は、水防法に基づき指定された洪水浸水想定区域図の対象となる洪水予報河川又は水位周知河川として示された「水系名」及び「指定河川名」を用いる。
** 「水系名」及び「指定河川名」の表記は英名（全て小文字）とする。英名の表記には、ヘボン式を採用する。表音のローマ字表記に「川」を表す英語の追加や、表音のローマ字表記のうち「川」を表す部分を対応する英語に置き換えたりはしない。
+
ヘボン式の表記は、「地名等の英語表記規程」（平成28年国地達第10号）別紙1　表音のローマ字による表記方法に従う。
+
====
「利根川」をtonegawa riverやtone riverとはせず、「tonegawa」とする。
====

** 一つの洪水浸水想定区域図に、複数の洪水予報河川又は水位周知河川が含まれている場合は、最初の2指定河川の「指定河川名」を列挙し、3指定河川以上が一つの洪水浸水想定区域図に含まれている場合は、最後に「-etc」を付す。指定河川名を列挙する場合の区切り文字には、ハイフン（-）を使用する。
+
====
「淀川水系猪名川・藻川洪水浸水想定区域図」には、「淀川水系猪名川」及び「淀川水系藻川」の二つの洪水予報河川が含まれている。よって、「yodogawa_inagawa-mogawa」とする。
====
+
====
「菊川水系菊川・牛淵川・下小笠川洪水浸水想定区域図」には洪水予報河川又は水位周知河川として「菊川水系菊川」、「菊川水系牛淵川」及び「菊川水系下小笠川」が含まれている。よって、「kikugawa_kikugawa-ushibuchigawa-etc」とする。
====

** ``[番号]``はオプションとする。前項までの命名規則で名称が同一となるフォルダを識別するために使用する。「1」を開始番号として昇順で付番する。
+
====
静岡県掛川市が浸水想定区域に含まれる浸水想定区域図として、「太田川水系太田川・原野谷川・敷地川・宇刈川・逆川・ぼう僧川・今ノ浦川洪水浸水想定区域」と「太田川水系太田川・原野谷川・敷地川洪水浸水想定区域」とがある。いずれも3以上の指定河川が含まれるが、最初の二つの指定河川名を使用すると、同じフォルダ名称となる。そのため、``[番号]``を用いて、以下のように識別する。
====
+
太田川水系太田川・原野谷川・敷地川・宇刈川・逆川・ぼう僧川・今ノ浦川洪水浸水想定区域は以下のフォルダ名とする。
+
`otagawa_otagawa-haranoyagawa-etc-1`
+
太田川水系太田川・原野谷川・敷地川洪水浸水想定区域は以下のフォルダ名とする。
+
`otagawa_otagawa-haranoyagawa-etc-2`

* 都道府県が独自に作成した、特定の地域を対象とした複数の河川による浸水想定区域図や水位周知河川・洪水予報河川として指定されていない河川の浸水想定区域図の場合は、当該浸水想定区域の名称を使用する。
** 英名の表記には、ヘボン式を採用する。ヘボン式の表記は、「地名等の英語表記規程」（平成28年国地達第10号）別紙1　表音のローマ字による表記方法に従う。
** なお、表音のローマ字表記に「川」を表す英語の追加や、表音のローマ字表記のうち「川」を表す部分を対応する英語に置き換えたりはしない。
** 複数の単語から構成される場合は、対象となる範囲を示す語句のみを使用し、単語をハイフン（-）でつなぐ。
+
====
「江東内部河川流域浸水予想区域」は、koto-naibuとなる。
====

洪水浸水想定区域のフォルダ構成を<<tab-5-15>>に示す。ルートフォルダ及び洪水浸水想定区域フォルダの名称は、各フォルダの命名規則に従う。

[[tab-5-15]]
[cols="3a,3a,3a,3a,3a,3a,10a,22a",options="header"]
.洪水浸水想定区域のフォルダ構成
|===
6+| フォルダ構成 | フォルダ名 | フォルダの説明
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

4+|
^| fld
| 洪水浸水想定区域図を格納するフォルダ。

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| natl
| 国が指定する洪水予報河川又は水位周知河川で作成された洪水浸水想定区域図を格納するためのフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| `[水系名]\_[指定河川名]_[番号]`
| 洪水浸水想定区域図ごとに作成されたフォルダ。

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| pref
| 都道府県が指定する洪水予報河川又は水位周知河川で作成された洪水浸水想定区域図を格納するためのフォルダ。

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| `[水系名]\_[指定河川名]_[番号]`
| 洪水浸水想定区域図ごとに作成されたフォルダ。

2+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

2+|
^| org
| 以下の災害リスク（浸水）モデルを格納するフォルダ

* 都道府県が独自に作成した、特定の地域を対象とした複数の河川による浸水想定区域図や水位周知河川・洪水予報河川として指定されていない河川の浸水想定区域図
* 破堤点や経過時間ごとの浸水面を表現する災害リスク（浸水）モデル

4+|
2+|
[%unnumbered]
image::images/033.webp.png[width="50"]

^| `[水系名]\_[指定河川名]_[番号]`
| 洪水浸水想定区域図ごとに作成されたフォルダ。

|===

* 洪水浸水想定区域図ごとに作成したフォルダの名称と、このフォルダに格納する洪水浸水想定区域図の名称との対応を<<tab-5-16>>に示す表形式で、都市ごとの拡張製品仕様書において示すこと。

[[tab-5-16]]
[cols="1a,1a,3a"]
.拡張製品仕様書に示すべき洪水浸水想定区域フォルダ構成の一覧（テンプレート）
|===
^h| フォルダ名 ^h| サブフォルダ名 ^h| フォルダの説明（洪水浸水想定区域図の名称）
| natl | |
| pref | |
| org | |

|===

[cols="1a,1a,3a"]
.拡張製品仕様書に示すべき洪水浸水想定区域フォルダ構成の一覧（記載例）
|===
^h| フォルダ名 ^h| サブフォルダ名 ^h| フォルダの説明（洪水浸水想定区域図の名称）
| natl | `tenryugawa_tenryugawa` | 天竜川水系天竜川洪水浸水想定区域図
| pref | `tenryugawa_kamigawa-miyagawa` | 天竜川水系上川・宮川洪水浸水想定区域図

|===

NOTE: 複数の洪水浸水想定区域がある場合は、行を追加する。

　

[NOTE,type=commentary]
--
洪水浸水想定区域は、水防法第14条に基づき、国又は都道府県が、洪水予報河川及び水位周知河川に指定した河川について、想定し得る最大規模の降雨又は基本高水を設定する前提となる降雨（計画規模降雨）により当該河川が氾濫した場合に、浸水が想定される区域として指定された区域である。

そこで、洪水浸水想定区域を格納するフォルダは、国及び都道府県ごと、かつ、洪水浸水想定区域図ごとに作成する。

洪水浸水想定区域図の名称は、作成主体により様々である。そこで、3D都市モデルでは、洪水予報河川及び水位周知河川を一意に識別するため、フォルダ名称として水系名、指定河川名及び番号の組み合わせを使用する。

ただし、水防法に基づく洪水予報河川又は水位周知河川に指定された河川以外について浸水想定区域図に準じて浸水範囲を図示した独自の区域図を作成する場合がある。この場合には、当該独自の区域図の名称をフォルダ名として使用する。
--

[[toc5_04_05_05]]
===== 津波浸水想定、高潮浸水想定区域及び内水浸水想定区域のフォルダ構成

津波浸水想定、高潮浸水想定区域及び内水浸水想定区域のフォルダ構成は以下の規則に従う。

* 区域図ごとにサブフォルダを作成する。サブフォルダ名は、``[都道府県コード]_[番号]``とする。
** ``[都道府県コード]``は、2桁の都道府県コードとする。
** ``[番号]``は、「1」を開始番号とする昇順の番号とする。単一の浸水想定しかない場合は、``[番号]``が「1」となるフォルダのみを作成する。また、複数の津波浸水想定が存在する場合にはそれぞれに対応するフォルダを作成する。
+
[example]
====
`23_1`
====

例として、津波浸水想定のフォルダ構成を<<tab-5-18>>に示す。区域図ごとに作成するフォルダの名称は、フォルダの命名規則に従う。

[[tab-5-18]]
[cols="9a,9a,9a,20a,50a",options="header"]
.津波浸水想定のフォルダ構成
|===
3+| フォルダ構成 | フォルダ名 | フォルダの説明

2+|
[%unnumbered]
image::images/033.webp.png[width="50"]
 |
^| `tnm`
| 津波浸水想定を格納するフォルダ。

2+| | image::images/033.webp.png[width="50"]
^| ``[都道府県コード]_[番号]``
|
設定が異なる区域図ごとに作成されたサブフォルダ。 +
複数の設定が無く、単一の区域図しか作成されていない場合も、``[番号]``が1となるサブフォルダを作成する。

|===

* 高潮浸水想定区域及び内水浸水想定区域も、津波浸水想定のフォルダ構成と同様とする。
** 「htd」及び「ifld」の直下に、設定ごとにサブフォルダを作成する。
** サブフォルダ名は、``[都道府県コード]_[番号]``とする。
** ``[番号]``は、「1」を開始番号とする昇順の番号とする。単一の浸水想定区域図しかない場合は、``[番号]``が「1」となるフォルダのみを作成する。また、複数の津波浸水想定が存在する場合にはそれぞれに対応するフォルダを作成する。
* 作成したサブフォルダの名称と、このフォルダに格納する浸水想定区域図の名称との対応を<<tab-5-19>>から<<tab-5-22>>に示す表形式で、都市ごとの拡張製品仕様書において示すこと。対応表は、津波浸水想定、高潮浸水想定区域、内水浸水想定区域及びため池ハザードマップそれぞれについて一覧を作成すること。作成対象となる浸水想定区域図が無い場合には作成は不要である。

[[tab-5-19]]
[cols="3a,7a",options="header"]
.拡張製品仕様書に示すべき津波浸水想定フォルダ構成の一覧（テンプレート）
|===
| サブフォルダ名 | フォルダの説明（津波浸水想定の名称）

| 　 | 　
| 　 | 　

|===

[[tab-5-20]]
[cols="3a,7a"]
.拡張製品仕様書に示すべき高潮浸水想定区域フォルダ構成の一覧（テンプレート）
|===
^h| サブフォルダ名 ^h| フォルダの説明（高潮浸水想定区域図の名称）
| 　 | 　
| 　 | 　

|===

[[tab-5-21]]
[cols="3a,7a"]
.拡張製品仕様書に示すべき内水浸水想定区域フォルダ構成の一覧（テンプレート）
|===
^h| サブフォルダ名 ^h| フォルダの説明（内水浸水想定区域図の名称）
| 　 | 　
| 　 | 　

|===

[[tab-5-22]]
[cols="3a,7a"]
.拡張製品仕様書に示すべきため池ハザードマップフォルダ構成の一覧（テンプレート）
|===
^h| サブフォルダ名 ^h| フォルダの説明（ため池ハザードマップの名称）
| 　 | 　
| 　 | 　

|===

　

[NOTE,type=commentary]
--
津波浸水想定及び高潮浸水想定区域は都道府県、また、内水浸水想定区域は都道府県又は市町村により設定される。このとき、対象とする災害の規模や計算条件の設定ごとに、複数の津波浸水想定や高潮浸水想定区域が設定される場合がある。そこで、設定ごとにサブフォルダを作成する。

これらの設定は都道府県又は市区町村により様々であり、その名称も様々である。よって、サブフォルダの名称は、都道府県コードと番号の組み合わせを使用する。

津波浸水想定、高潮浸水想定区域又は内水浸水想定区域が一つしかない場合であっても、複数設定される場合と階層を揃えるため、サブフォルダを必ず作成する。
--

[[toc5_04_05_06]]
===== テクスチャのフォルダ構成

地形以外の地物に貼るテクスチャは、地物を格納するフォルダの直下にサブフォルダを作成し、その中に格納する。(((テクスチャ)))(((3D都市モデル)))

* 建築物の壁面・屋根面や道路の路面等の面に貼るためのテクスチャは、それぞれの地物を格納する3D都市モデルのファイルを格納するフォルダ（例：建築物の場合は、「bldg」）の直下にサブフォルダを作成し、その中に格納する。
* サブフォルダは、3D都市モデルのファイル単位に作成する。3D都市モデルのファイルから参照する全ての画像は、このファイルに対応するサブフォルダに格納すること。
* サブフォルダの名称は、``[メッシュコード]\_[地物型]_[CRS]_[オプション]_appearance``とする。``[メッシュコード]``、``[地物型]``、``[CRS]``及び``[オプション]``は、これに対応する3D都市モデルのファイル名と一致させる。
** 3D都市モデルのファイル名に``[オプション]``が含まれない場合は、``_[オプション]``は、省略する。
** なお、オープンデータ用3D都市モデルのテクスチャを格納するサブフォルダの名称に、_opは不要とする。
+
[example]
====
市町村用3D都市モデルのファイル（`53394610_bldg_6697.gml`）に対応するテクスチャのサブフォルダ名称の例

`53394610_bldg_6697_appearance`
====
+
[example]
====
オープンデータ用3D都市モデルのファイル（`53394610_bldg_6697_op.gml`）に対応するテクスチャのサブフォルダ名称の例

`53394610_bldg_6697_appearance`
====

* テクスチャの記述は、<<tocV_02>>テクスチャマッピングのためのプロファイルに従い、相対パスで記述すること。
* 3D都市モデルのファイルから、これに対応するテクスチャを格納するフォルダ以外のフォルダ（ファイル名に含まれるメッシュコードが異なるフォルダ）に格納したテクスチャを参照してはならない。

テクスチャを格納するためのフォルダ構成の例を<<tab-5-23>>に示す。<<tab-5-23>>は、建築物に使用するテクスチャのフォルダ構成である。

[[tab-5-23]]
[cols="9a,9a,9a,24a,40a",options="header"]
.テクスチャのためのフォルダ構成（建築物の場合）
|===
3+| フォルダ構成 | フォルダ名 | フォルダの説明

2+|
[%unnumbered]
image::images/033.webp.png[width="50"]
 |

| bldg
| 建築物、建築物部分、建築物付属物及びこれらの境界面を格納するフォルダ。 +
建築物等のファイルは、基準地域メッシュ（第3次地域区画、一辺の長さ約1km）単位に作成される。

| 2+|
[%unnumbered]
image::images/033.webp.png[width="50"]


| ``[メッシュコード]\_[地物型]_[CRS]_[オプション]_appearance``

| 建築物等のファイルごとに作成される、テクスチャの格納フォルダ。

|===

[[toc5_04_05_07]]
===== 三次元点群データのフォルダ構成

三次元点群データは、地物を格納するフォルダの直下にサブフォルダを作成し、その中に格納する。

* 建築物の壁面・屋根面や建築物、道路等に対応する三次元点群データは、それぞれの地物を格納する3D都市モデルのファイルを格納するフォルダ（例：建築物の場合は、「bldg」）の直下にサブフォルダを作成し、その中に格納する。
* サブフォルダは、3D都市モデルのファイル単位に作成する。3D都市モデルのファイルから参照する全ての三次元点群データは、このファイルに対応するサブフォルダに格納すること。
* サブフォルダの名称は、``[メッシュコード]\_[地物型]_[CRS]_[オプション]_pointcloud``とする。 [メッシュコード]、[地物型]、[CRS]及び[オプション]は、これに対応する3D都市モデルのファイル名と一致させる。
** 3D都市モデルのファイル名に[オプション]が含まれない場合は、_[オプション]は、省略する。
** なお、オープンデータ用3D都市モデルの三次元点群データを格納するサブフォルダの名称に、_opは不要とする。
+
[example]
====
市町村用3D都市モデルのファイル（53394610_bldg_6697.gml）に対応する三次元点群データのサブフォルダ名称の例

`53394610_bldg_6697_ pointcloud`
====
+
[example]
====
オープンデータ用3D都市モデルのファイル（53394610_bldg_6697_op.gml）に対応する三次元点群データのサブフォルダ名称の例

`53394610_bldg_6697_ pointcloud`
====

* ポイントクラウドの記述は、<<tocV_03>>ポイントクラウドマッピングのための拡張プロファイルに従い、相対パスで記述すること。
* 3D都市モデルのファイルから、これに対応する三次元点群データを格納するフォルダ以外のフォルダ（ファイル名に含まれるメッシュコードが異なるフォルダ）に格納した三次元点群データを参照してはならない。

三次元点群データを格納するためのフォルダ構成の例を<<tab-5-24>>に示す。<<tab-5-24>>は、建築物に使用する三次元点群データのフォルダ構成である。


[[tab-5-24]]
[cols="9a,9a,9a,24a,40a",options="header"]
.三次元点群データのためのフォルダ構成（建築物の場合）
|===

3+| フォルダ構成 | フォルダ名 | フォルダの説明

2+|
[%unnumbered]
image::images/033.webp.png[width="50"]
 |

| bldg
| 建築物、建築物部分、建築物付属物及びこれらの境界面を格納するフォルダ。 +
建築物等のファイルは、基準地域メッシュ（第3次地域区画、一辺の長さ約1km）単位に作成される。


| 2+|
[%unnumbered]
image::images/033.webp.png[width="50"]


| ``[メッシュコード]\_[地物型]_[CRS]_[オプション]_pointcloud``

| 建築物等のファイルごとに作成される、三次元点群データの格納フォルダ。

|===


[[toc5_04_05_08]]
===== 標準製品仕様書を拡張し、地物型等を追加した場合のフォルダ構成

((標準製品仕様書))を拡張し、地物型等を追加した場合のフォルダ構成についての留意事項を示す。

// (((i-UR)))(((CityGML)))

[requirement]
.フォルダ名は接頭辞に一致
====
[%metadata]
identifier:: /att/deliverable/13
subject:: 標準作業手順
class:: 留意事項
[statement]
--
i-UR及びCityGMLに定義済みの地物は、指定されたフォルダに格納する。

* CityGMLに定義済みの地物を格納するフォルダの名称は、地物に付与した接頭辞と一致させる。
* i-URに定義済みの地物のうち、urf:Zoneを継承する地物は、areaに格納する。urf:Zoneを継承しない地物は、extとする。

--
====


[[toc5_04_06]]
==== データの圧縮

地方公共団体用((3D都市モデル))成果品フォルダ及びオープンデータ用((3D都市モデル))成果品フォルダは、各々をZIP形式（拡張子.zip）又は7Z形式（拡張子.7z）に圧縮する。

ファイルの圧縮は、地方公共団体用((3D都市モデル))成果品フォルダ及びオープンデータ用((3D都市モデル))成果品フォルダのルートフォルダに対して行う。なお、その内部のいかなるサブフォルダにも圧縮形式のファイルを含んではならない。 +
圧縮後のファイル名称は、成果品のルートフォルダの名称に一致させる。(((3D都市モデル)))

* 地方公共団体用3D都市モデル成果品フォルダの圧縮後のファイル名称： +
``[都市コード]\_[都市名英名]_[提供者区分]\_[整備年度]_citygml_[更新回数]_[オプション]``

* オープンデータ用3D都市モデル成果品フォルダの圧縮後のファイル名称： +
``[都市コード]\_[都市名英名]_[提供者区分]\_[整備年度]_citygml_[更新回数]_[オプション]_op``

``[都市コード]``、``[都市名英名]``、``[提供者区分]``、``[整備年度]``、``[更新回数]``及び``[オプション]``の命名規則は、成果品フォルダのルートフォルダの命名規則（<<toc5_04_05_02>>）を参照すること。

[example]
.大阪市（市区町村コード：27100、英名：osaka-shi）の3D都市モデルの初回の成果品の圧縮後ファイル名称
====
地方公共団体用3D都市モデル成果品:: `27100_osaka-shi_city_2020_citygml_1`
オープンデータ用3D都市モデル成果品:: `27100_osaka-shi_city_2020_citygml_1_op`
====

なお、圧縮後の成果品フォルダのファイルサイズは、上限を160GBとする。

160GBを超える場合は分割する。分割は、成果品と同じフォルダ構成を複数作成し、成果品のファイルを作成したフォルダに振り分けることにより行う。このとき、それぞれの成果品フォルダ内に、同じファイルが重複して存在してはならない。分割する場合、ファイルを振り分けたのち、成果品のフォルダごとに圧縮する。

圧縮後のファイル名称は、 +
``[都市コード]\_[都市名英名]_[提供者区分]\_[整備年度]_citygml_[更新回数]\_[オプション]_[分割番号]`` +
とする。

オープンデータ用の((3D都市モデル))成果品フォルダの場合、圧縮後のファイル名称は、 +
``[都市コード]\_[都市名英名]_[提供者区分]\_[整備年度]_citygml_[更新回数]\_[オプション]_[分割番号]_op`` +
とする。

``[分割番号]``は、1から始まる連番とする。

<<figure-5-5>>に成果品フォルダを分割した例を示す。この例では、2020年度に整備された大阪市（市区町村コード：``27100``、英名：``osaka-shi``）の((3D都市モデル))の初回の成果品は、圧縮後のファイルサイズが160GBを超えたため、二つに分けることとした。このとき、成果品と同じフォルダ構成を2セット作成し、1セット目には建物の((3D都市モデル))のファイルのみを格納し、2セット目にはそれ以外のファイルを全て格納する。圧縮後のファイル名称は、1セット目は、 +
`27100_osaka-shi_city_2020_citygml_1_1` +
となり、2セット目は、 +
`27100_osaka-shi_city_2020_citygml_1_2` +
となる。

[[figure-5-5]]
.成果品フォルダの分割例
image::images/108.webp.png[width="600"]
