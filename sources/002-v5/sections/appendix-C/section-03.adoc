[[tocC_03]]
=== bldg:Building

bldg:Buildingは、建築物の記述に使用する地物型である。

[[tocC_03_01]]
==== 建築物の空間属性

[[tocC_03_01_01]]
===== LOD0

建築物モデル（LOD0）では、建築物の形状を面により表現する。このとき、建築物オブジェクトは、建築物モデル（LOD0）の定義に従ったものでなければならない。


[requirement]
.建築物のLOD0形状定義
====
[%metadata]
identifier:: /req/bldg/3
subject:: 妥当な建築物データセットの要件
description:: 建築物のLOD0の形状は、建築物モデル（LOD0）の定義に従う。
====

[[tocC_03_01_02]]
===== LOD1

建築物モデル（LOD1）では、建築物の形状を立体により表現する。このとき、建築物オブジェクトは、建築物モデル（LOD1）の定義に従ったものでなければならない。


[requirement]
.建築物のLOD1形状定義
====
[%metadata]
identifier:: /req/bldg/4
subject:: 妥当な建築物データセットの要件
description:: 建築物のLOD1の形状は、建築物モデル（LOD1）の定義に従う。
====

建築物モデル（LOD1）は、LOD0で作成されたbldg:lod0RoofEdge又はbldg:lod0FootPrintにより作成された建築物の外周を示す平面に、一定の高さで上向きに押し出した角柱として表現したものである（<<fig-C-1>>）。 +
平面に一律の高さを与えるため、上下の面は水平となり、側面は垂直となる。

[[fig-C-1]]
.建築物モデル（LOD1）
image::images/127.webp.png[width="400"]


[requirement]
.LOD1の空間属性の条件
====
[%metadata]
identifier:: /req/bldg/5
subject:: 妥当な建築物データセットの要件
description:: LOD1で建築物を記述する場合には、bldg:lod1Solidで示される幾何形状に加え、LOD0の幾何形状（bldg:lod0RoofEdge又はbldg:lod0FootPrint）も、空間属性としてもたなければならない。
====

CityGMLでは、LOD0の建築物の空間属性として、屋根の外形線を表すbldg:lod0RoofEdgeと、建築物の外壁面と地表面との境界線によるbldg:lod0FootPrintが用意されている。両者のいずれを使ってもよい。ただし、この幾何形状を使用してLOD1の立体を作成することから、元となるLOD0の幾何形状を同時に保持しておく。 +
LOD0の建築物の空間属性には、2次元のGISデータを使用できる。ただし、2次元のGISデータの構造が +
妥当な幾何オブジェクトの要件（<<tocB>>）に適合しない場合は、GISデータを修正する必要がある。 +
例えば、<<fig-C-2>>は、内周と外周が一筆書きによりつながっているGISデータをLOD0の建築物の空間属性として使用し、
LOD1に押し出した立体である。 +
内周と外周が一筆書きによりつながっている面は、gml:Polygonの要件に適合しないため、このような外形データを押し出したLOD1の立体もCityGMLの要件に適合しない。

[[fig-C-2]]
.エラーとなる図形の例
image::images/128.webp.png[width="300"]


[requirement]
.LOD0幾何形状の妥当性
====
[%metadata]
identifier:: /req/bldg/6
subject:: 妥当な建築物データセットの要件
description:: LOD1で建築物を記述する場合には、これに使用するLOD0の幾何形状（bldg:lod0RoofEdge又はbldg:lod0FootPrint）が、妥当な幾何オブジェクトでなければならない。
====

LOD1の下面の高さは以下の要件を満たさなければならない。

[requirement]
.建築物の下面高さの基準（LOD1）
====
[%metadata]
identifier:: /req/bldg/7
subject:: 妥当な建築物データセットの要件
description:: LOD1で作成する建築物の下面の高さは、以下のいずれかとする。
part:: 建築物の下面の絶対標高
part:: LOD0で作成する水平図形と地形モデルとの交線の最下部点の高さ（最も低い標高）
====

LOD1で建築物を記述する場合、下面の高さは、<<fig-C-3>>に示す二つの方法のいずれかにより決定する。建築物に地階が存在し、その最も低い高さが得られる場合にはその高さを使用する。地階の高さについての情報が得られない場合には、地形モデルとLOD0の平面形状との重ね合わせにより、最も低い点の高さを取得し、この値を使用する。

[[fig-C-3]]
.LOD1における下面の高さ
image::images/129.webp.png[width="600"]

地形モデルとLOD0の平面形状との重ね合わせにより最も低い点の高さを取得する方法を選択した場合に、建築物のLOD0の平面形状の範囲で地形モデルが欠落している場合は、以下の手順により建築物の下面の高さを取得する。

　

* 地形モデルの欠落部が水部であり、かつ、LOD0の平面形状の範囲の地形モデルが全て欠落している場合は、地形モデルの欠落部を内挿により補完し、補完後の地形モデルとLOD0の平面形状の重ね合わせにより、最も低い点の高さを取得する。
* 地形モデルの欠落部が水部であり、かつ、LOD0の平面形状の範囲の地形モデルが一部欠落している場合は、一部欠落している地形モデルとLOD0の平面形状の重ね合わせにより、重なる部分の地形モデルの中で最も低い点の高さを取得する。
* 地形モデルの欠落部が水部以外の場合は、航空レーザ点群又は航空写真を用いた三次元図化を行い、ブレークラインを取得する。取得したブレークラインを用いて地形モデルの欠落部分を内挿補完し、補完後の地形モデルとLOD0の平面形状の重ね合わせにより、最も低い点の高さを取得する。

LOD1では建築物の上面及び下面は水平となる。つまり、建築物には一律の高さが付与される。しかしながら、実世界での建築物の多くは複雑な屋根形状を有し、高さは一律ではない。また、使用する資料により、得られる高さは様々である。そこで、LOD1で建築物を作成する場合に、その高さは以下の要件を満たすこととする。


[requirement]
.LOD1の上面高さの基準
====
[%metadata]
identifier:: /req/bldg/8
subject:: 妥当な建築物データセットの要件
description:: LOD1で作成する建築物の上面の高さには、「LOD0の平面の内側に含まれる点群データの中央値」を使用することを原則とする。
====

航空レーザ測量等により取得された点群データを使用する場合、建築物の形状（LOD0による平面）には複数の点が存在することが想定される。このような場合には、統計処理により求めた代表値を建築物の上面の高さとして与える。統計処理により求める代表値として<<tab-C-3>>がある。

[[tab-C-3]]
[cols="3a,17a"]
.統計処理に求める建物高さの代表値
|===
^h| 代表値 ^h| 算出方法
|  最高値 | LOD0の平面に含まれる点群データのうち、最も高さの高い点の値。屋根が傾斜している場合や多層型の屋根形状の場合、その一番高いところの高さを示す。
|  中央値 | LOD0の平面に含まれる点群データにおいて、データを小さい順に並べたとき中央に位置する値。
|  平均値 | LOD0の平面に含まれる点群データにおいて、データの分布の重心を表す値。
|  最頻値 | LOD0の平面に含まれる点群データにおいて、最も頻繁に出現する値。
|  最低値 | LOD0の平面に含まれる点群データのうち、最も高さの低い点の高さ。屋根が傾斜している場合や多層型の屋根形状の場合、その一番低いところの高さを示す。

|===

このうち、中央値は平均値と異なり、上下に極端にはずれた数値の影響を受けにくいとされる。そのため、標準製品仕様書では、多目的な利用を想定し、中央値の採用を推奨している。 +
なお、国土地理院による「<<gsi_building_data_manual,建物三次元データ作成マニュアル（案）>>」では、航空レーザ測量データ及び建物ポリゴンデータを用いて、建物のポリゴンデータに高さ（中央値）を与える手順が示されている。そのため、LOD1の作成において参考にできる。 +
計測以外の方法で高さを取得することもできる。具体的には、都市計画基礎調査の建物利用現況に含まれる「高さ」や建築確認申請書類等に記載される「((建築物の高さ))」を使用してもよい。また、そのほかの高さの取得方法として、都市計画基礎調査等に含まれる建物階数を使用して建築物の高さを推定する方法がある。これは、階高（3mや4m）に建物階数を乗算し、建築物の高さとする方法である。点群データや建築確認申請書類等の既存資料が得られない場合に、便宜的な対応として、このような推定を行うことも考えられる。 +
建築物に一律の高さを与える場合、いずれの高さを建築物の上面の高さとするかは、ユースケースや使用可能な資料により異なる。そこで、本作業手順では、建築物の上面の高さには原則としてLOD0の平面の内側に含まれる点群データの中央値を採用することとしている。

なお、ユースケースによっては、一律の高さが与えられたLOD1の建築物では要求を満たさない場合がある。その場合には、建築物の幾何形状をより現実に近い形状で記述可能なLOD2を適用する、又は必要な「高さ」を主題属性として建築物に定義する。標準製品仕様書では、建築物の高さ制限の確認を行うことを目的として、主題属性に建築基準法施行令に基づく「建築物の高さ」及び「軒の高さ」を追加している。これら以外の高さが必要な場合には汎用属性を用いて追加することができる。 +
また、建築物の主題属性である「計測高さ」は、計測により取得した建築物の最も低い位置から最も高い位置までの高さであり、LOD1を中央値や平均値等で作成した場合には、この高さと「計測高さ」とは一致しない場合がある。

ここで、LOD1では、建築物の下面の高さは接地している標高とし、上面の高さは建築物の外形線内に含まれる点群データの標高の中央値とすることが基本となる。このとき、下面の高さと上面の高さを取得する原典資料が異なると、建築物の高さが原典資料の累積誤差により実際と乖離する恐れがある。よって、異なる原典資料を使用する場合には、累積誤差を軽減する策をとる必要がある。


[requirement]
.LOD1の高さ取得における誤差対策
====
[%metadata]
identifier:: /req/bldg/9
subject:: 妥当な建築物データセットの要件
description:: LOD1で作成する建築物の下面の高さを取得する原典資料と上面の高さを取得する原典資料が異なる場合には、必要に応じて累積誤差を軽減する策をとる。
====

例：点群データを用いて建築物の相対的な高さを求め、地形モデルから求めた標高にこの高さを加えて建築物の高さを求める。

[[fig-C-4]]
.LOD1における下面と上面の高さの取得例
image::images/130.webp.png[]

[[tocC_03_01_03]]
===== LOD2

建築物モデル（LOD2）では、建築物の形状を立体として表現する。このとき、建築物オブジェクトは、建築物モデル（LOD2）の定義に従ったものでなければならない。


[requirement]
.建築物のLOD2形状定義
====
[%metadata]
identifier:: /req/bldg/10
subject:: 妥当な建築物データセットの要件
description:: 建築物のLOD2の形状は、建築物モデル（LOD2）の定義に従う。
====

[[fig-C-5]]
.LOD2により記述される建築物
image::images/131.webp.png[width="400"]

建築物モデル（LOD2）は、含むべき地物によりLOD2.0、LOD2.1及びLOD2.2に細分される。LOD2.0、LOD2.1及びLOD2.2は、航空写真等上空から取得したデータの利用を前提とした区分であり、屋根形状を含む建築物の上面を詳細化する。 +
標準製品仕様書は、原則としてLOD2.0を採用する。ただし、ユースケースの必要に応じてLOD2.1又はLOD2.2を採用できる。

[[tab-C-4]]
[cols="1a,3a,3a,3a"]
.建築物モデル（LOD2）の取得イメージ
|===
^h| LOD ^h| LOD2.0 ^h| LOD2.1 ^h| LOD2.2
^h| 取得例
^.^|
image::images/132.webp.png[]
|
image::images/133.webp.png[]
|
image::images/134.webp.png[]

^h| 説明
| 屋根の主要な外形が再現される。LOD2.0では付属物は取得しないため、バルコニーも屋根として取得する。 +
なお、LOD2では屋根面は詳細化されるが外壁面は詳細化されないため、バルコニーの下部も建築物の一部として表現される。
| 小屋根のうち規模が大きいものが再現される。LOD2.0では切妻屋根として表現されたが、LOD2.1の条件を満たしたため、小屋根として表現された。 +
また、LOD2.1の条件を満たすバルコニーが、付属物として区分される。
| 小屋根のうち規模の小さいものが再現される。LOD2.1では無視された屋根窓の屋根がLOD2.2の条件を満たしたため、この屋根形状が表現された。 +
また、LOD2.2の条件を満たす屋根上の煙突が付属物として、さらに区分される。

|===

image::images/135.webp.png[width="500"]

[[tab-C-5]]
[cols="a,a,a,a,a"]
.LOD2.0, LOD2.1及びLOD2.2の区分
|===
^h| 建築物モデル（LOD2）に含むべき地物 ^h| 対応するCityGMLの地物型 ^h| LOD2.0 ^h| LOD2.1 ^h| LOD2.2
| 建築物 | Building ^| ● ^|  ● ^| ●
| 屋根
| RoofSurface
^| ● +
射影の短辺の実長3m以上
^| ● +
射影の短辺の実長3m以上又は +
射影の短辺の実長1m以上かつ正射影の面積3m2以上
^| ● +
射影の短辺の実長1m以上又は +
正射影の面積1m2以上

| 底面 | GroundSurface ^|  ● ^| ● ^| ●
| 外壁面 | WallSurface ^|  ● ^| ● ^| ●
| 建築物部分
| BuildingPart
^| ■ +
一棟の建築物を主題属性の異なる複数の部分に分ける場合に必須とする。
^| ■ +
一棟の建築物を主題属性の異なる複数の部分に分ける場合に必須とする。
^| ■ +
一棟の建築物を主題属性の異なる複数の部分に分ける場合に必須とする。

| 閉鎖面
| ClosureSurface
^| ■ +
BuildingPartを使用する場合に必須とする
^| ■ +
BuildingPartを使用する場合に必須とする
^| ■ +
BuildingPartを使用する場合に必須とする

| 屋外床面 | OuterFloorSurface |  ^| ○ ^| ○
| 屋外天井面 | OuterCeilingSurface |  |  |

| 屋外付属物

バルコニー、屋外階段、スロープ、手すり、エレベータ、エスカレータ、庇、アンテナ、煙突、看板等
| BuildingInstallation
|
^| ● +
射影の短辺の実長3m以上又は +
射影の短辺の実長1m以上 +
かつ正射影の面積が3m2以上
^| ● +
射影の短辺の実長1m以上

|===

[%key]
●:: 必須
■:: 条件付必須
〇:: 任意（ユースケースに応じて要否を決定してよい）

LOD2では、建築物は、屋根、壁等を境界として区切られた空間（立体）となる。そのため、建築物の立体を構成する境界面は、屋根、外壁等の境界面となる地物型の空間属性（面）と一致する。この関係性を<<fig-C-6>>に示す。

[[fig-C-6]]
.LOD2における建築物の空間属性の記述
image::images/136.webp.png[]


[requirement]
.LOD2立体の境界面参照
====
[%metadata]
identifier:: /req/bldg/11
subject:: 妥当な建築物データセットの要件
description:: bldg:lod2Solidで示される立体は、その境界面として、建築物の境界となる地物型（bldg:_BoundarySurface）の空間属性を外部参照しなければならない。
====

bldg:Buildingは空間属性bldg:lod2Solidによって立体（gml:Solid）をもつ。立体は、外部境界（gml:exterior）として合成曲面（gml:CompositeSurface）をもつ。この合成曲面は、連続する曲面の集まりである。gml:surfaceMemberにより、合成曲面を構成する個々の曲面（gml:Polygon）をもつ。このとき、gml:surfaceMemberは個々の曲面（gml:Polygon）の識別子を参照するのみで、曲面の実体はもたない。曲面の実体は、別途記述される。この仕組みを外部参照と呼び、XLinkを使って識別子（gml:id）を参照する。曲面の実体は、屋根、外壁等の境界面であるbldg:_BoundarySurfaceの空間属性として記述される。 +
bldg:_BoundarySurfaceは空間属性bldg:lod2MultiSurfaceによりgml:MultiSurfaceをもつ。これは、1個以上の曲面の集まりであり、個々の曲面はgml:Polygonとして記述される。曲面には、それぞれを区別する識別子が付与される。この識別子は、先に述べたbldg:Buildingの空間属性を構成する要素（gml:surfaceMember）として、参照される。 +
外部参照の例を<<fig-C-7>>に示す。建築物と、この建築物の外壁の形状を示す面（gml:id=”LOD2_1_S”）があった場合、立体の境界を構成する面として、外壁面（gml:WallSurface）の空間属性を、XLinkを用いて参照している（xlink:href="#LOD2_1_S"）。

[[fig-C-7]]
.建築物と境界面の外部参照例
image::images/137.webp.png[]

[[tocC_03_01_04]]
===== LOD3

建築物モデル（LOD3）では、建築物の形状を立体として表現する。このとき、建築物オブジェクトは、建築物モデル（LOD3）の定義に従ったものでなければならない。


[requirement]
.建築物のLOD3形状定義
====
[%metadata]
identifier:: /req/bldg/12
subject:: 妥当な建築物データセットの要件
description:: 建築物のLOD3の形状は、建築物モデル（LOD3）の定義に従う。
====

[[fig-C-8]]
.建築物モデル（LOD3）
image::images/138.webp.png[width="400"]

建築物モデル（LOD3）は、含むべき地物により、LOD3.0、LOD3.1、LOD3.2及びLOD3.3に分かれる。これらは、MMS（Mobile Mapping System）による点群や画像等、側面から取得したデータの利用を前提とした区分であり、外壁面や開口部を含む建築物の側面を詳細化する。標準製品仕様書では原則としてLOD3.0を採用する。ただし、ユースケースの必要に応じてLOD3.1、LOD3.2又はLOD3.3を採用できる。

[[tab-C-6]]
[cols="1a,5a,8a"]
.建築物モデル（LOD3）の取得イメージ
|===
h| ^h| 取得イメージ ^h| 説明
h| LOD3.0
|
image::images/139.webp.png[]
|
屋根のうち短辺3m以上の屋根面が表現される。 +
付属物のうち、短辺3m以上の規模の大きな付属物が再現される。 +
LOD3では外壁面が詳細化されるため、LOD2では表現されない付属物の下部の形状も表現される。 +
また、外壁面に設けられた短辺1m以上の開口部（窓、扉）が再現される。 +
なお、上図の場合、軒裏は3m以内であったため、表現されなかった。

下図に3m以上の軒を表現した例を示す。LOD3.0において軒を表現する建築物として、寺社や城といった特殊な建築物あるいは倉庫等の規模が大きな建築物が該当する。

h| LOD3.1
|
image::images/140.webp.png[]
|
短辺の実長1m以上かつ上方からの正射影の面積3m2以上の屋根面が表現される。 +
この結果、左図の例では、LOD3.0では切妻屋根として表現されたが、LOD3.1の条件を満たしたため、入母屋屋根として表現された。 +
また、この例図では、軒裏の距離が1m以上あったため、表現された。 +
開口部及び屋外付属物の表現は、LOD3.0と同様の表現となる。

h| LOD3.2
|
image::images/141.webp.png[]
|
LOD3.2ではさらに詳細な表現が可能となり、短辺の実長1m以上又は上方からの正射影の1m2以上屋根が再現される。 +
左図の例では、屋根に設けられた小屋根がこの条件に該当し、再現されている。 +
また、LOD3.2では、短辺が実長1m以上又は上方又は側方からの正射影の面積1m2以上の屋外付属物が表現される。 +
左図の例では、屋根上の煙突と外壁面に設けられた庇がこの条件を満たしたため屋外付属物として表現された。 +
LOD3.2では、面積1m2以上の窓や扉も表現されるため、この条件に該当する窓が追加された。

h| LOD3.3
|
image::images/142.webp.png[]
|
LOD3.3では、短辺の実長が1m未満の細かな屋根の形状が表現される。 +
左図の例では、LOD3.1及びLOD3.2では1枚の屋根面として表現されていたが、LOD3.3では傾斜の異なる2枚の屋根面として区分された。 +
また、軒裏のうち、屋根の外周との距離が1m未満の狭い軒裏も表現された。 +
さらに、LOD3.3の条件を満たす1m未満の小さな開口部や付属物が追加された。

|===

[cols="a,a,a,a,a,a"]
.LOD3.0,LOD3.1,LOD3.2及びLOD3.3の区分
|===
h| 建築物モデル（LOD3）に含むべき地物
h| 対応するCityGMLの地物型
^h| LOD3.0
^h| LOD3.1
^h| LOD3.2
^h| LOD3.3

| 建築物 | Building ^| ● ^| ● ^| ● ^| ●
| 屋根面
| RoofSurface
^| ● +
短辺の実長3m以上
^| ● +
短辺の実長1m以上 +
かつ上方からの正射影の面積 3m2以上
^| ● +
短辺の実長1m以上 +
又は +
上方からの正射影の 1m2以上
^| ● +
全てを対象とする

| 底面 | GroundSurface ^| ● ^| ● ^| ● ^| ●
| 外壁面
| WallSurface
^| ● +
短辺の実長3m以上
^| ● +
短辺の実長1m以上 +
かつ側方からの正射影の面積3m2以上
^| ● +
短辺が実長1m以上 +
又は +
側方からの正射影の面積1m2以上
^| ● +
全てを対象とする

| 軒裏 | WallSurface ^| 屋根の外周と外壁面との距離3m以上 ^| 屋根の外周と外壁面との距離1m以上 ^| 屋根の外周と外壁面との距離1m以上 ^| 全てを対象とする
| 建築物部分
| BuildingPart
^| ■ +
一棟の建築物を主題属性の異なる複数の部分に分ける場合に必須とする。
^| ■ +
一棟の建築物を主題属性の異なる複数の部分に分ける場合に必須とする。
^| ■ +
一棟の建築物を主題属性の異なる複数の部分に分ける場合に必須とする。
^| ■ +
一棟の建築物を主題属性の異なる複数の部分に分ける場合に必須とする。

| 閉鎖面
| ClosureSurface
^| ■ +
BuildingPartを使用する場合
^| ■ +
BuildingPartを使用する場合
^| ■ +
BuildingPartを使用する場合
^| ■ +
BuildingPartを使用する場合

| 屋外床面 | OuterFloorSurface ^| ○ ^| ○ ^| ○ ^| ○
| 屋外天井面 | OuterCeilingSurface ^| ○ ^| ○ ^| ○ ^| ○
| 屋外付属物 +
バルコニー、屋外階段、スロープ、手すり、エレベータ、エスカレータ、庇、アンテナ、煙突、看板等
| BuildingInstallation
^| ● +
短辺が実長3m以上 +
又は +
短辺が実長1m以上 +
かつ上方又は側方からの正射影の面積3m2以上
^| ● +
短辺が実長3m以上 +
又は +
短辺が実長1m以上 +
かつ上方又は側方からの正射影の面積3m2以上
^| ● +
短辺が実長1m以上 +
又は +
上方又は側方からの +
正射影の面積1m2 +
以上
^| ● +
全てを対象とする

| 扉
| Door
^| ● +
短辺が実長1m以上
^| ● +
短辺が実長1m以上
^| ● +
上方又は側方からの +
正射影の面積1m2 +
以上
^| ● +
全てを対象とする

| 窓
| Window
^| ● +
短辺が実長1m以上
^| ● +
短辺が実長1m以上
^| ● +
上方又は側方からの +
正射影の面積1m2 +
以上
^| ● +
全てを対象とする

|===

[%key]
●:: 必須
■:: 条件付必須
〇:: 任意（ユースケースに応じて要否を決定してよい）

LOD3の建築物も、LOD2と同様に、建築物は、屋根、外壁等を境界として区切られた空間（立体）となる。そのため、建築物の立体を構成する境界面は、屋根、外壁等の境界面となる地物型の空間属性（面）から構成される。また、LOD3では屋根や外壁等の境界面に開口部（窓、扉）を設けることができる。この開口部を境界面の内空として作成する場合、建築物の立体を構成する境界面には、開口部の空間属性（面）も含まれる（<<fig-C-9>>）。


[requirement]
.LOD3立体の境界面参照
====
[%metadata]
identifier:: /req/bldg/13
subject:: 妥当な建築物データセットの要件
description:: bldg:lod3Solidで示される立体は、その境界面として、建築物の境界となる地物型（bldg:_BoundarySurface）の空間属性を外部参照しなければならない。
====

[[fig-C-9]]
.LOD3における建築物の空間属性の記述
image::images/143.webp.png[]

なお、LOD3では、建築物の軒を表現することができる。軒とは、屋根の一部であり、外壁の線から外に突き出した部分である。通常は建物の外周に沿って連続した形となっている。この軒は、開口部の上部など部分的に取り付けられる庇（ひさし）とは区別する。軒を表現した例を<<fig-C-10>>に示す。LOD2では屋根の形状は建築物の立体を構成する面であり、軒の表現は行わない。LOD3において屋根の軒を表現する場合には、屋根は厚みをもった面となり、軒を含む全ての境界面が建築物の立体を構成する面となる。

[[fig-C-10]]
.LOD3における建築物の軒の表現
image::images/144.webp.png[width="500"]

建築物モデル（LOD0）から建築物モデル（LOD3）の作成手法を<<fig-C-11>>に示す。LOD2は、航空写真等上空から取得したデータの利用を前提とした区分であり、屋根形状を含む建築物の上面を詳細化する。LOD3は、MMSによる点群や画像等、側面から取得したデータの利用を前提とした区分であり、外壁面や開口部を含む建築物の側面を詳細化する。なお、最も細かいLOD3.3では地上レーザ点群又はBIMデータの活用も想定される。

[[fig-C-11]]
.各LODで想定する作成手法
image::images/145.webp.png[width="600"]

[[tocC_03_01_05]]
===== LOD4

建築物モデル（LOD4）では、建築物の外形を面の集まり又は立体として表現するとともに、建築物の内部の空間を表現する。このとき、bldg:Buildingにより記述される建築物の外形は、LOD3の形状の取得基準と同様である。LOD4は測量によるデータ作成だけではなく、BIMモデルからの変換により作成される場合がある。測量により作成する場合にはbldg:lod4Solid、BIMモデルからの変換により作成する場合には、bldg:lod4MultiSurfaceを使用する。いずれの型を使用する場合でも、建築物オブジェクトは、建築物モデル（LOD4）の定義に従ったものでなければならない。


[requirement]
.建築物のLOD4形状定義
====
[%metadata]
identifier:: /req/bldg/14
subject:: 妥当な建築物データセットの要件
description:: 建築物のLOD4の形状は、建築物モデル（LOD4）の定義に従う。
====

建築物モデル（LOD4）は、含むべき地物により、LOD4.0、LOD4.1及びLOD4.2に区分される。標準製品仕様書では原則としてLOD4.0を採用する。ただし、ユースケースの必要に応じてLOD4.1又はLOD4.2を採用できる。

[[tab-C-8]]
[cols="1a,9a"]
.建築物モデル（LOD4）の取得イメージ
|===
| LOD | 取得イメージと説明

| LOD4.0
|

image::images/146.webp.png[]

LOD4.0は建築物の外形（上図1）に加え、建築物の内部を表現する。このとき、建築物の内部は部屋（bldg:Room）に区切られ、各部屋の形状を立体として表現する（上図2）。 +
また、部屋の立体の境界面を、天井面（bldg:CeilingSurface）、内壁面（bldg:InteriorWallSurface）、床面（bldg:FloorSurface）又は閉鎖面（bldg:ClosureSurface）のいずれかに区分する（上図3）。さらに、各部屋の天井面、内壁面又は床面に存在する扉（bldg:Door）及び窓（bldg:Window）を区分する（上図4）。
閉鎖面は、境界面となる内壁面、天井面又は床面がないが、建築確認申請では部屋となっている空間を区切る場合に、仮想的な境界面として使用する。 +
上図1のように、建築物が複数の階から構成される場合、上図4に示す同じ階の部屋を、CityObjectGroupを使用してグループ化することで階を表現する。このとき、CityObjectGroupの名称（gml:name）は階を識別する名称となる。

なお、CityGMLでは壁面や天井面などは全て面として表現する。一方、現実世界の壁には厚みがある。一つの壁が建築物の外形を示す外壁と部屋の外形を示す内壁との機能を備えていた場合（上図5）、建築物の外形となる面（bldg:WallSurface）と部屋の外形となる面（bldg:InteriorWallSurface）の二枚の面として表現され、それらの面の間には隙間（壁の厚み）ができる（何もない）。 +
また、LOD4.0では建築物の内部に存在する付属物や家具を表現しない。

// this row is_common to both doc01 and doc02 slide19

| LOD4.1
|

image::images/147.webp.png[width="450"]

LOD4.1ではLOD4.0に、屋内付属物（bldg:IntBuildingInstallation）として、階段、スロープ、輸送設備（エスカレータ、エレベータ及び動く歩道）、柱及びデッキ・ステージが追加される。 +
上図の例では、LOD4.0に加えて、階段、踊り場、エレベータ、柱が付属物として追加された。

// this row is_common to both doc01 and doc02 slide19

| LOD4.2
|

image::images/148.webp.png[width="450"]

LOD4.2ではLOD4.1に屋内付属物（bldg:IntBuildingInstallation）として、手すり、パネル及び梁が付属物として追加される。また、机や椅子などの移動可能な家具（bldg:BuildingFurniture）が追加してもよい。 +
上図の例では、LOD4.2に加えて屋内付属物として階段の手すりとパネル（間仕切り）、また、家具として机及び椅子が追加された。

|===

[[tab-C-9]]
[cols="2a,2a,2a,2a,2a,2a"]
.LOD4.0,LOD4.1及びLOD4.2の区分
|===
2+h| 建築物モデル（LOD4）に含むべき地物 h| 対応するCityGMLの地物型 ^h| LOD4.0 ^h| LOD4.1 ^h| LOD4.2
2+| 建築物 | bldg:Building ^| ● ^| ● ^| ●
2+| 建築物部分
| bldg:BuildingPart
^| ■ +
一棟の建築物を、属性の異なる複数の部分に分ける場合に必須とする。
^| ■ +
一棟の建築物を、属性の異なる複数の部分に分ける場合に必須とする。
^| ■ +
一棟の建築物を、属性の異なる複数の部分に分ける場合に必須とする。

2+| 屋根面 | bldg:RoofSurface ^| ● ^| ● ^| ●

// this row is_common to both doc01 and doc02 slide20
2+| 外壁面 | bldg:WallSurface ^| ● ^| ● ^| ●
2+| 底面 | bldg:GroundSurface ^| ● ^| ● ^| ●
2+| 屋外天井面 | bldg:OuterCeilingSurface ^| ○ ^| ○ ^| ○
2+| 屋外床面 | bldg:OuterFloorSurface ^| ○ ^| ○ ^| ○
2+| 屋外付属物 | bldg:BuildingInstallation ^| ● ^| ● ^| ●
2+| 部屋 | bldg:Room ^| ● ^| ● ^| ●
2+| 天井面 | bldg:CeilingSurface ^| ● ^| ● ^| ●
2+| 内壁面 | bldg:InteriorWallSurface ^|  ● ^| ● ^| ●
2+| 床面 | bldg:FloorSurface ^| ● ^| ● ^| ●
2+| 閉鎖面
| bldg:ClosureSurface
^| ■ +
BuildingPartを使用する場合、及び、内壁面、天井面、床面が無いが建築確認申請上部屋として区分されている空間を区切る場合に必須とする。
^| ■ +
BuildingPartを使用する場合、及び、内壁面、天井面、床面が無いが建築確認申請上部屋として区分されている空間を区切る場合に必須とする。
^| ■ +
BuildingPartを使用する場合、及び、内壁面、天井面、床面が無いが建築確認申請上部屋として区分されている空間を区切る場合に必須とする。

2+| 窓 | bldg:Window ^| ● ^|  ● ^| ●
2+| 扉 | bldg:Door ^| ● ^| ● ^| ●
.8+| 屋内付属物 | 階段 | bldg:IntBuildingInstallation |  ^| ● ^| ●
| スロープ | bldg:IntBuildingInstallation |  ^| ● ^| ●
| 輸送設備 | bldg:IntBuildingInstallation |  ^| ● ^| ●
| 柱 | bldg:IntBuildingInstallation |  ^|  ● ^|  ●
| デッキ・ステージ | bldg:IntBuildingInstallation |  ^| ● ^| ●
| 梁 | bldg:IntBuildingInstallation |  |  ^| ○
| パネル | bldg:IntBuildingInstallation |  |  ^| ○
| 手すり | bldg:IntBuildingInstallation |  |  ^| ○
2+| 家具 | bldg:BuildingFurniture |  |  ^| ○
2+| 階 | grp:CityObjectGroup ^| ● ^| ● ^| ●
2+| 任意設定空間（例：防火区画） | grp:CityObjectGroup |  |  ^| ○

|===

[%key]
●:: 必須
■:: 条件付必須
〇:: 任意（ユースケースに応じて要否を決定してよい）

建築物モデル（LOD4）による建築物の外形は、建築物モデル（LOD3）と同様である。よって、建築物の立体を構成する境界面は、屋根面、外壁面等の境界面となる地物型の空間属性（面）から構成され、屋根面や外壁面等の境界面に開口部を境界面の内空として作成する場合には、建築物の立体を構成する境界面には、開口部の空間属性（面）も含まれる（<<fig-C-12>>）。

[[fig-C-12]]
.LOD4 における建築物の空間属性の記述（bldg:lod4Solidを使用する場合）
image::images/149.webp.png[]

建築物モデル（LOD4）による建築物の形状を、面の集まりとして表現する場合も同様である。建築物を構成する面は、屋根面、外壁面等の境界面となる地物型の空間属性（面）や開口部の空間属性（面）となる（<<fig-C-13>>）。

[[fig-C-13]]
.LOD4 における建築物の空間属性の記述（bldg:lod4MultiSurfaceを使用する場合）
image::images/150.webp.png[]


[[tocC_03_02]]
==== 建築物の主題属性

bldg:Buildingの主題属性には、あらかじめCityGML又はGMLにおいて定義された属性（接頭辞bldg、gml）と、i-URにより拡張された属性（接頭辞uro）がある。CityGMLで定義された属性は、建築物の用途や階数など、基本的な情報となる。i-URにより拡張された属性には、建築物を識別するための属性（uro:BuildingIDAttribute）、都市計画基礎調査において収集された詳細な情報を格納するための属性（uro:BuildingDetailAttribute、uro:LargeCustomerFacilityAttribute）、災害リスク情報を格納するための属性（uro:BuildingDisasterRiskAttribute）、作成したデータの品質に関する情報を格納するための属性（uro:DataQualityAttribute）、建築物が存在する土地及び建築物に紐づく不動産IDを格納するための属性（uro:RealEstateIDAttribute）などがある。また、拡張製品仕様においてコード型の属性を追加した場合には、主題属性としてuro:KeyValuePairAttributeが含まれる。 +
さらに、特定分野での施設管理に使用する属性として、施設区分に関する属性（uro:FacilityTypeAttribute）、その分野における施設の位置や識別に関する属性（uro:FacilityIdAttribute）、その分野における施設の詳細な属性（uro:FacilityAttribute）をもつことができる。また、公共測量標準図式に従った表現に必要となる属性（uro:bldgDmAttribute）をもってもよい。

[[tocC_03_02_01]]
===== 名称（gml:name）

bldg:Buildingの属性gml:nameは、建築物の名称である。 +
建築物の名称は、建築物を検索したり、地図上での位置を特定したりするために使用することができる有益な情報である。そのため、公共施設やランドマークについては、可能な限り名称を付与することが望ましい。 +
公共施設の名称については、原典資料として<<nlftp,国土数値情報（公共施設データ）>>がある。またモデル整備主体となる基礎自治体にから主要な公共施設のリストを入手することも考えられる。

[[tocC_03_02_02]]
===== 用途（bldg:usage）

bldg:Buildingの属性bldg:usageは、建築物の主な用途である。 +
用途の区分は都市によって異なる場合が多いが、複数の都市間を定量的に比較したい場合には区分が統一されていることが望ましい。そこで、bldg:Buildingの属性bldg:usageには、統一的な区分として、<<mlit_foundation_reqs,都市計画基礎調査実施要領>>において示された建物利用現況の用途の区分を採用する。 +
なお、都市ごとの独自の区分を建築物の属性として3D都市モデルに含める場合には、 +
uro:BuildingDetailAttribute（<<tocC_03_02_06>>）に定義された +
uro:majorUsage、uro:orgUsage等の属性（<<tocC_03_02_07>>）を用いる。

[[tocC_03_02_03]]
===== 計測高さ（bldg:measuredHeight）

建築物の属性「計測高さ」は、「計測により得られた建築物の地上の最低点から最高点までの高さ」である。その取得方法には、①地上測量による直接計測、②航空写真測量による直接計測、③航空写真測量・数値表層モデル（DSM：Digital Surface Model）による間接計測、④航空レーザ測量・DSMによる間接計測等、様々な方法が存在する。 +
このうち、③及び④の方法により取得する場合、DSMには、建築物の屋根以外を計測した点 +
（以下、「ノイズ」と称す）が含まれる（<<fig-C-14>>）。 +
そのため、このノイズを除去したうえで、建築物の最高点までの高さを取得する必要がある。

[[fig-C-14]]
.点群に含まれるノイズ
image::images/151.webp.png[width="500"]

ノイズを除去する場合、最高値から一定の割合（例：5%）を除去する、又は標準偏差の2σに含まれない点群を除去するというように閾値を設定しなければならない。しかしながら原典資料の状態や対象地域の地形により点群に含まれるノイズは一律でないことから、これらの条件を踏まえ、データ作成者が設定してよい。 +
例えば、2020年度に実施されたProject PLATEAUでは、テストエリアにおいて +
点群データの最高値から1%、3%、5%、7%を除去した値と、図化により作成した「LOD2」の建築物の高さとの相関性を確認し、最高値から5%を除去することを決定した。 +
なお、DSMに含まれる点群が建築物の最高点となる場所に存在することは保証されないため、ノイズを除去しても、取得した計測高さが必ずしも建築物の最高点までの高さにはならないことに留意する必要がある。特に、本属性を必要とするユースケースがこれを許容しない場合には、直接計測等の他の取得方法の採用を検討する必要がある。

[[tocC_03_02_04]]
===== 建築物の住所（bldg:address）

標準製品仕様書では、建築物の主題属性として住所（bldg:address）を定義している。住所は、概ねの場所を検索・特定するために使用できる有益な情報である。そのため、全ての建築物には可能な限り住所を付与することが望ましい。 +
原典資料としては、国勢調査（町丁・字等別境界データ）、<<nlftp,国土数値情報（公共施設データ）>>及び基礎自治体から入手した主要な公共施設リスト等がある。 +
なお、CityGMLでは、住所の記述についてXMLに関する標準化団体であるOASIS（Organization for the Advancement of Structured Information Standards）により策定されたextensible Address Language （xAL）を参照している。住所を構造化して記述する場合には、xALの構造に従う。 +
建築物の住所は、建築物の場所を特定する地理識別子として利用されるだけではなく、建築物とこれに関連する様々な情報とを連携するキーとして利用されることが想定される。そのため、この属性を用いて、住所の地名辞典を整備更新できるよう、構造化して記述することを推奨する。 +
構造化して記述する場合の記述例を以下に示す。


[example]
.構造化する場合の記述例
====
[source,xml]
----
<core:Address>
	<core:xalAddress>
	  <xAL:AddressDetails>
		  <xAL:Country>
        <xAL:CountryName>日本</xAL:CountryName>
        <xAL:Locality>
          <xAL:LocalityName Type="prefecture">東京都</xAL:LocalityName>
          <xAL:LocalityName Type="city">渋谷区</xAL:LocalityName>
          <xAL:DependentLocality Type="district">
            <xAL:DependentLocalityName>神宮前</xAL:DependentLocalityName>
            <xAL:DependentLocalityNumber>2-2-3</xAL:DependentLocalityNumber>
          </xAL:DependentLocality>
        </xAL:Locality>
      </xAL:Country>
    </xAL:AddressDetails>
  </core:xalAddress>
</core:Address>
----
====

なお、構造化せずに略式（1行の住所文字列）で記述する場合は、以下のように記載する。

[example]
.住所の記述例
====
[source,xml]
----
<core:Address>
	<core:xalAddress>
	  <xAL:AddressDetails>
		  <xAL:Country>
        <xAL:CountryName>日本</xAL:CountryName>
        <xAL:Locality>
          <xAL:LocalityName Type=“town”>東京都渋谷区神宮前2-2-3</xAL:LocalityName>
        </xAL:Locality>
      </xAL:Country>
    </xAL:AddressDetails>
  </core:xalAddress>
</core:Address>
----
====

[[tocC_03_02_05]]
===== 建築物の識別属性（uro:BuildingIDAttribute）

uro:BuildingIDAttributeは、3D都市モデル内の建築物オブジェクトを識別するための属性である。そのため、3D都市モデル内の全ての建築物オブジェクトには、uro:BuildingIDAttributeを与えなければならない。 +
uro:BuildingIDAttributeには五つの属性がある。このうち、uro:buildingID及びuro:cityを必須とする。


[requirement]
.建築物オブジェクトの識別情報
====
[%metadata]
identifier:: /req/bldg/15
subject:: 妥当な建築物データセットの要件
description:: 全ての建築物オブジェクトは、uro:buildingID及びuro:cityをもたなければならない。
====

uro:buildingIDは、3Ｄ都市モデル内の建築物オブジェクトを区別・特定するための識別子である。gml:idがデータ集合内におけるデータの識別子であることに対し、uro:buildingIDは、現実世界に存在する建築物の識別子となる。 +
uro:buildingIDは、建築物の存続期間（建設から取り壊されるまで）において永続的に利用される識別子となる（データ更新においても、建築物の建て替わりがない場合にはこの識別子を引き継ぐ）。

建物IDは、以下の規則により付与する。

----
XXXXX-YYY-ZZZZZZZZZZZZ
----

[cols="3a,17a"]
|===
| `XXXXX` | 当該地物オブジェクトが存在する市区町村のコード。複数の市区町村に跨る場合には、データセットの市区町村のコードとする。先頭の0は省略せず、5桁で記述する。

前2桁：JIS X0401による都道府県コード

後3桁：JIS X0402による市区町村コード

| `YYYY`
| 地物型の区分を示す3桁又は4桁のコード

建築物の場合は、bldg

| `ZZZZZZZZZZZZ` | オブジェクト連番（先頭の0は省略する）

|===

`ZZZZZZZZZZZZ` は連番を基本とするが、町字や街区等により細分し、エリア内における概ねの場所が分かるように設定することもできる。 +
ここで、建築物に、ゴミ集積所や集会所といった付帯的な建築物があった場合には、一つの建築物とみなされるとして、uro:buildingIDの値は、同じものを付与してもよい。なお、これらは汎用属性「枝番」により主たる建築物と付帯的な建築物の区分を行うことができる。このとき、付帯的な建築物には空間属性のみを記述し、その他の属性は原則不要とする。属性を記述する場合には、属性uro:noteにゴミ集積所や集会所といった情報を補足的に記述する。

[[fig-C-15]]
.一つとみなされる建築物の例
image::images/152.webp.png[]

uro:cityは、3d都市モデル内の建築物オブジェクトの空間的な範囲を特定するために使用する識別子である。一つのデータ集合には、数多くの建築物オブジェクトが含まれる。これを効率的に検索・表示するためにuro:cityを使用する目的でこの属性を必須とする。 +
なお、uro:cityには、JIS X0401に示される2桁の都道府県コードと +
JIS X0402に示される市区町村コードを加えた5桁を記載するが、政令指定都市においては「区」に該当する市区町村コードとする。 +
なお、行政界を跨ぐ建築物の場合、その建築物の住所又は建築物モデル（LOD3）の面積が最も多く含まれる市区町村の市区町村コードとする。また、行政界が確定しておらず、いずれの市区町村に含めるべきかが確定していない場所（境界未確定部）に立地する建築物の市区町村コードは、整備対象となる市区町村の都市計画基本図（数値地形図データ）での取り扱いに準じる。数値地形図データが広域で整備されている等により判断できない場合は、発注者との協議により決定する。

[[tocC_03_02_06]]
===== 都市計画基礎調査のための属性

都市計画基礎調査で収集された建築物の情報を格納するための属性型として、標準製品仕様書ではuro:BuildingDetailAttribute及びuro:LargeCustomerFacilityAttributeを定義している。 +
uro:BuildingDetailAttributeは建物利用現況として調査・収集された情報を格納するための型である。また、uro:LargeCustomerFacilityAttributeは大規模小売店舗等の立地状況として調査・収集された情報を格納するための型である。uro:BuildingDetailAttribute及びuro:LargeCustomerFacilityAttributeの属性uro:surveyYearは、建物利用現況又は大規模小売店舗等の立地状況の調査が実施された年度をさす。 +
なお、都市独自に調査・収集している項目等、uro:BuildingDetailAttribute及びuro:LargeCustomerFacilityAttributeに定義された属性で不足する場合には、本作業手順書の手順に従い、属性を拡張する。

[[tocC_03_02_07]]
===== 都市独自の建物用途（uro:majorUsage、uro:orgUsage、uro:detailedUsage）

uro:majorUsage、uro:orgUsage及びuro:detailedUsageは都市ごとの独自の区分に従った建築物の用途を格納するための属性である。これらの属性には、都市ごとに体系化された階層性をもつ用途のコードを記述できる。

[cols="3a,17a"]
|===
| 使用可能な属性 | 説明

| uro:majorUsage | <<mlit_foundation_reqs,都市計画基礎調査実施要領>>の区分よりも粗い区分に適用。二段階あった場合にはuro:majorUsage2も使用できる。
| uro:orgUsage | <<mlit_foundation_reqs,都市計画基礎調査実施要領>>の区分に相当する独自区分に適用。<<mlit_foundation_reqs,都市計画基礎調査実施要領>>の区分における商業施設、文教厚生施設等に設定されたより細かい区分に相当する独自区分があった場合には、uro:orgUsage2を使用できる。
| uro:detailedUsage | <<mlit_foundation_reqs,都市計画基礎調査実施要領>>の区分よりもさらに細かい用途の区分に適用。詳細な区分が階層化されている場合には、uro:detailedUsage2及びuro:detailedUsage3を使用できる。

|===

なお、都市ごとの独自の用途区分を記述する場合には、用途を示すコードに対応するコードリストを必ず作成しなければならない。

[[tocC_03_02_08]]
===== 構造種別（uro:buildingStructureType）

bldg:Buildingの属性uro:buildingStructureTypeは、「建築物に使用されている主たる材料の区分」である。 +
構造種別の区分は都市によって異なる場合が多いが、複数の都市間を定量的に比較したい場合には区分が統一されていることが望ましい。そこで、建築物の属性uro:buildingStructureTypeには、統一的な区分として、<<mlit_foundation_reqs,都市計画基礎調査実施要領>>において示された建物利用現況の構造の七区分に、多くの都市で使用されている「非木造」を加えた八区分を採用する。 +
一方、都市ごとの独自の区分を利用し、データの可視化・分析を行うことも考えられるため、これらについては、建築物の主題属性uro:buildingStructureOrgTypeを使用し記述する。ただし、この属性に対応するコードリストを必ず作成しなければならない。

[[tocC_03_02_09]]
===== 建築物の災害リスク属性（uro:DisasterRiskAttribute）

uro:DisasterRiskAttributeは、災害リスク情報と建築物の位置関係により建築物毎の災害リスクを空間演算し、その結果を建築物の主題属性として記述するための属性である。 +
標準製品仕様書では、以下を災害リスク属性として定義している。

* 洪水浸水想定区域（uro:RiverFloodingRiskAttribute）
* 津波浸水想定（uro:TsunamiRiskAttribute）
* 高潮浸水想定（uro:HighTideRiskAttribute）
* 内水浸水想定（uro:InlandFloodingRiskAttribute）
* ため池ハザードマップ（uro:ReservoirFloodingRiskAttribute）
* 土砂災害警戒区域（uro:LandSlideRiskAttribute）

[[tocC_03_02_09_01]]
====== 一つの建築物が複数の区域に跨る場合の属性付与の方法

* 洪水浸水想定区域の場合
+
--
同一の浸水想定区域図において、複数の区域に建築物が跨って存在する場合は、同一浸水ランクを持つ浸水ランクのメッシュを一つの区域とし、その区域と建築物が重なる面積が最も大きい浸水ランクの値を採用する。（面積が等しい場合は、より危険な区域を採用する） +
浸水深は採用した浸水ランクを持つ浸水深のメッシュのうち、建築物と重なる面積が最も大きいメッシュの浸水深を採用する。（同じ浸水深を持つメッシュは面積算出の際に合算する） +
浸水継続時間は採用した浸水深のメッシュと重なる浸水継続時間のメッシュの浸水継続時間を採用する。複数の浸水継続時間のメッシュが重なる場合は最も大きい浸水継続時間の値を採用する。（浸水継続時間のメッシュが採用した浸水深のメッシュと重なり、建築物とは直接重ならない場合も対象に含む） +
浸水深の有効桁数は、「浸水想定区域図データ電子化ガイドライン（第4版）」に従い、浸水深の有効桁数は、小数点以下 3 桁（4桁目を四捨五入）まで登録可能とするが、小数点以下 2 桁（3桁目を四捨五入）でもよいとする。面積の有効桁数は、小数点2桁（3桁目で四捨五入）とする。

[[fig-C-16]]
.境界上に存在する建築物の例
image::images/153.webp.png[width="500"]
--

* 土砂災害警戒区域の場合
+
--
複数の土砂災害警戒区域が重複している場合は以下のように取り扱う。 +
「現象区分」が異なる土砂災害警戒区域が重なっている場合：それぞれを災害リスク属性として記述する。 +
「現象区分」が同じで異なる「区域区分」の土砂災害が重なっている場合：危険度の最も高い「区域区分」を採用し、汎用属性セットを一つのみ記述する。「区域区分」の危険度は、高いほうから以下とする。

土砂災害特別警戒区域（指定済）　＞　土砂災害警戒区域（指定済）　＞　土砂災害特別警戒区域（指定前）　＞　土砂災害警戒区域（指定前）

例えば、一つの建築物について「土石流の土砂災害警戒区域（指定済）」、「土石流の土砂災害特別警戒区域（指定前）」、及び「地すべりの土砂災害特別警戒区域（指定済）」の三種類の範囲が重なっている場合があるとする。このとき、「土石流」「地すべり」とで「現象区分」が異なっている。また、「土砂災害警戒区域（指定済）」と「土砂災害特別警戒区域（指定前）」とは「土砂災害警戒区域（指定済）」のほうが危険度は高い。そのため、「土石流の土砂災害警戒区域（指定済）」及び「地すべりの土砂災害特別警戒区域（指定済）」の二種類を建築物の土砂災害警戒区域の属性として記述する。
--

[[tocC_03_02_09_02]]
====== 洪水浸水想定区域の指定河川名称

洪水浸水想定区域（uro:RiverFloodingRiskAttribute）の属性uro:descriptionは、指定河川の名称となる。このとき、指定河川の名称は、以下の規則に従う。

* 水防法に基づき指定された洪水浸水想定区域図の対象となる洪水予報河川又は水位周知河川として示された、「水系名」及び「指定河川名」を用いることを基本とする。
+
====
「利根川水系小山川　洪水浸水想定区域図（想定最大規模）」の場合は、「利根川水系小山川」とする。
====

* 一つの浸水想定区域図に複数の洪水予報河川又は水位周知河川が含まれている場合は、「指定河川名」を列挙する。指定河川名を列挙する場合の区切り文字は「・」（全角中点）を使用する。
+
====
「多摩川水系　平瀬川・平瀬川支川・二ケ領本川・五反田川洪水浸水想定区域図（想定最大規模）」の場合は、「多摩川水系平瀬川・平瀬川支川・二ケ領本川・五反田川」とする。
====

* 都道府県が独自に作成している浸水の区域図は、当該浸水想定区域の名称から、対象となる区域を指す名称を用いる。
+
====
「江東内部河川流域浸水予想区域図」の場合は、「江東内部河川流域」とする。
====

なお、洪水浸水想定区域図の名称には、必ずしも全ての指定河川が含まれているとは限らない。よって、洪水浸水想定区域図の「基本事項等」に記載されている、「対象となる河川」を確認する必要がある。

[[tocC_03_02_10]]
===== 建築物のデータ品質属性（uro:DataQualityAttribute）

建築物の3D都市モデルを作成する場合、様々な原典資料を組み合わせて作成することが想定される。例えば、地図情報レベル2500の数値地形図を用いてLOD1の建築物を都市全域で作成したが、一部の地域についてはより新しい航空写真が得られたため、これを用いて図化する、又は一棟の建物であっても、屋根形状は地図情報レベル2500の航空写真からの図化により作成し、開口部はMMSにより撮影した地図情報レベル500のレーザ点群データの図化により作成することが考えられる。 +
位置正確度の異なる原典資料を用いて作成した3D都市モデルを作成した場合、位置正確度の異なる建築物がデータ集合内に混在することになる。同様にして、異なる原典資料を使用したことにより、同じデータ集合内のLOD2の建築物であっても屋根形状のみしか再現されていない建築物と付属物まで取得された建築物とが混在する可能性がある。 +
3D都市モデルでは、データ集合全体としての品質はメタデータに記録する。しかしながら、メタデータでは、個々の建築物に対して位置正確度や適用したLOD等の品質を記述することが困難である。

そこで、標準製品仕様書では、個々の建築物に対してデータ品質に関する情報を記述するための属性として、「データ品質属性」（uro:DataQualityAttribute）を定義している。データ品質属性は、属性としてデータ作成に使用した原典資料の地図情報レベル、その他原典資料の諸元、精緻化したLOD及びLOD1の押し出しに使用する建築物の高さ（<<tocC_03_02_11>>）をもつ。 +
3D都市モデルに含まれる全ての建築物オブジェクトは、このデータ品質属性を必ず作成しなければならない。ただし、建築物（bldg:Building）又はその部分（bldg:BuildingPart）に対してデータ品質属性を付与することはできるが、これを構成する屋根面や外壁面（bldg:_BoundarySurface）ごとにデータ品質属性を付与することはできない。

[[tocC_03_02_11]]
===== LOD1の押し出しに使用する建築物の高さ

uro:lod1HeightTypeは、LOD1の押し出しに使用する建築物の高さを記述するための属性である。 +
LOD1において、建築物に一律の高さを与える場合、与えられた高さが何を根拠としているかを3D都市モデルの利用者に対して明確にしておく必要がある。そこで、LOD1で建築物を作成する場合には、建築物の主題属性として、上面の高さが何に基づき算出された値であるかを記述する。


[requirement]
.LOD1上面高さの根拠付与
====
[%metadata]
identifier:: /req/bldg/16
subject:: 妥当な建築物データセットの要件
description:: 建築物の主題属性として、LOD1で作成する建築物の上面の高さの根拠を付与する。
====

また、標準作業手順書ではLOD1での建築物の高さは中央値の使用を推奨している。しかしながらユースケースによっては、中央値では要求を満たさない場合がある。このようなときには必要な高さを主題属性として追加できる。 +
標準製品仕様では、uro:buildingHeight（建築基準法施行令第2条に定義される地盤面からの建築物の高さ）及びuro:eaveHeight（建築基準法施行令第2条に定義される建築物の地盤面から軒桁までの高さ）をuro:BuildingDetailAttributeの属性として定義しているが、これら以外の高さを、拡張製品仕様において追加してもよい。 +
追加する場合には、数値の単位を明らかにするため、gen:measureAttributeを使用する。


[requirement]
.建築物の高さ属性追加方法
====
[%metadata]
identifier:: /req/bldg/17
subject:: 妥当な建築物データセットの要件
description:: 建築物に高さを属性として追加する場合には、gen:measureAttributeを使用する。
====

[[tocC_03_02_12]]
===== 施設管理のための属性

施設管理のための属性は、港湾施設及び漁港施設、河川管理施設や公園管理施設等の施設管理に必要な情報を定義した属性である。施設管理のための属性は以下のデータ型を用いて記述する。

[[tocC_03_02_12_01]]
====== 施設分類属性（uro:FacilityTypeAttribute）

uro:FacilityTypeAttributeは、各分野で定める施設の区分を記述するためのデータ型である。CityGMLは、地物型を物体としての性質に着目して定義し、機能や用途は属性で区分している。例えば、「建築物（bldg:Building）」という地物型を定義し、bldg:usageにより「業務施設」や「商業施設」などを区分している。これにより、都市に存在する様々な地物を、分野を問わず網羅的に、かつ、矛盾が無く表現することを目指している。一方、各分野には独自の施設の区分がある。この区分は当該分野での施設管理に必要な情報であるが、CityGMLの地物型の区分とは一致しない。そこで、これらの地物型に分野独自の区分を付与するためにこのデータ型を用いる。uro:FacilityTypeAttributeは、二つの属性をもつ。uro:classは分野を特定するための属性である。またuro:functionは、uro:classにより特定した分野における施設の区分を示す。 +
標準製品仕様書では、港湾施設、漁港施設及び公園施設については標準製品仕様書においてuro:functionの区分が示されている。その他の区分についてはuro:classへの分野の追加も含め、拡張製品仕様書において拡張できる。

[[tocC_03_02_12_02]]
====== 施設識別属性（uro:FacilityIdAttribute）

uro:FacilityIdAttributeは、施設の位置を特定する情報及び施設を識別する情報を記述するためのデータ型である。uro:FacilityIdAttributeは、施設を識別するための情報として、識別子（uro:id）や正式な名称以外の呼称（uro:alternativeName）に加え、施設の位置を示すための、都道府県（uro:prefecture）、市区町村（uro:city）及び開始位置の経緯度（uro:startLat、uro:startLong）を属性としてもつ。また、鉄道上や道路上の施設については、路線や距離標での位置特定のための属性（uro:route、uro:startPost、uro:endPost）を使用できる。 +
なお、河川管理施設の場合は、uro:FacilityIdAttributeを継承するuro:RiverFacilityIdAttributeを使用する。これにより、左右岸上での位置の情報を記述できる。

[[tocC_03_02_12_03]]
====== 施設詳細属性（uro:FacilityAttribute）

uro:FacilityAttributeは、各分野において施設管理に必要となる情報を記述するためのデータ型である。uro:FacilityAttributeは、抽象クラスであり、これを継承する具象となるデータ型に、施設の区分毎に必要となる情報を属性として定義している。 +
標準製品仕様書では、港湾施設、漁港施設及び公園施設について、細分した施設の区分ごとにデータ型を定義している。また、施設に関する工事や点検の状況や内容を記述するためのデータ型（uro:MaintenanceHistoryAttribute）を定義している。

[[tocC_03_02_13]]
===== 数値地形図属性（uro:bldgDmAttribute）

公共測量標準図式に従った形状表現に必要な情報を記述するための属性である。LOD0の幾何オブジェクトのほか、数値地形図との互換性を保つために必要な情報が、属性として定義されている。

[[tocC_03_02_14]]
===== 不動産ID属性（uro:bldgRealEstateIDAttribute）

建築物が存在する土地及び建築物に紐づく不動産IDを記述するための属性である。不動産IDとは、「不動産を一意に特定することができる、各不動産の共通コード」である（参考：<<real_estate_id_guidelines,不動産IDルールガイドライン>>）。属性の型であるuro:RealEstateIDAttributeには、土地及び建築物に紐づく不動産IDを記述するための属性が定義されている。また、uro:RealEstateIDAttributeの属性uro:matchingScoreは、登記簿の情報と当該建築物の空間属性及び主題属性との一致の程度を示す値である。uro:matchingScoreは100点満点で算出され、点数が低いほど、一致度が低い、すなわち紐づけの信頼性が低いことを意味する。

