[[toc2_03]]
=== 作成方法の検討

既存資料の把握結果に基づき、作成方法を検討し、((3D都市モデル))の作成計画を作成する。

[[toc2_03_01]]
==== 作成方法と作成手順

データ作成対象とする地物型等について、作成方法を決定する。作成方法は以下のいずれかとなる。

. 既存資料から取得する
. 現地調査や測量等により、新規に取得する
. a．とb．の組み合わせにより取得する

<<fig-2-2>>に標準的な作業手順を示す。これは、従来の2次元の地理空間データを作成する手順と同じである。

[[fig-2-2]]
.標準的な作業手順
image::images/006.webp.png[width="200"]

このうち、幾何オブジェクトの作成については、幾何オブジェクトの種類が点、線又は平面の場合には、従来の数値地形図データの作成と同様の作業手順となる。そこで、以降では((建築物))を事例として((立体))の作業手順を示す。

===== ((LOD1))の((立体))の作成手順

LOD1の立体は、平面に一律の高さを与えて上向き又は下向きに押し出した箱モデル（Block model）である。<<fig-2-3>>にLOD1の立体を作成する場合の作業手順を示す。

[[fig-2-3]]
.LOD1の立体を作成する手順
image::images/007.webp.png[]

LOD1の立体を作成する場合、以下の条件により作業手順が異なるため、使用可能な既存資料や作業環境に応じた作業手順を選定する必要がある。(((LOD0)))

* 平面の外形データ（LOD0）の有無
* 図形の編集に使用するツールの種類：2次元のGIS/CAD（立体に非対応）、3次元のGIS/CAD（立体に対応）

[NOTE,type=commentary]
--
LOD1の立体は、平面を一律の高さで押し出した幾何オブジェクトである。

2次元のGIS/CADは立体を扱えないため、平面の図形に属性として付与した高さの情報を用いて、プログラムによる外部データ出力により、LOD1の立体データを作成しなければならない。一方、3次元のGIS/CADは立体を扱える。そのため平面の外形データがある場合にはこれに高さを与えて立体データを作成する、又は外形データを使わずに立体データを作成できる。

既存資料として外形データが無い場合には、まず2次元のGIS/CADデータを作成してから外部データ出力時にLOD1の立体データを作成する、あるいは、3次元のGIS/CADデータを作成してからデータ変換によりLOD1の立体データを出力する等の方法が考えられるが、いずれの方法を選択するかは、使用可能な既存資料やツールを考慮し決定する必要がある。
--

[requirement]
.LOD1の面編集
====
[%metadata]
identifier:: /att/planning/1
subject:: 標準作業手順
class:: 留意事項
[statement]
--
LOD1の押し出しに使用する平面の外形データが線の場合は面として編集する必要がある

* LOD1の押し出しはLOD0の幾何オブジェクトを使用することを基本とする。
* ただし、LOD0の幾何オブジェクトが外形線となっている場合には、面として編集する必要がある。

--
====

===== ((LOD2))及びLOD3の((立体))の作成手順

LOD2及びLOD3の立体は、都市オブジェクトの形状をより詳細に再現した立体である。LOD2の立体は、LOD1の立体の上面の形状が詳細化されたものであり、LOD3の立体は、LOD2の立体の形状の側面が詳細化されたものである。例えば((建築物))の場合、LOD1では一律の高さが与えられていたことに対し、LOD2では屋根形状が再現され、LOD3では窓や扉などが再現される。そのため、3次元のGIS/CADを用いた3次元図形の作成が必要となる（<<fig-2-4>>）。

[[fig-2-4]]
.LOD2及びLOD3の立体を作成する手順
image::images/008.webp.png[width="400"]

((LOD2))やLOD3の3次元図形を作成する場合、より低いLODの3次元図形を使用することが可能である。つまり、LOD2の幾何オブジェクトを作成する場合にLOD1の幾何オブジェクトを加工したり、LOD3の幾何オブジェクトを作成する場合にLOD2の幾何オブジェクトを加工したりできる。ただし、利用する場合には要求される位置正確度を満たしていなければならない。 +
LOD3の作成においては、((3D都市モデル))活用のための技術資料「<<plateau_tr_03>>」を参照するとよい。

[NOTE,type=commentary]
--
LOD2やLOD3の立体は一律の高さで押し出すのではなく、より詳細な幾何オブジェクトの作成が必要になる。また、建築物における屋根や壁面のように、細かい地物に区分する必要が生じる場合がある。そのため2次元のGIS/CADでのデータ作成は難しく、3次元のGIS/CADが必須となる。

例えば、LOD2の建築物を作る際に、LOD1の箱モデルを編集し、屋根形状を付けてLOD2とすることが考えられる。また、LOD2の建築物の壁面に窓や扉を付けてLOD3とすることも考えられる。このように、LOD2やLOD3を作成する際に、よりLODの低い幾何オブジェクトを使用してもよい。一方で、LOD2ではLOD1よりも、また、LOD3ではLOD2よりも高い位置正確度が要求される場合が想定され、品質を満たしていない場合には使用してはならない。
--

// (((建築物)))(((LOD1)))(((LOD2)))

[requirement]
.LOD2の底面一致
====
[%metadata]
identifier:: /att/planning/2
subject:: 標準作業手順
class:: 留意事項
[statement]
--
LOD2の立体となる底面は、LOD0及びLOD1の底面と一致する。

* LOD1はLOD0の面を一律の高さで上向き又は下向きに押し出した立体であり、LOD2は、LOD1の幾何オブジェクトの上面を詳細化した立体である。結果として、LOD2の底面は、LOD0及びLOD1の底面と水平方向の形状が一致する。
* LOD2を作成する際に、建築物の建て替わり等の経年変化により、LOD0及びLOD1の底面が、作成したいLOD2の底面の形状と乖離する場合がある。この場合は、LOD2の形状に合わせてLOD0及びLOD1を修正すること。

--
====

[requirement]
.LOD3の底面非一致
====
[%metadata]
identifier:: /att/planning/3
subject:: 標準作業手順
class:: 留意事項
[statement]
--
LOD3の立体となる底面は、LOD0、LOD1又はLOD2の底面と一致しない場合がある。

* LOD3は、LOD2の幾何オブジェクトの側面を詳細化した立体である。結果として、LOD3の底面は、LOD2、LOD1及びLOD0の底面と一致しなくなる場合がある。

--
====

===== LOD4の((立体))の作成手順

LOD4の立体は、LOD3の詳細な都市オブジェクトの形状（外形）に加えて、都市オブジェクトの内部の形状が再現された立体である。例えば((建築物))の場合、LOD4では、LOD3の外形に加えて、建築物の内部の空間として部屋及び境界面（内壁、天井、床）、また、部屋の境界面に設けられた開口部（窓、扉）が再現される。 +
内部の形状は測量では取得できない場合や取得が困難な場合があるため、LOD4はCADやBIMなどの設計データからの変換や設計図のデジタイズにより作成することが基本となる。ただし、可能な場合には測量により取得してもよい。この場合には、LOD2やLOD3と同様の作成手順となる。 +
BIMデータの活用については、「<<plateau_003>>」を参照する。


[[toc2_03_02]]
==== 作成方法及び作業手順の決定

既存資料や作業環境を整理し、((3D都市モデル))を構成する地物型ごとに作成方法及び作業手順を決定する。

(((3D都市モデル)))
手順：

1）既存資料の有無を踏まえ、地物型ごとに作成方法を決定する。

* 空間属性は数値地形図データから取得し、点群データから取得した高さを付与する、また、主題属性は都市計画基礎調査から取得する、というように、地物型に定義される各地物属性/地物関連について、作成方法を整理すること。
* 既存資料を使用する場合には、どの既存資料を原典資料として使用するかを決定すること。
* 複数の既存資料を組み合わせて使用する場合には、取得時点や取得基準の差異による資料間の不整合が生じる場合がある。最新のものを優先することが前提となるが、できるだけ使用する既存資料の取得時点や取得基準を揃えること、また、複数時点の資料が存在する場合には可能な限り取得時点が近いものを選定することが望ましい。
* 3D都市モデルが既に存在しており、これの一部更新となる3D都市モデルを作成する場合には、最終的に統合することを前提とし、作成方法を検討すること。

2）作成方法及び作業環境に基づき、作業手順を決定する。

作成方法及び作業手順の決定における留意事項を以下に示す。

[requirement]
.作業手順の見直し
====
[%metadata]
identifier:: /att/planning/4
subject:: 標準作業手順
class:: 留意事項
[statement]
--
決定した作業手順は、原典資料の収集後に、原典資料の状態により見直す必要が生じる場合があることに留意すること。
--
====

// (((3D都市モデル)))

[requirement]
.原典資料の入手や新規データの取得が困難な場合の対応
====
[%metadata]
identifier:: /att/planning/5
subject:: 標準作業手順
class:: 留意事項
[statement]
--
例えば、原典資料として航空写真が存在する場合、トンネル内部や高架橋の下部のように、都市オブジェクトを作成できない場所が存在する。車載写真レーザ測量等の別の手法によりデータを新規に取得することが望ましいが、3D都市モデル整備にかかるコストは増大する。 +
3D都市モデルの利用が想定されているユースケースが許容できる場合には、過去の地図等の図面や航空写真からの推定により、補完して作成してもよい。ただし、推定により補完した都市オブジェクトは位置正確度の保証ができない。そのため、以下の方法によりそれを明示する。

* 個々の都市オブジェクトのデータ品質属性に記述する
** データ品質属性は、空間属性や主題属性を作成する際に使用した原典資料の種類や作成方法を記述するための属性である。
** 3D都市モデルに含まれる全ての空間属性又は主題属性をもつ都市オブジェクトに、データ品質属性を記述することを基本とする。
** ただし、都市オブジェクト（集成）と都市オブジェクト（部品）との関係がある場合は、都市オブジェクト（集成）のみにデータ品質属性を記述する。
** 推定で作成した場合には、作成方法が「推定」となる。
* メタデータに記述する
** JMP2.0のメタデータには系譜情報として、都市オブジェクトの作成方法を示すことができる。推定で作成した場合にはその推定方法を示すことができる。

--
====

[NOTE,type="explanation"]
--
3D都市モデルの再利用性を考慮すると、作成方法や原典資料の違いにより品質の異なる都市オブジェクトを識別できるよう、個々の都市オブジェクトに品質情報を記述することが望ましい。その一方で品質情報を記述することでモデル作成の負荷が大きくという課題も生じる。そこで、標準製品仕様書では、都市オブジェクトの基本的な単位である、建築物（bldg:Building）や道路（tran:Road）のような都市オブジェクト（集成）に対して品質情報を記述することとしている。この場合、建築物を構成する壁面や屋根面、道路を構成する歩道や車道といった都市オブジェクト（部品）では品質情報を記述することはできない。
--

// (((拡張製品仕様書)))(((3D都市モデル)))

[requirement]
.3D都市モデルの一部を更新した場合のデータセットの統合について
====
[%metadata]
identifier:: /att/planning/6
subject:: 標準作業手順
class:: 留意事項
[statement]
--
既に3D都市モデルが存在する都市において、一部の都市オブジェクト又は一部の地域の3D都市モデルを更新する場合、納品する3D都市モデルには、更新した都市オブジェクトや地域の3D都市モデルだけではなく、更新対象としない都市オブジェクトや地域の3D都市モデルを全て含めること。
このとき、統合したデータセットに適用する拡張製品仕様書の版は、更新に使用する版とし、一つのデータセット内に製品仕様の異なるデータが混在しないようにする。[underline]##一部を更新した場合のデータセットの統合の考え方を、下記図に示す。##

[[fig-2-5]]
.一部更新した場合のデータセット統合の考え方
image::images/009.webp.png[]
--
====

// (((3D都市モデル)))(((土地利用)))

[requirement]
.行政界を跨ぐ地物の取り扱いについて
====
[%metadata]
identifier:: /att/planning/7
subject:: 標準作業手順
class:: 留意事項
[statement]
--
3D都市モデルのデータセットは基礎自治体を基本とする（<<toc5_04_01>>）が、行政界を跨いで存在する都市オブジェクトは、行政界で区切らず、それぞれの都市に含めることを許容する。 +
隣接する市区町村とのデータの重複を許容する範囲は、原典資料の整備範囲とする。隣接する市区町村において3D都市モデルがすでに整備されている場合には、重複を許容する範囲の都市オブジェクトは、隣接する市区町村で整備された都市オブジェクトを利用することが望ましい。また、都道府県等広域で原典資料が整備されている場合は、行政界をまたぐ基準地域メッシュ（第3次地域区画）又は統合地域メッシュ（第2次地域区画）の範囲で各市区町村の都市オブジェクトが重複してよい。
--
====

(((3D都市モデル)))(((都市計画決定情報)))
[NOTE,type="explanation"]
--
標準製品仕様書には、行政界で区切る地物型と行政界では区切らない地物型がある。行政界で区切る地物型とは、都市計画区域、準都市計画区域、区域区分（市街化区域及び市街化調整区域）、鉄道である。また、その他の構造物（堤防等）も行政界で切ってもよいとしている。一方、建築物、道路、橋梁、トンネル、浸水想定区域、土砂災害警戒区域など、その他の地物型は行政界では区切らない。

標準製品仕様書では3D都市モデルのデータセットは、基礎自治体である市区町村を単位としている。行政界で区切らない地物型は、都市オブジェクトの境界が行政界と必ずしも一致しない。これらの都市オブジェクトは、行政界を跨ぐこととなる。

これらの都市オブジェクトのデータを、隣接する市区町村のデータセットのいずれかに振り分けると、連続した都市空間を表現できなくなるため、利用者の利便性が低下する。また、3D都市モデルの更新時にデータの漏れが生じる恐れもある。

そこで、行政界を跨ぐ都市オブジェクトのデータは、それぞれの市区町村のデータセットに、重複して含めることを許容する。

重複して含めることを許容する空間範囲は、原典資料の整備範囲とする。例えば、都市計画基本図は市町村の単位で整備されることが多いが、行政区域の外まで整備されている場合がある。このような場合、都市計画基本図の整備範囲に合わせて3D都市モデルを整備する。また、都道府県又は複数の市区町村で一括して整備している場合もある。このような場合は、行政界をまたぐ基準地域メッシュ（第3次地域区画）又は統合地域メッシュ（第2次地域区画）の範囲で、各市区町村のデータを重複してよい。これは、メッシュに含まれる都市オブジェクトを、各市区町村の行政区域で振り分けることにより3D都市モデルのメンテナンス性が低下するのを防ぐためである。

. 市町村単位で都市計画基本図を整備している場合の例 +
例えば、道路は、車道交差部、道路構造の変化点（橋梁、トンネル）及び位置正確度や取得方法の変化点で区切ることとしており、行政界では区切らない。道路が横断方向や縦断方向に行政界を跨ぐ場合に、道路オブジェクトを各都市のデータセットに振り分けると、一つの都市の3D都市モデルに含まれる道路オブジェクトは歯抜けの状態となり、利用者にとって使いづらいデータとなってしまう。そこで、それぞれの都市のデータセットに重複して含めることを許容している。
+
image::images/010.webp.png[width="500"]
+
土地利用も同様である。土地利用が変化する場所は行政界とは必ずしも一致しない。しかしながら、いずれかの市区町村のデータセットにのみ行政界を跨ぐ土地利用オブジェクトを含めると、これを含まない市区町村において土地利用状況を正確に把握できなくなる。そこで、行政界を跨ぐ土地利用オブジェクトは、それぞれの市区町村の3D都市モデルに重複して含めてよい。
+
image::images/011.webp.png[width="400"]
+
地形は「JISX0410地域メッシュコード」に定められた基準地域メッシュ（第3次地域区画、一辺の長さ約1km）で区切る。メッシュの境界は行政界とは一致しないため、行政界を跨ぐメッシュの範囲の地形オブジェクトは、それぞれの市区町村の3D都市モデルに重複して含める。
+
image::images/012.webp.png[width="500"]
+
土砂災害警戒区域や洪水浸水想定区域も、都道府県や流域などの広域な範囲で整備されており、区域の境界は市区町村の境界と一致しない場合がある。そのため、行政界を跨ぐ都市オブジェクトは、それぞれの都市の3D都市モデルに重複して含める。
+
image::images/013.webp.png[width="250"]
+
なお、広域都市計画では、都市計画区域や区域区分で定められた市街化区域及び市街化調整区域に複数の市区町村が含まれている場合がある。これらの区域に関して、3D都市モデルの地物型の定義では、行政界で区切ることとしている。そのため、都市計画区域、市街化区域及び市街化調整区域は、市区町村ごとに都市オブジェクトとして分かれることとなり、それぞれの市区町村の3D都市モデルには、それぞれの行政区域に含まれる都市計画区域、市街化区域及び市街化調整区域の都市オブジェクトのみが含まれる（市区町村でデータは重複しない）。
. 複数市区町村などの広域で原典資料が整備されている場合の例 +
都道府県等広域で都市計画基本図や都市計画基礎調査が整備されている場合、行政界を跨ぐ基準地域メッシュ（第3次地域区画）又は統合地域メッシュ（第2次地域区画）の範囲で、各市区町村の都市計画決定情報オブジェクトを重複してよい。つまり、行政界を跨ぐメッシュに対応するファイルは、両方の市区町村の3D都市モデルのデータセットに含まれる（同じファイルが含まれる）。
+
image::images/014.webp.png[width="500"]
--

// (((3D都市モデル)))

[requirement]
.都道府県のデータセットについて
====
[%metadata]
identifier:: /att/planning/8
subject:: 標準作業手順
class:: 留意事項
[statement]
--
3D都市モデルのデータセットの単位は基礎自治体である市区町村が基本となる。ただし、都市計画基礎調査、洪水浸水想定区域、土砂災害警戒区域、都市計画決定情報のように、市区町村を越えた広域で整備された都市オブジェクトは、都道府県の3D都市モデルとして整備することもできる。 +
このとき、都道府県のデータセットは、市区町村のデータセットとは別のデータセットとする。市区町村のデータセットには、都道府県のデータセットの一部が重複して格納されることとなる。 +
重複して格納されるデータの例：都市計画基礎調査、土砂災害警戒区域、都市計画決定情報
--
====

