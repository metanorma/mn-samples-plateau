[[tocL_10]]
=== 標準的な作業手順

各ＬＯＤの幾何オブジェクトを作成する際の標準的な作業手順及び作業上の留意事項を示す。


==== 幾何オブジェクトの作成

作成に必要となる原典資料を<<tab-L-6>>に示す。

[[tab-L-6]]
[cols="a,a,a,a,a,a"]
.原典資料の一覧
|===
| | 水平位置 | 高さ | 上面の形状 | 構造上不可欠な部材 | 付属物

h| LOD0 | 都市計画図等のDMデータ | ― | ― | ― | ―
h| LOD1
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画図等のDMデータ
* 航空写真
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
| ―
| ―
| ―

h| LOD2.0
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画図等のDMデータ
* 航空写真
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
| ―
| ―

h| LOD2.1
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画図等のDMデータ
* 航空写真
* MMS点群
* 地上レーザ点群
* 平面図
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| ―

h| LOD3
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画図等のDMデータ
* 航空写真
* MMS点群
* 地上レーザ点群
* 平面図
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

h| LOD4
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画図等のDMデータ
* 航空写真
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* 平面図
* BIM/CIMモデル
| 以下のいずれかのデータを一つ以上使用する。

* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
* BIM/CIMモデル
| 以下のいずれかのデータを一つ以上使用する。

* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
* BIM/CIMモデル
| 以下のいずれかのデータを一つ以上使用する。

* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
* BIM/CIMモデル
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
* BIM/CIMモデル

|===

橋梁モデル（LOD4）はBIM/CIMモデルから作成することも可能である。ただし、作成する橋梁モデル（LOD4）は標準製品仕様書で定められた地物型で作成する必要がある。

===== LOD0

====== 原典資料

[[tab-L-7]]
[cols="a,a,a,a,a,a"]
.LOD0の原典資料
|===
| | 水平位置 | 高さ | 上面の形状 | 構造上不可欠な部材 | 付属物

h| LOD0 | 都市計画図等のDMデータ | ― | ― | ― | ―

|===

====== 作業手順

. DMデータより、道路橋、桟道橋、鉄道橋、横断歩道橋、こ線橋及び公共用歩廊、徒橋の図式を抽出する。

===== LOD1

====== 原典資料

[[tab-L-8]]
[cols="a,a,a,a,a,a"]
.LOD1の原典資料
|===
| | 水平位置 | 高さ | 上面の形状 | 構造上不可欠な部材 | 付属物

h| LOD1
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画図等のDMデータ
* 航空写真
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
| ―
| ―
| ―

|===

====== 作業手順

. 道路橋及び鉄道橋は、橋梁モデル（LOD0）で取得した縁線を結び、ポリゴンを作成する。橋梁モデル（LOD0）で取得した縁線に橋脚が含まれている場合は、橋脚を含むポリゴンとなり、橋梁モデル（LOD0）で取得した縁線に橋脚が含まれていない場合は、橋脚を含まないポリゴンとなる。
+
--
[[fig-L-1]]
.橋脚を含めた外周から作成したポリゴン
image::images/317.webp.png[width="400"]

桟道橋は、橋梁モデル（LOD0）で取得した斜面に接していない縁線と、道路縁から取得した斜面に接している縁線を結び、ポリゴンを作成する。 +
横断歩道橋、跨線橋、ペデストリアンデッキは橋梁モデル（LOD0）がMultiSurfaceで作成されている場合は、そのままポリゴンとして使用できる。 +
幅員が1m以上の徒橋は、橋梁モデル（LOD0）は中心線であるため、縁線を航空写真から図化しポリゴンを作成する。
--

. a）で作成したポリゴンの各頂点に高さを与え、高さをもったポリゴンを作成する。 +
各頂点に与える高さは一律とし、ポリゴン内に含まれる航空レーザ点群または航空写真から作成した点群の最高高さとする。作成されたポリゴンは水平面となる。 +
屋根や手すりがある場合は屋根及び手すりも含んだ最高高さを取得する。 +
標準製品仕様書では最高高さを原則としているが、ユースケースに応じて中央値など、高さの取得方法を変更することができる。使用したLOD1の高さの種類は、属性lod1HeightTypeに記述する。
. b）で作成した高さを持ったポリゴンを水面（陸上に設置されている場合は地表面）の高さまで押し下げ、立体を作成する。 +
水面の高さは水涯線と地形モデルとの交線の地形モデルの高さとする。地形モデルの傾斜により、水面の高さ又は地表面の高さに幅がある場合は、最低高さとする。
+
--
[[fig-L-2]]
.最高高さで作成した横断歩道橋と航空写真から作成した点群を重畳させた図
image::images/318.webp.png[width="400"]
--

橋梁モデル（LOD1）の作成イメージを以下に示す。

[[fig-L-3]]
.道路橋のLOD1の作成イメージ
image::images/319.webp.png[width="400"]


===== LOD2.0

====== 原典資料

[[tab-L-9]]
[cols="a,a,a,a,a,a"]
.LOD2.0の原典資料
|===
| | 水平位置 | 高さ | 上面の形状 | 構造上不可欠な部材 | 付属物

h| LOD2.0
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画図等のDMデータ
* 航空写真
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
| ―
| ―

|===

====== 作業手順

. 橋梁モデル（LOD1）の幾何オブジェクト作成の作業手順a）で作成したポリゴンから、橋梁モデル（LOD2.0）に不要となるポリゴンを削除する。 +
道路橋、桟道橋及び鉄道橋は、床版及び主桁の上面のみが橋梁モデル（LOD2.0）となる。そのため、橋梁モデル（LOD1）a）で作成したポリゴンから、床版及び主桁の上面（路面）以外の部分（橋脚等）を取り除く。 +
横断歩道橋、ペデストリアンデッキ、徒橋及び跨線橋は、床版、主桁、階段及び踊り場の上面のみが橋梁モデル（LOD2.0）となる。そのため、橋梁モデル（LOD1）a）で作成したポリゴンから、床版、主桁、階段及び踊り場の上面（路面）以外の部分（地覆等）を取り除く。
+
[requirement]
.屋根がある橋梁
====
[%metadata]
identifier:: /att/brid/1
subject:: 妥当な橋梁データセットの要件
class:: 留意事項
[statement]
--
屋根がある橋梁は、橋梁モデル（LOD2.0）を作成しない。これは、橋梁モデル（LOD2.0）が橋梁の上面のみを使用して作成するからである。屋根がある橋梁の橋梁モデル（LOD2）は、橋梁モデル（LOD2.1）のみ作成できる。

[[fig-L-4]]
.橋梁の部材の名称
image::images/320.webp.png[width="400"]
--
====

. a）の各頂点に航空レーザ点群または航空写真から作成した点群の高さを付与し、平面となるようにポリゴンを分割する。 +
勾配がある場合や平面である箇所に歪みが発⽣する場合は、勾配や高さの変化点に頂点を追加し、各ポリゴンが平面となるようポリゴンを分割する。 +
また、下図のように橋梁上空に線路が跨っている等遮蔽物により測量成果から橋梁の高さが取得できない場合は、その遮蔽物の区間でポリゴンを区切り、区切られたそれぞれの区間をBridgePartとする。このとき、測量成果から高さを取得できない区間のBridgePartの高さは、前後の区間の連続性から推定して高さを与えるとともに、属性bridDataQualityAttributeにて、推定で高さを取得していることを明示する。
+
--
[[fig-L-5]]
.橋梁の高さを推定で付与する例
image::images/321.webp.png[width="350"]

横断歩道橋、ペデストリアンデッキ、徒橋、跨線橋の橋梁モデル（LOD2.0）では、階段の段差を表現しない。階段は、階段の上端と下端のみに高さを付与した斜面として取得する。

[[fig-L-6]]
.階段をスロープで表現したイメージ図
image::images/322.webp.png[width="400"]
--

. b）で分割した高さ付きのポリゴンを、全てOuterFloorSurfaceとする。 +
b）で分割した高さ付きのポリゴンは、橋梁の境界面となる。橋梁モデル（LOD2.0）では、橋梁の上面のみが取得の対象であり、これらは通行可能な面であることから、全てOuterFloorSurfaceに区分できる。

橋梁モデル（LOD2.0）の作成イメージを以下に示す。

[[fig-L-7]]
.ペデストリアンデッキのLOD2.0の作成イメージ
image::images/323.webp.png[width="400"]

[[fig-L-8]]
.横断歩道橋のLOD2.0の作成イメージ
image::images/324.webp.png[width="400"]

[[fig-L-9]]
.道路橋のLOD2.0の作成イメージ
image::images/325.webp.png[width="400"]

===== LOD2.1

====== 原典資料

[[tab-L-10]]
[cols="1a,4a,4a,4a,4a,4a"]
.LOD2.1の原典資料
|===
h| h| 水平位置 h| 高さ h| 上面の形状 h| 構造上不可欠な部材 h| 付属物
h| LOD2.1
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画図等のDMデータ
* 航空写真
* MMS点群
* 地上レーザ点群
* 平面図
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群・MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| ―

|===

====== 作業手順

. 橋梁モデル（LOD2.0）を作成する。
. 床版及び主桁、階段及び踊り場の各部材の厚みを取得する。 +
各部材の厚みを航空写真や航空レーザ点群から取得できない場合はMMS点群等から取得する。 +
MMS点群等を入手できない場合は、各部材の厚みを推定することを許容する。ただし、厚みを推定した区間はBridgePartとして区切る。このBridgePartには属性bridDataQualityAttributeにて、推定で高さを取得していることを明示する。
. 橋梁に屋根がある場合は、屋根の形状を取得する。 +
屋根の外周の上からの正射影を取得し、棟（屋根の頂部であり、屋根の分水嶺となる箇所）及び谷（屋根と屋根のつなぎの谷状の部分）で区切り、各頂点に各種点群データから高さを与える。屋根面が曲面の場合は、データセットが採用する地図情報レベルの水平及び高さの誤差の標準偏差に収まるよう平面に分割する。
. 橋梁モデル（LOD2.0）で分割したポリゴンごとにa）で取得した厚みを用いて押し下げ、立体とする。作成した立体を構成する面を、以下に従い境界面に区分する。 +
側面をWallSurfaceとすることを基本とする。屋根がある場合は、開口部をClosureSurfaceとする。 +
底面のうち、接地している面をGroundSurface、それ以外をOuterCeilingSurfaceとする。 +
上面のうち、屋根がある場合はRoofSurface、屋根がない場合はOuterFloorSurfaceとする。
. 構造上不可欠な部材（BridgeConstructionElement）又は橋梁附属物（BridgeInstallation）を表現する場合は、構造物の外形（外側から見える形）を構成する面を取得し、各頂点に点群データから高さを与える。 +
橋梁モデル（LOD2.1）では、構造上不可欠な部材（BridgeConstructionElement）又は橋梁附属物（BridgeInstallation）を表現してもよい。 +
作成する場合は、位置が分かる平面図やMMS点群などの側面方向から計測した計測データが必要となる。下図は境界面の区分に加え、橋脚を作成した例である。
+
--
[[fig-L-10]]
.LOD2.1の境界面の区分イメージ
image::images/326.webp.png[]
--

橋梁モデル（LOD2.1）の作成イメージを以下に示す。

[[fig-L-11]]
.横断歩道橋の橋梁モデル（LOD2.1）の作成イメージ
image::images/327.webp.png[width="400"]

[[fig-L-12]]
.ペデストリアンデッキの橋梁モデル（LOD2.1）の作成イメージ
image::images/328.webp.png[width="400"]

[[fig-L-13]]
.道路橋の橋梁モデル（LOD2.1）の作成イメージ
image::images/329.webp.png[width="400"]

===== LOD3

====== 原典資料

[[tab-L-11]]
[cols="a,a,a,a,a,a"]
.LOD3の原典資料
|===
| | 水平位置 | 高さ | 上面の形状 | 構造上不可欠な部材 | 付属物

h| LOD3
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画図等のDMデータ
* 航空写真
* MMS点群
* 地上レーザ点群
* 平面図
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
| 以下のいずれかのデータを一つ以上使用する。

* 航空写真から作成した点群
* 航空レーザ点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群

|===

====== 作業手順

. 橋梁モデル（LOD2.1）を作成する。
. 床版及び主桁以外の構造上不可欠な部材（例：橋脚）をBridgeConstructionElementとして取得する。 +
BridgeConstructionElementの取得にはMMS点群など側面から計測したデータを使用することを基本とするが、航空写真又は航空レーザ点群から取得可能な場合は、航空写真及び航空レーザ点群を使用してよい。 +
取得対象とする構造上不可欠な部材の外形（外側から見える形）を構成する面を取得し、各頂点に点群データ等から高さを与える。BridgeConstructionElementとして取得する部材の一覧を<<tab-L-12>>に示す。
+
[[tab-L-12]]
[cols="a,a"]
.BridgeConstructionElementとして取得する部材の一覧
|===
| 部材名 | 部材イメージ

| トラス
|
image::images/330.webp.png[width="200"]

| アーチ
|
image::images/331.webp.png[width="200"]

| パイロン
|
image::images/332.webp.png[width="200"]

| 吊材
|
image::images/333.webp.png[width="200"]

| ケーブル
|
image::images/334.webp.png[width="200"]

| 橋脚
|
image::images/335.webp.png[width="200"]

| 橋台
|
image::images/336.webp.png[width="200"]

|===

. 橋梁の外観を構成する付属的な部材（例：高欄、地覆）をBridgeInstallationとして取得する。 +
BridgeInstallationの取得にはMMS点群など側面から計測したデータを使用することを基本とする。ただし、航空写真又は航空レーザ点群から取得可能な場合は、航空写真及び航空レーザ点群を使用してよい。 +
取得対象とする構造上不可欠な部材の外形（外側から見える形）を構成する面を取得し、各頂点に点群データ等から高さを与える。BridgeInstallationとして取得する部材の一覧を<<tab-L-13>>に示す。
+
[[tab-L-13]]
[cols="a,a"]
.BridgeInstallationとして取得する部材の一覧
|===
| 部材名 | 部材イメージ

| 高欄
|
image::images/337.webp.png[width="150"]

| 地覆
|
image::images/338.webp.png[width="150"]

| 親柱
|
image::images/339.webp.png[width="150"]

| 庇の柱
|
image::images/340.webp.png[width="150"]

| エレベータ
|
image::images/341.webp.png[width="150"]

| エスカレータ
|
image::images/342.webp.png[width="150"]

| 手すり
|
image::images/343.webp.png[width="100"]

|===
+
橋梁モデル（LOD3）は階段やエスカレータなどの段差を表現する。
+
[[fig-L-14]]
.エスカレータおよび階段の作成イメージ
image::images/344.webp.png[width="400"]

橋梁モデル（LOD3）の作成イメージを以下に示す。

[[fig-L-15]]
.歩道橋の橋梁モデル（LOD3）の作成イメージ
image::images/345.webp.png[width="400"]

[[fig-L-16]]
.ペデストリアンデッキの橋梁モデル（LOD3）の作成イメージ
image::images/346.webp.png[width="400"]

[[fig-L-17]]
.道路橋の橋梁モデル（LOD3）の作成イメージ
image::images/347.webp.png[width="400"]

===== LOD4

====== 原典資料

[[tab-L-14]]
[cols="a,a,a,a,a,a"]
.LOD4の原典資料
|===
| | 水平位置 | 高さ | 上面の形状 | 構造上不可欠な部材 | 付属物

h|
| 以下のいずれかのデータを一つ以上使用する。

* 都市計画図等のDMデータ
* 航空写真
* MMS点群
* 地上レーザ点群
* 平面図
* BIM/CIMモデル
| 以下のいずれかのデータを一つ以上使用する。

* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
* BIM/CIMモデル
| 以下のいずれかのデータを一つ以上使用する。

* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
* BIM/CIMモデル
| 以下のいずれかのデータを一つ以上使用する。

* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
* BIM/CIMモデル
| 以下のいずれかのデータを一つ以上使用する。

* 航空レーザ点群
* 航空写真から作成した点群
* MMS点群
* 地上レーザ点群
* LidarSLAM点群
* BIM/CIMモデル

|===

====== 作業手順

. 橋梁モデル（LOD3）を作成する。
. 橋梁の詳細な形状及び橋梁内部の空間を表現する。 +
詳細形状や内部形状は、BIM/CIMモデルから作成することを基本する。ただし、測量による計測データが得られる場合は計測データから作成することも可能である。 +
標準製品仕様書では、橋梁の詳細な部材の定義は、IFCにおける橋梁モデル(IFC Bridge)と整合を +
図っている。ただし、IFCにおける橋梁モデルはまだ国際標準となっていないことから、IFC Bridge Fast Track Project Report WP2: Conceptual Modelを参考に、IFC Bridgeを構成するクラスとCityGMLのBridgeモジュールとの対応付けを行っている。

[[tab-L-15]]
[cols="a,a,a"]
.（参考）CityGMLのクラスとIFCのクラスとの対応
|===
| CityGMLの地物型 | 対応付けるIFCのクラス | 説明

| Bridge
| IfcBridgePart,IfcElementAssembly
|
IfcBridgePartのうち、以下に区分されるものを対象とする。

* DECK,DECK_SEGMENT

IfcElementAssemblyのうち、以下に区分されるものを対象とする。

* DECK

| BridgeContructionElement
| IfcBridgePart,IfcElementAssembly
|

IfcBridgePartのうち、以下に区分されるものを対象とする。

* ABUTMENT,FOUNDATION,PIER,PIER_SEGMENT,PYLON,SUBSTRUCTURE,SUPERSTRUCTURE,SURFACESTRUCTURE,IfcElementAssemblyのうち、以下に区分されるものを対象とする。

* ARCH,BEAM_GRID,GIRDER,REINFORCEMEN_UNIT,RIGID_FRAME,SLAB_FIELD,TRUSS,ABUTMENT,PIAR,PYLON,CROSS_BRACING,

| BridgeInstallation | IfcElementAssembly | IfcElementAssemblyのうち、ACCESSORY_ASSEMBLYに区分されるものを対象とする。

|===

CityGMLの地物型は、IFCにおいて部材の集まりを示すIfcBridgePart及びIfcElementAssemblyと対応付ける。 +
IFCでは、梁（IfcBeam）やスラブ（IfcSlab）、支承（IfcBearing）といった橋梁を構成する部材がクラスとして定義されているが、これらのクラスとCityGMLの地物型とを対応付けると、3D都市モデルとしては詳細すぎる表現となるため、部材クラスの集まりであるIfcBridgePart及びIfcElementAssemblyとCityGMLの地物型とを対応づけ、橋梁モデル（LOD4）を作成する。

[[fig-L-18]]
.IfcBridgeにおけるクラス間の階層構造
image::images/348.webp.png[]

［出典：<<ifc_bridge_wp2>>］

==== 作成上の留意事項

===== 延長の長い橋梁モデルの取り扱い

一つの橋梁は、一つの橋梁モデルとしてデータ作成することを基本とする。ただし、高速道路の高架橋のように延長の長い橋梁は、一つのモデルとして作成するとデータ量が膨大になる。そこで、その場合には管理区間又は上部工の境界（伸縮装置が設置されている場所）により区切り、一つの橋梁モデルとしてよい。

===== 行政界を跨ぐ橋梁モデルの取り扱い

行政界を跨ぐ橋梁モデルは、橋梁モデルを一つのオブジェクトとして作成するため、基本方針として標準製品仕様書では橋梁モデルを行政界で区切らないとしている。行政界を跨ぐ橋梁モデルは、これに関係する市区町村の3D都市モデルに重複して含めてよい。
